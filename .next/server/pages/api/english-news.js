"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/english-news";
exports.ids = ["pages/api/english-news"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/english-news.js */ \"(api)/./pages/api/english-news.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/english-news\",\n        pathname: \"/api/english-news\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmVuZ2xpc2gtbmV3cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZW5nbGlzaC1uZXdzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3VwZXItbmV3cy8/ZGMwZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2VuZ2xpc2gtbmV3cy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2VuZ2xpc2gtbmV3c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2VuZ2xpc2gtbmV3c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/english-news.js":
/*!***********************************!*\
  !*** ./pages/api/english-news.js ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_2__]);\nopenai__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// API configurations\nconst NEWSAPI_KEY = process.env.NEWSAPI_KEY;\nconst NEWSAPI_BASE_URL = \"https://newsapi.org/v2\";\nconst GNEWS_API_KEY = process.env.GNEWS_API_KEY;\nconst GNEWS_BASE_URL = \"https://gnews.io/api/v4\";\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// Cache configuration\nconst CACHE_DURATION = 60 * 60 * 1000; // 60 minutes (1 hour) in milliseconds\nconst CACHE_FILE = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"news-cache.json\");\n// Background generation state\nlet backgroundInterval = null;\nlet isGenerating = false;\n// Check if cache exists (we'll always serve from cache if it exists)\nfunction cacheExists() {\n    try {\n        return fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE);\n    } catch (error) {\n        console.error(\"❌ Error checking cache:\", error);\n        return false;\n    }\n}\n// Check if cache needs refresh (for background generation)\nfunction cacheNeedsRefresh() {\n    try {\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE)) {\n            return true;\n        }\n        const cacheData = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(CACHE_FILE, \"utf8\"));\n        const now = Date.now();\n        const cacheAge = now - cacheData.timestamp;\n        return cacheAge >= CACHE_DURATION;\n    } catch (error) {\n        console.error(\"❌ Error reading cache for refresh check:\", error);\n        return true;\n    }\n}\n// Load cached news with self-recovery\nfunction loadCachedNews() {\n    try {\n        const cacheData = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(CACHE_FILE, \"utf8\"));\n        // Validate cache structure\n        if (!cacheData.articles || !Array.isArray(cacheData.articles) || cacheData.articles.length === 0) {\n            throw new Error(\"Invalid cache structure or empty articles\");\n        }\n        console.log(`✅ Loaded ${cacheData.articles.length} cached articles`);\n        return cacheData.articles;\n    } catch (error) {\n        console.error(\"❌ Error loading cached news:\", error);\n        // Self-recovery: delete corrupt cache file\n        try {\n            if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE)) {\n                fs__WEBPACK_IMPORTED_MODULE_0___default().unlinkSync(CACHE_FILE);\n                console.log(\"\\uD83D\\uDDD1️ Deleted corrupt cache file for self-recovery\");\n            }\n        } catch (deleteError) {\n            console.error(\"❌ Failed to delete corrupt cache:\", deleteError);\n        }\n        return null;\n    }\n}\n// Save news to cache\nfunction saveToCache(articles) {\n    try {\n        const cacheData = {\n            articles: articles,\n            timestamp: Date.now(),\n            generatedAt: new Date().toISOString()\n        };\n        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(CACHE_FILE, JSON.stringify(cacheData, null, 2));\n        console.log(`💾 Saved ${articles.length} articles to cache`);\n    } catch (error) {\n        console.error(\"❌ Error saving to cache:\", error);\n    }\n}\n// Background news generation\nasync function generateNewsInBackground() {\n    if (isGenerating) {\n        console.log(\"\\uD83D\\uDD04 News generation already in progress, skipping...\");\n        return;\n    }\n    if (!cacheNeedsRefresh()) {\n        console.log(\"\\uD83D\\uDCC1 Cache still fresh, skipping background generation\");\n        return;\n    }\n    isGenerating = true;\n    console.log(\"\\uD83D\\uDD04 Background: Generating fresh news...\");\n    try {\n        const articles = await fetchRealNews();\n        saveToCache(articles);\n        console.log(\"✅ Background: News updated successfully\");\n    } catch (error) {\n        console.error(\"❌ Background generation failed:\", error);\n    } finally{\n        isGenerating = false;\n    }\n}\n// Start background news generation\nfunction startBackgroundGeneration() {\n    if (backgroundInterval) {\n        return; // Already running\n    }\n    console.log(\"\\uD83D\\uDE80 Starting background news generation (every hour)\");\n    // Generate immediately if cache needs refresh\n    if (cacheNeedsRefresh()) {\n        generateNewsInBackground();\n    }\n    // Set interval for ongoing generation\n    backgroundInterval = setInterval(generateNewsInBackground, CACHE_DURATION);\n}\n// Fetch real news using GNews API\nasync function fetchGNewsArticles() {\n    try {\n        console.log(\"\\uD83D\\uDE80 Fetching news from GNews API...\");\n        if (!GNEWS_API_KEY) {\n            throw new Error(\"GNews API key not found\");\n        }\n        // Search queries focused on Ukraine-Russia conflict and political news\n        const queries = [\n            \"Ukraine Russia conflict\",\n            \"Trump foreign policy\",\n            \"peace negotiations Ukraine\",\n            \"humanitarian crisis Ukraine\",\n            \"NATO Ukraine military aid\",\n            \"Zelensky Putin\"\n        ];\n        const allArticles = [];\n        // Fetch news for each query\n        for(let i = 0; i < queries.length; i++){\n            const query = queries[i];\n            const url = `${GNEWS_BASE_URL}/search?q=${encodeURIComponent(query)}&lang=en&country=us&max=10&sortby=publishedAt&apikey=${GNEWS_API_KEY}`;\n            try {\n                const response = await fetch(url);\n                if (!response.ok) {\n                    console.warn(`GNews query ${i + 1} failed with status ${response.status}`);\n                    continue;\n                }\n                const data = await response.json();\n                if (data.articles && data.articles.length > 0) {\n                    // Filter valid articles\n                    const validArticles = data.articles.filter((article)=>article.title && article.description && article.title !== \"[Removed]\" && article.description !== \"[Removed]\");\n                    allArticles.push(...validArticles);\n                }\n                // Rate limiting delay\n                if (i < queries.length - 1) {\n                    await new Promise((resolve)=>setTimeout(resolve, 200));\n                }\n            } catch (fetchError) {\n                console.warn(`GNews query ${i + 1} failed:`, fetchError.message);\n                continue;\n            }\n        }\n        console.log(`📰 GNews: Found ${allArticles.length} total articles`);\n        return allArticles;\n    } catch (error) {\n        console.error(\"❌ GNews fetch error:\", error);\n        return [];\n    }\n}\n// Fetch real news using NewsAPI (fallback)\nasync function fetchNewsAPIArticles() {\n    try {\n        console.log(\"\\uD83D\\uDE80 Fetching news from NewsAPI...\");\n        if (!NEWSAPI_KEY) {\n            console.warn(\"⚠️ NewsAPI key not found, skipping NewsAPI\");\n            return [];\n        }\n        // Focus on Ukraine-Russia conflict and political news from reliable sources\n        // Enhanced query targeting for more interesting and relevant content\n        const queries = [\n            \"Ukraine Russia conflict latest developments\",\n            \"Trump foreign policy Ukraine Russia\",\n            \"peace negotiations Ukraine ceasefire\",\n            \"humanitarian crisis Ukraine refugees\",\n            \"diplomatic efforts Russia sanctions\",\n            \"NATO Ukraine military aid\",\n            \"Zelensky Putin negotiations\"\n        ];\n        // Verified fact-based sources with high credibility ratings\n        const sources = \"reuters,associated-press,bbc-news,al-jazeera-english,cnn,abc-news,npr,bloomberg\";\n        const allArticles = [];\n        // Fetch news for each query to get comprehensive coverage\n        // Enhanced error handling and rate limiting consideration\n        for(let i = 0; i < queries.length; i++){\n            const query = queries[i];\n            const url = `${NEWSAPI_BASE_URL}/everything?q=${encodeURIComponent(query)}&sources=${sources}&language=en&sortBy=publishedAt&pageSize=15&apiKey=${NEWSAPI_KEY}`;\n            try {\n                const response = await fetch(url);\n                if (!response.ok) {\n                    console.warn(`NewsAPI query ${i + 1} failed with status ${response.status}`);\n                    continue; // Continue with other queries if one fails\n                }\n                const data = await response.json();\n                if (data.articles && data.articles.length > 0) {\n                    // Filter out articles without meaningful content\n                    const validArticles = data.articles.filter((article)=>article.title && article.description && article.title !== \"[Removed]\" && article.description !== \"[Removed]\");\n                    allArticles.push(...validArticles);\n                }\n                // Small delay to respect rate limits\n                if (i < queries.length - 1) {\n                    await new Promise((resolve)=>setTimeout(resolve, 100));\n                }\n            } catch (fetchError) {\n                console.warn(`NewsAPI query ${i + 1} failed:`, fetchError.message);\n                continue;\n            }\n        }\n        console.log(`📰 NewsAPI: Found ${allArticles.length} total articles`);\n        return allArticles;\n    } catch (error) {\n        console.error(\"❌ NewsAPI fetch error:\", error);\n        return [];\n    }\n}\n// Combined news fetching function\nasync function fetchRealNews() {\n    try {\n        console.log(\"\\uD83D\\uDE80 Fetching real factual news from multiple sources...\");\n        // Fetch from both APIs in parallel for better performance\n        const [gNewsArticles, newsAPIArticles] = await Promise.all([\n            fetchGNewsArticles(),\n            fetchNewsAPIArticles()\n        ]);\n        // Combine articles from both sources\n        const allArticles = [\n            ...gNewsArticles,\n            ...newsAPIArticles\n        ];\n        if (allArticles.length === 0) {\n            throw new Error(\"No articles found from any news sources\");\n        }\n        // Normalize article format for consistent processing\n        const normalizedArticles = allArticles.map((article)=>{\n            // Handle different API response formats\n            if (article.source && typeof article.source === \"object\") {\n                // NewsAPI format\n                return {\n                    title: article.title,\n                    description: article.description,\n                    content: article.content,\n                    url: article.url,\n                    urlToImage: article.urlToImage || article.image,\n                    publishedAt: article.publishedAt,\n                    source: {\n                        name: article.source.name\n                    }\n                };\n            } else {\n                // GNews format\n                return {\n                    title: article.title,\n                    description: article.description,\n                    content: article.content || article.description,\n                    url: article.url,\n                    urlToImage: article.image,\n                    publishedAt: article.publishedAt,\n                    source: {\n                        name: article.source?.name || article.source?.url || \"Unknown\"\n                    }\n                };\n            }\n        });\n        // Remove duplicates and sort by publication date\n        const uniqueArticles = normalizedArticles.filter((article, index, self)=>index === self.findIndex((a)=>a.title === article.title)).sort((a, b)=>new Date(b.publishedAt) - new Date(a.publishedAt));\n        // Transform to our format and take top 30\n        const processedArticles = uniqueArticles.slice(0, 30).map((article, index)=>{\n            const category = categorizeRealNews(article);\n            const importance = getImportanceLevel(article, index);\n            return {\n                id: Date.now() + index,\n                rank: index + 1,\n                title: article.title,\n                summary: article.description || \"No description available\",\n                fullContent: article.content || article.description || \"Full content not available\",\n                importance: importance,\n                source: article.source.name,\n                category: category,\n                publishedAt: article.publishedAt,\n                url: article.url,\n                urlToImage: article.urlToImage\n            };\n        });\n        console.log(`📊 Combined ${gNewsArticles.length} GNews + ${newsAPIArticles.length} NewsAPI = ${processedArticles.length} final articles`);\n        // Translate all articles to Russian\n        console.log(\"\\uD83D\\uDD04 Translating articles to Russian...\");\n        const translatedArticles = await translateArticlesToRussian(processedArticles);\n        console.log(`✅ Processed and translated ${translatedArticles.length} real news articles from verified sources`);\n        return translatedArticles;\n    } catch (error) {\n        console.error(\"❌ Error fetching real news:\", error);\n        return getFallbackNews();\n    }\n}\n// Categorize real news articles\nfunction categorizeRealNews(article) {\n    const title = article.title.toLowerCase();\n    const description = (article.description || \"\").toLowerCase();\n    const content = `${title} ${description}`;\n    // Ukraine-Russia conflict keywords\n    if (content.includes(\"ukraine\") || content.includes(\"russia\") || content.includes(\"putin\") || content.includes(\"kyiv\") || content.includes(\"moscow\") || content.includes(\"war\") || content.includes(\"conflict\") || content.includes(\"sanctions\") || content.includes(\"zelensky\")) {\n        return \"Украина-Россия\";\n    }\n    // Trump politics keywords\n    if (content.includes(\"trump\") || content.includes(\"donald\") || content.includes(\"election\") || content.includes(\"campaign\") || content.includes(\"republican\") || content.includes(\"foreign policy\")) {\n        return \"Политика Трампа\";\n    }\n    // Peace and humanitarian keywords\n    if (content.includes(\"peace\") || content.includes(\"ceasefire\") || content.includes(\"humanitarian\") || content.includes(\"refugee\") || content.includes(\"civilian\") || content.includes(\"aid\") || content.includes(\"diplomatic\") || content.includes(\"negotiations\")) {\n        return \"Мирные усилия\";\n    }\n    // Anti-war movement keywords\n    if (content.includes(\"protest\") || content.includes(\"anti-war\") || content.includes(\"activism\") || content.includes(\"movement\") || content.includes(\"demonstration\") || content.includes(\"peace march\")) {\n        return \"Антивоенное движение\";\n    }\n    // Humanitarian focus\n    if (content.includes(\"humanitarian\") || content.includes(\"victims\") || content.includes(\"casualties\") || content.includes(\"displaced\") || content.includes(\"crisis\") || content.includes(\"suffering\")) {\n        return \"Гуманитарные\";\n    }\n    return \"Главные\";\n}\n// Translate articles to Russian using OpenAI\nasync function translateArticlesToRussian(articles) {\n    try {\n        if (!process.env.OPENAI_API_KEY) {\n            console.warn(\"⚠️ OpenAI API key not found, returning articles without translation\");\n            return articles;\n        }\n        // Process articles in batches to avoid API limits\n        const batchSize = 3;\n        const translatedArticles = [];\n        for(let i = 0; i < articles.length; i += batchSize){\n            const batch = articles.slice(i, i + batchSize);\n            const batchPrompts = batch.map((article)=>({\n                    title: article.title,\n                    summary: article.summary,\n                    content: article.fullContent\n                }));\n            const prompt = `Переведите следующие новостные статьи на русский язык, сохраняя журналистский стиль и фактуальность. Особое внимание уделяйте гуманитарным аспектам и антивоенной направленности.\n\nСтатьи для перевода:\n${JSON.stringify(batchPrompts, null, 2)}\n\nВерните перевод в том же JSON формате с полями title, summary, content. Сохраняйте профессиональный журналистский стиль.`;\n            try {\n                const response = await openai.chat.completions.create({\n                    model: \"gpt-4o-mini\",\n                    messages: [\n                        {\n                            role: \"user\",\n                            content: prompt\n                        }\n                    ],\n                    response_format: {\n                        type: \"json_object\"\n                    },\n                    temperature: 0.3\n                });\n                const translatedBatch = JSON.parse(response.choices[0].message.content);\n                // Merge translated content back with original article data\n                batch.forEach((article, index)=>{\n                    // Handle different response formats from OpenAI\n                    let translatedArray = [];\n                    if (Array.isArray(translatedBatch)) {\n                        translatedArray = translatedBatch;\n                    } else if (translatedBatch.articles) {\n                        translatedArray = translatedBatch.articles;\n                    } else {\n                        translatedArray = Object.values(translatedBatch);\n                    }\n                    const translated = translatedArray[index];\n                    if (translated && translated.title) {\n                        translatedArticles.push({\n                            ...article,\n                            title: translated.title,\n                            summary: translated.summary,\n                            fullContent: translated.content\n                        });\n                    } else {\n                        translatedArticles.push(article); // Fallback to original if translation failed\n                    }\n                });\n                // Small delay between batches to respect rate limits\n                if (i + batchSize < articles.length) {\n                    await new Promise((resolve)=>setTimeout(resolve, 200));\n                }\n            } catch (batchError) {\n                console.error(`❌ Translation batch ${Math.floor(i / batchSize) + 1} failed:`, batchError.message);\n                // Add original articles if translation fails\n                translatedArticles.push(...batch);\n            }\n        }\n        console.log(`✅ Successfully translated ${translatedArticles.length} articles to Russian`);\n        return translatedArticles;\n    } catch (error) {\n        console.error(\"❌ Translation error:\", error);\n        return articles; // Return original articles if translation completely fails\n    }\n}\n// Determine importance level based on source credibility and recency\nfunction getImportanceLevel(article, index) {\n    const reliableSources = [\n        \"reuters\",\n        \"associated press\",\n        \"bbc\",\n        \"guardian\",\n        \"al jazeera\",\n        \"npr\",\n        \"cnn\",\n        \"abc news\",\n        \"bloomberg\",\n        \"financial times\"\n    ];\n    const sourceName = article.source.name.toLowerCase();\n    const isReliableSource = reliableSources.some((source)=>sourceName.includes(source));\n    const isRecent = new Date() - new Date(article.publishedAt) < 6 * 60 * 60 * 1000; // 6 hours\n    // Enhanced fact-checking: prefer highly credible sources\n    const highlyCredible = [\n        \"reuters\",\n        \"associated press\",\n        \"bbc\"\n    ];\n    const isHighlyCredible = highlyCredible.some((source)=>sourceName.includes(source));\n    if (index < 3 && isHighlyCredible && isRecent) return \"Breaking\";\n    if (index < 5 && isReliableSource && isRecent) return \"Critical\";\n    if (index < 10 && isReliableSource) return \"Urgent\";\n    return \"Developing\";\n}\n// Fallback news data in case of API failure\nfunction getFallbackNews() {\n    return [\n        {\n            id: Date.now(),\n            rank: 1,\n            title: \"СРОЧНО: Проблемы с подключением к новостным источникам\",\n            summary: \"В настоящее время возникли технические трудности с получением свежих новостей из надежных источников.\",\n            fullContent: \"Мы работаем над восстановлением подключения к проверенным новостным агентствам, чтобы предоставить вам самые актуальные и достоверные новости. Пожалуйста, обновите страницу через несколько минут.\",\n            importance: \"Breaking\",\n            source: \"News System\",\n            category: \"Главные\",\n            publishedAt: new Date().toISOString()\n        }\n    ];\n}\nasync function handler(req, res) {\n    // Set CORS headers\n    res.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n    res.setHeader(\"Access-Control-Allow-Methods\", \"GET\");\n    res.setHeader(\"Access-Control-Allow-Headers\", \"Content-Type\");\n    try {\n        const { page = 1, limit = 30 } = req.query;\n        let allArticles;\n        let cacheStatus;\n        // Start background generation on first request\n        startBackgroundGeneration();\n        // Always try to serve from cache first\n        if (cacheExists()) {\n            allArticles = loadCachedNews();\n            if (allArticles && allArticles.length > 0) {\n                cacheStatus = \"instant\";\n                console.log(\"⚡ Serving cached news instantly\");\n            } else {\n                // Cache exists but is corrupted/invalid - generate fresh\n                console.log(\"\\uD83D\\uDD04 Cache corrupted, fetching fresh real news...\");\n                allArticles = await fetchRealNews();\n                saveToCache(allArticles);\n                cacheStatus = \"recovered\";\n            }\n        } else {\n            // Only generate synchronously if no cache exists at all (first time)\n            console.log(\"\\uD83D\\uDD04 No cache found, fetching initial real news...\");\n            allArticles = await fetchRealNews();\n            saveToCache(allArticles);\n            cacheStatus = \"initial\";\n        }\n        // Handle pagination\n        const pageNumber = parseInt(page);\n        const limitNumber = parseInt(limit);\n        const startIndex = (pageNumber - 1) * limitNumber;\n        const endIndex = startIndex + limitNumber;\n        const paginatedArticles = allArticles.slice(startIndex, endIndex);\n        res.status(200).json({\n            articles: paginatedArticles,\n            total: allArticles.length,\n            page: pageNumber,\n            hasMore: endIndex < allArticles.length,\n            type: \"real_news_with_cache\",\n            cacheStatus: cacheStatus,\n            updatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        res.status(500).json({\n            error: \"Failed to load news\",\n            message: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FBSyxDQUFDLGNBQWNBO1FBQzVCeUgsSUFBSWpGLE1BQU0sQ0FBQyxLQUFLRSxJQUFJLENBQUM7WUFDbkIxQyxPQUFPO1lBQ1BxRCxTQUFTckQsTUFBTXFELE9BQU87UUFDeEI7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3VwZXItbmV3cy8uL3BhZ2VzL2FwaS9lbmdsaXNoLW5ld3MuanM/MDNmMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IE9wZW5BSSBmcm9tIFwib3BlbmFpXCI7XG5cbi8vIEFQSSBjb25maWd1cmF0aW9uc1xuY29uc3QgTkVXU0FQSV9LRVkgPSBwcm9jZXNzLmVudi5ORVdTQVBJX0tFWTtcbmNvbnN0IE5FV1NBUElfQkFTRV9VUkwgPSAnaHR0cHM6Ly9uZXdzYXBpLm9yZy92Mic7XG5jb25zdCBHTkVXU19BUElfS0VZID0gcHJvY2Vzcy5lbnYuR05FV1NfQVBJX0tFWTtcbmNvbnN0IEdORVdTX0JBU0VfVVJMID0gJ2h0dHBzOi8vZ25ld3MuaW8vYXBpL3Y0JztcbmNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoeyBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZIH0pO1xuXG4vLyBDYWNoZSBjb25maWd1cmF0aW9uXG5jb25zdCBDQUNIRV9EVVJBVElPTiA9IDYwICogNjAgKiAxMDAwOyAvLyA2MCBtaW51dGVzICgxIGhvdXIpIGluIG1pbGxpc2Vjb25kc1xuY29uc3QgQ0FDSEVfRklMRSA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnbmV3cy1jYWNoZS5qc29uJyk7XG5cbi8vIEJhY2tncm91bmQgZ2VuZXJhdGlvbiBzdGF0ZVxubGV0IGJhY2tncm91bmRJbnRlcnZhbCA9IG51bGw7XG5sZXQgaXNHZW5lcmF0aW5nID0gZmFsc2U7XG5cbi8vIENoZWNrIGlmIGNhY2hlIGV4aXN0cyAod2UnbGwgYWx3YXlzIHNlcnZlIGZyb20gY2FjaGUgaWYgaXQgZXhpc3RzKVxuZnVuY3Rpb24gY2FjaGVFeGlzdHMoKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGZzLmV4aXN0c1N5bmMoQ0FDSEVfRklMRSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGNoZWNraW5nIGNhY2hlOicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLy8gQ2hlY2sgaWYgY2FjaGUgbmVlZHMgcmVmcmVzaCAoZm9yIGJhY2tncm91bmQgZ2VuZXJhdGlvbilcbmZ1bmN0aW9uIGNhY2hlTmVlZHNSZWZyZXNoKCkge1xuICB0cnkge1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhDQUNIRV9GSUxFKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGNhY2hlRGF0YSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKENBQ0hFX0ZJTEUsICd1dGY4JykpO1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgY29uc3QgY2FjaGVBZ2UgPSBub3cgLSBjYWNoZURhdGEudGltZXN0YW1wO1xuICAgIFxuICAgIHJldHVybiBjYWNoZUFnZSA+PSBDQUNIRV9EVVJBVElPTjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgcmVhZGluZyBjYWNoZSBmb3IgcmVmcmVzaCBjaGVjazonLCBlcnJvcik7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cblxuLy8gTG9hZCBjYWNoZWQgbmV3cyB3aXRoIHNlbGYtcmVjb3ZlcnlcbmZ1bmN0aW9uIGxvYWRDYWNoZWROZXdzKCkge1xuICB0cnkge1xuICAgIGNvbnN0IGNhY2hlRGF0YSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKENBQ0hFX0ZJTEUsICd1dGY4JykpO1xuICAgIFxuICAgIC8vIFZhbGlkYXRlIGNhY2hlIHN0cnVjdHVyZVxuICAgIGlmICghY2FjaGVEYXRhLmFydGljbGVzIHx8ICFBcnJheS5pc0FycmF5KGNhY2hlRGF0YS5hcnRpY2xlcykgfHwgY2FjaGVEYXRhLmFydGljbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNhY2hlIHN0cnVjdHVyZSBvciBlbXB0eSBhcnRpY2xlcycpO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhg4pyFIExvYWRlZCAke2NhY2hlRGF0YS5hcnRpY2xlcy5sZW5ndGh9IGNhY2hlZCBhcnRpY2xlc2ApO1xuICAgIHJldHVybiBjYWNoZURhdGEuYXJ0aWNsZXM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGxvYWRpbmcgY2FjaGVkIG5ld3M6JywgZXJyb3IpO1xuICAgIFxuICAgIC8vIFNlbGYtcmVjb3Zlcnk6IGRlbGV0ZSBjb3JydXB0IGNhY2hlIGZpbGVcbiAgICB0cnkge1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoQ0FDSEVfRklMRSkpIHtcbiAgICAgICAgZnMudW5saW5rU3luYyhDQUNIRV9GSUxFKTtcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfl5HvuI8gRGVsZXRlZCBjb3JydXB0IGNhY2hlIGZpbGUgZm9yIHNlbGYtcmVjb3ZlcnknKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChkZWxldGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBkZWxldGUgY29ycnVwdCBjYWNoZTonLCBkZWxldGVFcnJvcik7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8vIFNhdmUgbmV3cyB0byBjYWNoZVxuZnVuY3Rpb24gc2F2ZVRvQ2FjaGUoYXJ0aWNsZXMpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjYWNoZURhdGEgPSB7XG4gICAgICBhcnRpY2xlczogYXJ0aWNsZXMsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICBnZW5lcmF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfTtcbiAgICBmcy53cml0ZUZpbGVTeW5jKENBQ0hFX0ZJTEUsIEpTT04uc3RyaW5naWZ5KGNhY2hlRGF0YSwgbnVsbCwgMikpO1xuICAgIGNvbnNvbGUubG9nKGDwn5K+IFNhdmVkICR7YXJ0aWNsZXMubGVuZ3RofSBhcnRpY2xlcyB0byBjYWNoZWApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBzYXZpbmcgdG8gY2FjaGU6JywgZXJyb3IpO1xuICB9XG59XG5cbi8vIEJhY2tncm91bmQgbmV3cyBnZW5lcmF0aW9uXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZU5ld3NJbkJhY2tncm91bmQoKSB7XG4gIGlmIChpc0dlbmVyYXRpbmcpIHtcbiAgICBjb25zb2xlLmxvZygn8J+UhCBOZXdzIGdlbmVyYXRpb24gYWxyZWFkeSBpbiBwcm9ncmVzcywgc2tpcHBpbmcuLi4nKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIWNhY2hlTmVlZHNSZWZyZXNoKCkpIHtcbiAgICBjb25zb2xlLmxvZygn8J+TgSBDYWNoZSBzdGlsbCBmcmVzaCwgc2tpcHBpbmcgYmFja2dyb3VuZCBnZW5lcmF0aW9uJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaXNHZW5lcmF0aW5nID0gdHJ1ZTtcbiAgY29uc29sZS5sb2coJ/CflIQgQmFja2dyb3VuZDogR2VuZXJhdGluZyBmcmVzaCBuZXdzLi4uJyk7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGFydGljbGVzID0gYXdhaXQgZmV0Y2hSZWFsTmV3cygpO1xuICAgIHNhdmVUb0NhY2hlKGFydGljbGVzKTtcbiAgICBjb25zb2xlLmxvZygn4pyFIEJhY2tncm91bmQ6IE5ld3MgdXBkYXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgQmFja2dyb3VuZCBnZW5lcmF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gIH0gZmluYWxseSB7XG4gICAgaXNHZW5lcmF0aW5nID0gZmFsc2U7XG4gIH1cbn1cblxuLy8gU3RhcnQgYmFja2dyb3VuZCBuZXdzIGdlbmVyYXRpb25cbmZ1bmN0aW9uIHN0YXJ0QmFja2dyb3VuZEdlbmVyYXRpb24oKSB7XG4gIGlmIChiYWNrZ3JvdW5kSW50ZXJ2YWwpIHtcbiAgICByZXR1cm47IC8vIEFscmVhZHkgcnVubmluZ1xuICB9XG4gIFxuICBjb25zb2xlLmxvZygn8J+agCBTdGFydGluZyBiYWNrZ3JvdW5kIG5ld3MgZ2VuZXJhdGlvbiAoZXZlcnkgaG91ciknKTtcbiAgXG4gIC8vIEdlbmVyYXRlIGltbWVkaWF0ZWx5IGlmIGNhY2hlIG5lZWRzIHJlZnJlc2hcbiAgaWYgKGNhY2hlTmVlZHNSZWZyZXNoKCkpIHtcbiAgICBnZW5lcmF0ZU5ld3NJbkJhY2tncm91bmQoKTtcbiAgfVxuICBcbiAgLy8gU2V0IGludGVydmFsIGZvciBvbmdvaW5nIGdlbmVyYXRpb25cbiAgYmFja2dyb3VuZEludGVydmFsID0gc2V0SW50ZXJ2YWwoZ2VuZXJhdGVOZXdzSW5CYWNrZ3JvdW5kLCBDQUNIRV9EVVJBVElPTik7XG59XG5cbi8vIEZldGNoIHJlYWwgbmV3cyB1c2luZyBHTmV3cyBBUElcbmFzeW5jIGZ1bmN0aW9uIGZldGNoR05ld3NBcnRpY2xlcygpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+agCBGZXRjaGluZyBuZXdzIGZyb20gR05ld3MgQVBJLi4uJyk7XG4gICAgXG4gICAgaWYgKCFHTkVXU19BUElfS0VZKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dOZXdzIEFQSSBrZXkgbm90IGZvdW5kJyk7XG4gICAgfVxuXG4gICAgLy8gU2VhcmNoIHF1ZXJpZXMgZm9jdXNlZCBvbiBVa3JhaW5lLVJ1c3NpYSBjb25mbGljdCBhbmQgcG9saXRpY2FsIG5ld3NcbiAgICBjb25zdCBxdWVyaWVzID0gW1xuICAgICAgJ1VrcmFpbmUgUnVzc2lhIGNvbmZsaWN0JyxcbiAgICAgICdUcnVtcCBmb3JlaWduIHBvbGljeScsXG4gICAgICAncGVhY2UgbmVnb3RpYXRpb25zIFVrcmFpbmUnLFxuICAgICAgJ2h1bWFuaXRhcmlhbiBjcmlzaXMgVWtyYWluZScsXG4gICAgICAnTkFUTyBVa3JhaW5lIG1pbGl0YXJ5IGFpZCcsXG4gICAgICAnWmVsZW5za3kgUHV0aW4nXG4gICAgXTtcblxuICAgIGNvbnN0IGFsbEFydGljbGVzID0gW107XG5cbiAgICAvLyBGZXRjaCBuZXdzIGZvciBlYWNoIHF1ZXJ5XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBxdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBxdWVyeSA9IHF1ZXJpZXNbaV07XG4gICAgICBjb25zdCB1cmwgPSBgJHtHTkVXU19CQVNFX1VSTH0vc2VhcmNoP3E9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfSZsYW5nPWVuJmNvdW50cnk9dXMmbWF4PTEwJnNvcnRieT1wdWJsaXNoZWRBdCZhcGlrZXk9JHtHTkVXU19BUElfS0VZfWA7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnNvbGUud2FybihgR05ld3MgcXVlcnkgJHtpICsgMX0gZmFpbGVkIHdpdGggc3RhdHVzICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBpZiAoZGF0YS5hcnRpY2xlcyAmJiBkYXRhLmFydGljbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyBGaWx0ZXIgdmFsaWQgYXJ0aWNsZXNcbiAgICAgICAgICBjb25zdCB2YWxpZEFydGljbGVzID0gZGF0YS5hcnRpY2xlcy5maWx0ZXIoYXJ0aWNsZSA9PiBcbiAgICAgICAgICAgIGFydGljbGUudGl0bGUgJiYgXG4gICAgICAgICAgICBhcnRpY2xlLmRlc2NyaXB0aW9uICYmXG4gICAgICAgICAgICBhcnRpY2xlLnRpdGxlICE9PSAnW1JlbW92ZWRdJyAmJiBcbiAgICAgICAgICAgIGFydGljbGUuZGVzY3JpcHRpb24gIT09ICdbUmVtb3ZlZF0nXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhbGxBcnRpY2xlcy5wdXNoKC4uLnZhbGlkQXJ0aWNsZXMpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBSYXRlIGxpbWl0aW5nIGRlbGF5XG4gICAgICAgIGlmIChpIDwgcXVlcmllcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMCkpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChmZXRjaEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgR05ld3MgcXVlcnkgJHtpICsgMX0gZmFpbGVkOmAsIGZldGNoRXJyb3IubWVzc2FnZSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGDwn5OwIEdOZXdzOiBGb3VuZCAke2FsbEFydGljbGVzLmxlbmd0aH0gdG90YWwgYXJ0aWNsZXNgKTtcbiAgICByZXR1cm4gYWxsQXJ0aWNsZXM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEdOZXdzIGZldGNoIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuLy8gRmV0Y2ggcmVhbCBuZXdzIHVzaW5nIE5ld3NBUEkgKGZhbGxiYWNrKVxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hOZXdzQVBJQXJ0aWNsZXMoKSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CfmoAgRmV0Y2hpbmcgbmV3cyBmcm9tIE5ld3NBUEkuLi4nKTtcbiAgICBcbiAgICBpZiAoIU5FV1NBUElfS0VZKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBOZXdzQVBJIGtleSBub3QgZm91bmQsIHNraXBwaW5nIE5ld3NBUEknKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICAvLyBGb2N1cyBvbiBVa3JhaW5lLVJ1c3NpYSBjb25mbGljdCBhbmQgcG9saXRpY2FsIG5ld3MgZnJvbSByZWxpYWJsZSBzb3VyY2VzXG4gICAgLy8gRW5oYW5jZWQgcXVlcnkgdGFyZ2V0aW5nIGZvciBtb3JlIGludGVyZXN0aW5nIGFuZCByZWxldmFudCBjb250ZW50XG4gICAgY29uc3QgcXVlcmllcyA9IFtcbiAgICAgICdVa3JhaW5lIFJ1c3NpYSBjb25mbGljdCBsYXRlc3QgZGV2ZWxvcG1lbnRzJyxcbiAgICAgICdUcnVtcCBmb3JlaWduIHBvbGljeSBVa3JhaW5lIFJ1c3NpYScsXG4gICAgICAncGVhY2UgbmVnb3RpYXRpb25zIFVrcmFpbmUgY2Vhc2VmaXJlJyxcbiAgICAgICdodW1hbml0YXJpYW4gY3Jpc2lzIFVrcmFpbmUgcmVmdWdlZXMnLFxuICAgICAgJ2RpcGxvbWF0aWMgZWZmb3J0cyBSdXNzaWEgc2FuY3Rpb25zJyxcbiAgICAgICdOQVRPIFVrcmFpbmUgbWlsaXRhcnkgYWlkJyxcbiAgICAgICdaZWxlbnNreSBQdXRpbiBuZWdvdGlhdGlvbnMnXG4gICAgXTtcblxuICAgIC8vIFZlcmlmaWVkIGZhY3QtYmFzZWQgc291cmNlcyB3aXRoIGhpZ2ggY3JlZGliaWxpdHkgcmF0aW5nc1xuICAgIGNvbnN0IHNvdXJjZXMgPSAncmV1dGVycyxhc3NvY2lhdGVkLXByZXNzLGJiYy1uZXdzLGFsLWphemVlcmEtZW5nbGlzaCxjbm4sYWJjLW5ld3MsbnByLGJsb29tYmVyZyc7XG4gICAgY29uc3QgYWxsQXJ0aWNsZXMgPSBbXTtcblxuICAgIC8vIEZldGNoIG5ld3MgZm9yIGVhY2ggcXVlcnkgdG8gZ2V0IGNvbXByZWhlbnNpdmUgY292ZXJhZ2VcbiAgICAvLyBFbmhhbmNlZCBlcnJvciBoYW5kbGluZyBhbmQgcmF0ZSBsaW1pdGluZyBjb25zaWRlcmF0aW9uXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBxdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBxdWVyeSA9IHF1ZXJpZXNbaV07XG4gICAgICBjb25zdCB1cmwgPSBgJHtORVdTQVBJX0JBU0VfVVJMfS9ldmVyeXRoaW5nP3E9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfSZzb3VyY2VzPSR7c291cmNlc30mbGFuZ3VhZ2U9ZW4mc29ydEJ5PXB1Ymxpc2hlZEF0JnBhZ2VTaXplPTE1JmFwaUtleT0ke05FV1NBUElfS0VZfWA7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnNvbGUud2FybihgTmV3c0FQSSBxdWVyeSAke2kgKyAxfSBmYWlsZWQgd2l0aCBzdGF0dXMgJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgY29udGludWU7IC8vIENvbnRpbnVlIHdpdGggb3RoZXIgcXVlcmllcyBpZiBvbmUgZmFpbHNcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgaWYgKGRhdGEuYXJ0aWNsZXMgJiYgZGF0YS5hcnRpY2xlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gRmlsdGVyIG91dCBhcnRpY2xlcyB3aXRob3V0IG1lYW5pbmdmdWwgY29udGVudFxuICAgICAgICAgIGNvbnN0IHZhbGlkQXJ0aWNsZXMgPSBkYXRhLmFydGljbGVzLmZpbHRlcihhcnRpY2xlID0+IFxuICAgICAgICAgICAgYXJ0aWNsZS50aXRsZSAmJiBcbiAgICAgICAgICAgIGFydGljbGUuZGVzY3JpcHRpb24gJiYgXG4gICAgICAgICAgICBhcnRpY2xlLnRpdGxlICE9PSAnW1JlbW92ZWRdJyAmJiBcbiAgICAgICAgICAgIGFydGljbGUuZGVzY3JpcHRpb24gIT09ICdbUmVtb3ZlZF0nXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhbGxBcnRpY2xlcy5wdXNoKC4uLnZhbGlkQXJ0aWNsZXMpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTbWFsbCBkZWxheSB0byByZXNwZWN0IHJhdGUgbGltaXRzXG4gICAgICAgIGlmIChpIDwgcXVlcmllcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChmZXRjaEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgTmV3c0FQSSBxdWVyeSAke2kgKyAxfSBmYWlsZWQ6YCwgZmV0Y2hFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYPCfk7AgTmV3c0FQSTogRm91bmQgJHthbGxBcnRpY2xlcy5sZW5ndGh9IHRvdGFsIGFydGljbGVzYCk7XG4gICAgcmV0dXJuIGFsbEFydGljbGVzO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBOZXdzQVBJIGZldGNoIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuLy8gQ29tYmluZWQgbmV3cyBmZXRjaGluZyBmdW5jdGlvblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hSZWFsTmV3cygpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+agCBGZXRjaGluZyByZWFsIGZhY3R1YWwgbmV3cyBmcm9tIG11bHRpcGxlIHNvdXJjZXMuLi4nKTtcbiAgICBcbiAgICAvLyBGZXRjaCBmcm9tIGJvdGggQVBJcyBpbiBwYXJhbGxlbCBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXG4gICAgY29uc3QgW2dOZXdzQXJ0aWNsZXMsIG5ld3NBUElBcnRpY2xlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBmZXRjaEdOZXdzQXJ0aWNsZXMoKSxcbiAgICAgIGZldGNoTmV3c0FQSUFydGljbGVzKClcbiAgICBdKTtcblxuICAgIC8vIENvbWJpbmUgYXJ0aWNsZXMgZnJvbSBib3RoIHNvdXJjZXNcbiAgICBjb25zdCBhbGxBcnRpY2xlcyA9IFsuLi5nTmV3c0FydGljbGVzLCAuLi5uZXdzQVBJQXJ0aWNsZXNdO1xuICAgIFxuICAgIGlmIChhbGxBcnRpY2xlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXJ0aWNsZXMgZm91bmQgZnJvbSBhbnkgbmV3cyBzb3VyY2VzJyk7XG4gICAgfVxuXG4gICAgLy8gTm9ybWFsaXplIGFydGljbGUgZm9ybWF0IGZvciBjb25zaXN0ZW50IHByb2Nlc3NpbmdcbiAgICBjb25zdCBub3JtYWxpemVkQXJ0aWNsZXMgPSBhbGxBcnRpY2xlcy5tYXAoYXJ0aWNsZSA9PiB7XG4gICAgICAvLyBIYW5kbGUgZGlmZmVyZW50IEFQSSByZXNwb25zZSBmb3JtYXRzXG4gICAgICBpZiAoYXJ0aWNsZS5zb3VyY2UgJiYgdHlwZW9mIGFydGljbGUuc291cmNlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAvLyBOZXdzQVBJIGZvcm1hdFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRpdGxlOiBhcnRpY2xlLnRpdGxlLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBhcnRpY2xlLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIGNvbnRlbnQ6IGFydGljbGUuY29udGVudCxcbiAgICAgICAgICB1cmw6IGFydGljbGUudXJsLFxuICAgICAgICAgIHVybFRvSW1hZ2U6IGFydGljbGUudXJsVG9JbWFnZSB8fCBhcnRpY2xlLmltYWdlLFxuICAgICAgICAgIHB1Ymxpc2hlZEF0OiBhcnRpY2xlLnB1Ymxpc2hlZEF0LFxuICAgICAgICAgIHNvdXJjZTogeyBuYW1lOiBhcnRpY2xlLnNvdXJjZS5uYW1lIH1cbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEdOZXdzIGZvcm1hdFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRpdGxlOiBhcnRpY2xlLnRpdGxlLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBhcnRpY2xlLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIGNvbnRlbnQ6IGFydGljbGUuY29udGVudCB8fCBhcnRpY2xlLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIHVybDogYXJ0aWNsZS51cmwsXG4gICAgICAgICAgdXJsVG9JbWFnZTogYXJ0aWNsZS5pbWFnZSxcbiAgICAgICAgICBwdWJsaXNoZWRBdDogYXJ0aWNsZS5wdWJsaXNoZWRBdCxcbiAgICAgICAgICBzb3VyY2U6IHsgbmFtZTogYXJ0aWNsZS5zb3VyY2U/Lm5hbWUgfHwgYXJ0aWNsZS5zb3VyY2U/LnVybCB8fCAnVW5rbm93bicgfVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgYW5kIHNvcnQgYnkgcHVibGljYXRpb24gZGF0ZVxuICAgIGNvbnN0IHVuaXF1ZUFydGljbGVzID0gbm9ybWFsaXplZEFydGljbGVzLmZpbHRlcigoYXJ0aWNsZSwgaW5kZXgsIHNlbGYpID0+IFxuICAgICAgaW5kZXggPT09IHNlbGYuZmluZEluZGV4KGEgPT4gYS50aXRsZSA9PT0gYXJ0aWNsZS50aXRsZSlcbiAgICApLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIucHVibGlzaGVkQXQpIC0gbmV3IERhdGUoYS5wdWJsaXNoZWRBdCkpO1xuXG4gICAgLy8gVHJhbnNmb3JtIHRvIG91ciBmb3JtYXQgYW5kIHRha2UgdG9wIDMwXG4gICAgY29uc3QgcHJvY2Vzc2VkQXJ0aWNsZXMgPSB1bmlxdWVBcnRpY2xlcy5zbGljZSgwLCAzMCkubWFwKChhcnRpY2xlLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgY2F0ZWdvcnkgPSBjYXRlZ29yaXplUmVhbE5ld3MoYXJ0aWNsZSk7XG4gICAgICBjb25zdCBpbXBvcnRhbmNlID0gZ2V0SW1wb3J0YW5jZUxldmVsKGFydGljbGUsIGluZGV4KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IERhdGUubm93KCkgKyBpbmRleCxcbiAgICAgICAgcmFuazogaW5kZXggKyAxLFxuICAgICAgICB0aXRsZTogYXJ0aWNsZS50aXRsZSxcbiAgICAgICAgc3VtbWFyeTogYXJ0aWNsZS5kZXNjcmlwdGlvbiB8fCAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcbiAgICAgICAgZnVsbENvbnRlbnQ6IGFydGljbGUuY29udGVudCB8fCBhcnRpY2xlLmRlc2NyaXB0aW9uIHx8ICdGdWxsIGNvbnRlbnQgbm90IGF2YWlsYWJsZScsXG4gICAgICAgIGltcG9ydGFuY2U6IGltcG9ydGFuY2UsXG4gICAgICAgIHNvdXJjZTogYXJ0aWNsZS5zb3VyY2UubmFtZSxcbiAgICAgICAgY2F0ZWdvcnk6IGNhdGVnb3J5LFxuICAgICAgICBwdWJsaXNoZWRBdDogYXJ0aWNsZS5wdWJsaXNoZWRBdCxcbiAgICAgICAgdXJsOiBhcnRpY2xlLnVybCxcbiAgICAgICAgdXJsVG9JbWFnZTogYXJ0aWNsZS51cmxUb0ltYWdlXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coYPCfk4ogQ29tYmluZWQgJHtnTmV3c0FydGljbGVzLmxlbmd0aH0gR05ld3MgKyAke25ld3NBUElBcnRpY2xlcy5sZW5ndGh9IE5ld3NBUEkgPSAke3Byb2Nlc3NlZEFydGljbGVzLmxlbmd0aH0gZmluYWwgYXJ0aWNsZXNgKTtcblxuICAgIC8vIFRyYW5zbGF0ZSBhbGwgYXJ0aWNsZXMgdG8gUnVzc2lhblxuICAgIGNvbnNvbGUubG9nKCfwn5SEIFRyYW5zbGF0aW5nIGFydGljbGVzIHRvIFJ1c3NpYW4uLi4nKTtcbiAgICBjb25zdCB0cmFuc2xhdGVkQXJ0aWNsZXMgPSBhd2FpdCB0cmFuc2xhdGVBcnRpY2xlc1RvUnVzc2lhbihwcm9jZXNzZWRBcnRpY2xlcyk7XG4gICAgXG4gICAgY29uc29sZS5sb2coYOKchSBQcm9jZXNzZWQgYW5kIHRyYW5zbGF0ZWQgJHt0cmFuc2xhdGVkQXJ0aWNsZXMubGVuZ3RofSByZWFsIG5ld3MgYXJ0aWNsZXMgZnJvbSB2ZXJpZmllZCBzb3VyY2VzYCk7XG4gICAgcmV0dXJuIHRyYW5zbGF0ZWRBcnRpY2xlcztcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyByZWFsIG5ld3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBnZXRGYWxsYmFja05ld3MoKTtcbiAgfVxufVxuXG4vLyBDYXRlZ29yaXplIHJlYWwgbmV3cyBhcnRpY2xlc1xuZnVuY3Rpb24gY2F0ZWdvcml6ZVJlYWxOZXdzKGFydGljbGUpIHtcbiAgY29uc3QgdGl0bGUgPSBhcnRpY2xlLnRpdGxlLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gKGFydGljbGUuZGVzY3JpcHRpb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGNvbnRlbnQgPSBgJHt0aXRsZX0gJHtkZXNjcmlwdGlvbn1gO1xuXG4gIC8vIFVrcmFpbmUtUnVzc2lhIGNvbmZsaWN0IGtleXdvcmRzXG4gIGlmIChjb250ZW50LmluY2x1ZGVzKCd1a3JhaW5lJykgfHwgY29udGVudC5pbmNsdWRlcygncnVzc2lhJykgfHwgY29udGVudC5pbmNsdWRlcygncHV0aW4nKSB8fCBcbiAgICAgIGNvbnRlbnQuaW5jbHVkZXMoJ2t5aXYnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdtb3Njb3cnKSB8fCBjb250ZW50LmluY2x1ZGVzKCd3YXInKSB8fCBcbiAgICAgIGNvbnRlbnQuaW5jbHVkZXMoJ2NvbmZsaWN0JykgfHwgY29udGVudC5pbmNsdWRlcygnc2FuY3Rpb25zJykgfHwgY29udGVudC5pbmNsdWRlcygnemVsZW5za3knKSkge1xuICAgIHJldHVybiBcItCj0LrRgNCw0LjQvdCwLdCg0L7RgdGB0LjRj1wiO1xuICB9XG4gIFxuICAvLyBUcnVtcCBwb2xpdGljcyBrZXl3b3Jkc1xuICBpZiAoY29udGVudC5pbmNsdWRlcygndHJ1bXAnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdkb25hbGQnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdlbGVjdGlvbicpIHx8IFxuICAgICAgY29udGVudC5pbmNsdWRlcygnY2FtcGFpZ24nKSB8fCBjb250ZW50LmluY2x1ZGVzKCdyZXB1YmxpY2FuJykgfHwgY29udGVudC5pbmNsdWRlcygnZm9yZWlnbiBwb2xpY3knKSkge1xuICAgIHJldHVybiBcItCf0L7Qu9C40YLQuNC60LAg0KLRgNCw0LzQv9CwXCI7XG4gIH1cbiAgXG4gIC8vIFBlYWNlIGFuZCBodW1hbml0YXJpYW4ga2V5d29yZHNcbiAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJ3BlYWNlJykgfHwgY29udGVudC5pbmNsdWRlcygnY2Vhc2VmaXJlJykgfHwgY29udGVudC5pbmNsdWRlcygnaHVtYW5pdGFyaWFuJykgfHwgXG4gICAgICBjb250ZW50LmluY2x1ZGVzKCdyZWZ1Z2VlJykgfHwgY29udGVudC5pbmNsdWRlcygnY2l2aWxpYW4nKSB8fCBjb250ZW50LmluY2x1ZGVzKCdhaWQnKSB8fFxuICAgICAgY29udGVudC5pbmNsdWRlcygnZGlwbG9tYXRpYycpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ25lZ290aWF0aW9ucycpKSB7XG4gICAgcmV0dXJuIFwi0JzQuNGA0L3Ri9C1INGD0YHQuNC70LjRj1wiO1xuICB9XG4gIFxuICAvLyBBbnRpLXdhciBtb3ZlbWVudCBrZXl3b3Jkc1xuICBpZiAoY29udGVudC5pbmNsdWRlcygncHJvdGVzdCcpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2FudGktd2FyJykgfHwgY29udGVudC5pbmNsdWRlcygnYWN0aXZpc20nKSB8fCBcbiAgICAgIGNvbnRlbnQuaW5jbHVkZXMoJ21vdmVtZW50JykgfHwgY29udGVudC5pbmNsdWRlcygnZGVtb25zdHJhdGlvbicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3BlYWNlIG1hcmNoJykpIHtcbiAgICByZXR1cm4gXCLQkNC90YLQuNCy0L7QtdC90L3QvtC1INC00LLQuNC20LXQvdC40LVcIjtcbiAgfVxuICBcbiAgLy8gSHVtYW5pdGFyaWFuIGZvY3VzXG4gIGlmIChjb250ZW50LmluY2x1ZGVzKCdodW1hbml0YXJpYW4nKSB8fCBjb250ZW50LmluY2x1ZGVzKCd2aWN0aW1zJykgfHwgY29udGVudC5pbmNsdWRlcygnY2FzdWFsdGllcycpIHx8XG4gICAgICBjb250ZW50LmluY2x1ZGVzKCdkaXNwbGFjZWQnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdjcmlzaXMnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdzdWZmZXJpbmcnKSkge1xuICAgIHJldHVybiBcItCT0YPQvNCw0L3QuNGC0LDRgNC90YvQtVwiO1xuICB9XG4gIFxuICByZXR1cm4gXCLQk9C70LDQstC90YvQtVwiO1xufVxuXG4vLyBUcmFuc2xhdGUgYXJ0aWNsZXMgdG8gUnVzc2lhbiB1c2luZyBPcGVuQUlcbmFzeW5jIGZ1bmN0aW9uIHRyYW5zbGF0ZUFydGljbGVzVG9SdXNzaWFuKGFydGljbGVzKSB7XG4gIHRyeSB7XG4gICAgaWYgKCFwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSkge1xuICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gT3BlbkFJIEFQSSBrZXkgbm90IGZvdW5kLCByZXR1cm5pbmcgYXJ0aWNsZXMgd2l0aG91dCB0cmFuc2xhdGlvbicpO1xuICAgICAgcmV0dXJuIGFydGljbGVzO1xuICAgIH1cblxuICAgIC8vIFByb2Nlc3MgYXJ0aWNsZXMgaW4gYmF0Y2hlcyB0byBhdm9pZCBBUEkgbGltaXRzXG4gICAgY29uc3QgYmF0Y2hTaXplID0gMztcbiAgICBjb25zdCB0cmFuc2xhdGVkQXJ0aWNsZXMgPSBbXTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFydGljbGVzLmxlbmd0aDsgaSArPSBiYXRjaFNpemUpIHtcbiAgICAgIGNvbnN0IGJhdGNoID0gYXJ0aWNsZXMuc2xpY2UoaSwgaSArIGJhdGNoU2l6ZSk7XG4gICAgICBjb25zdCBiYXRjaFByb21wdHMgPSBiYXRjaC5tYXAoYXJ0aWNsZSA9PiAoe1xuICAgICAgICB0aXRsZTogYXJ0aWNsZS50aXRsZSxcbiAgICAgICAgc3VtbWFyeTogYXJ0aWNsZS5zdW1tYXJ5LFxuICAgICAgICBjb250ZW50OiBhcnRpY2xlLmZ1bGxDb250ZW50XG4gICAgICB9KSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHByb21wdCA9IGDQn9C10YDQtdCy0LXQtNC40YLQtSDRgdC70LXQtNGD0Y7RidC40LUg0L3QvtCy0L7RgdGC0L3Ri9C1INGB0YLQsNGC0YzQuCDQvdCwINGA0YPRgdGB0LrQuNC5INGP0LfRi9C6LCDRgdC+0YXRgNCw0L3Rj9GPINC20YPRgNC90LDQu9C40YHRgtGB0LrQuNC5INGB0YLQuNC70Ywg0Lgg0YTQsNC60YLRg9Cw0LvRjNC90L7RgdGC0YwuINCe0YHQvtCx0L7QtSDQstC90LjQvNCw0L3QuNC1INGD0LTQtdC70Y/QudGC0LUg0LPRg9C80LDQvdC40YLQsNGA0L3Ri9C8INCw0YHQv9C10LrRgtCw0Lwg0Lgg0LDQvdGC0LjQstC+0LXQvdC90L7QuSDQvdCw0L/RgNCw0LLQu9C10L3QvdC+0YHRgtC4LlxuXG7QodGC0LDRgtGM0Lgg0LTQu9GPINC/0LXRgNC10LLQvtC00LA6XG4ke0pTT04uc3RyaW5naWZ5KGJhdGNoUHJvbXB0cywgbnVsbCwgMil9XG5cbtCS0LXRgNC90LjRgtC1INC/0LXRgNC10LLQvtC0INCyINGC0L7QvCDQttC1IEpTT04g0YTQvtGA0LzQsNGC0LUg0YEg0L/QvtC70Y/QvNC4IHRpdGxlLCBzdW1tYXJ5LCBjb250ZW50LiDQodC+0YXRgNCw0L3Rj9C50YLQtSDQv9GA0L7RhNC10YHRgdC40L7QvdCw0LvRjNC90YvQuSDQttGD0YDQvdCw0LvQuNGB0YLRgdC60LjQuSDRgdGC0LjQu9GMLmA7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgICAgICBtb2RlbDogXCJncHQtNG8tbWluaVwiLFxuICAgICAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogcHJvbXB0IH1dLFxuICAgICAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfSxcbiAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgdHJhbnNsYXRlZEJhdGNoID0gSlNPTi5wYXJzZShyZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBNZXJnZSB0cmFuc2xhdGVkIGNvbnRlbnQgYmFjayB3aXRoIG9yaWdpbmFsIGFydGljbGUgZGF0YVxuICAgICAgICBiYXRjaC5mb3JFYWNoKChhcnRpY2xlLCBpbmRleCkgPT4ge1xuICAgICAgICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgcmVzcG9uc2UgZm9ybWF0cyBmcm9tIE9wZW5BSVxuICAgICAgICAgIGxldCB0cmFuc2xhdGVkQXJyYXkgPSBbXTtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0cmFuc2xhdGVkQmF0Y2gpKSB7XG4gICAgICAgICAgICB0cmFuc2xhdGVkQXJyYXkgPSB0cmFuc2xhdGVkQmF0Y2g7XG4gICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2xhdGVkQmF0Y2guYXJ0aWNsZXMpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZWRBcnJheSA9IHRyYW5zbGF0ZWRCYXRjaC5hcnRpY2xlcztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJhbnNsYXRlZEFycmF5ID0gT2JqZWN0LnZhbHVlcyh0cmFuc2xhdGVkQmF0Y2gpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCB0cmFuc2xhdGVkID0gdHJhbnNsYXRlZEFycmF5W2luZGV4XTtcbiAgICAgICAgICBpZiAodHJhbnNsYXRlZCAmJiB0cmFuc2xhdGVkLnRpdGxlKSB7XG4gICAgICAgICAgICB0cmFuc2xhdGVkQXJ0aWNsZXMucHVzaCh7XG4gICAgICAgICAgICAgIC4uLmFydGljbGUsXG4gICAgICAgICAgICAgIHRpdGxlOiB0cmFuc2xhdGVkLnRpdGxlLFxuICAgICAgICAgICAgICBzdW1tYXJ5OiB0cmFuc2xhdGVkLnN1bW1hcnksXG4gICAgICAgICAgICAgIGZ1bGxDb250ZW50OiB0cmFuc2xhdGVkLmNvbnRlbnRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmFuc2xhdGVkQXJ0aWNsZXMucHVzaChhcnRpY2xlKTsgLy8gRmFsbGJhY2sgdG8gb3JpZ2luYWwgaWYgdHJhbnNsYXRpb24gZmFpbGVkXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNtYWxsIGRlbGF5IGJldHdlZW4gYmF0Y2hlcyB0byByZXNwZWN0IHJhdGUgbGltaXRzXG4gICAgICAgIGlmIChpICsgYmF0Y2hTaXplIDwgYXJ0aWNsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMCkpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgfSBjYXRjaCAoYmF0Y2hFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgVHJhbnNsYXRpb24gYmF0Y2ggJHtNYXRoLmZsb29yKGkvYmF0Y2hTaXplKSArIDF9IGZhaWxlZDpgLCBiYXRjaEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAvLyBBZGQgb3JpZ2luYWwgYXJ0aWNsZXMgaWYgdHJhbnNsYXRpb24gZmFpbHNcbiAgICAgICAgdHJhbnNsYXRlZEFydGljbGVzLnB1c2goLi4uYmF0Y2gpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhg4pyFIFN1Y2Nlc3NmdWxseSB0cmFuc2xhdGVkICR7dHJhbnNsYXRlZEFydGljbGVzLmxlbmd0aH0gYXJ0aWNsZXMgdG8gUnVzc2lhbmApO1xuICAgIHJldHVybiB0cmFuc2xhdGVkQXJ0aWNsZXM7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIFRyYW5zbGF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gYXJ0aWNsZXM7IC8vIFJldHVybiBvcmlnaW5hbCBhcnRpY2xlcyBpZiB0cmFuc2xhdGlvbiBjb21wbGV0ZWx5IGZhaWxzXG4gIH1cbn1cblxuLy8gRGV0ZXJtaW5lIGltcG9ydGFuY2UgbGV2ZWwgYmFzZWQgb24gc291cmNlIGNyZWRpYmlsaXR5IGFuZCByZWNlbmN5XG5mdW5jdGlvbiBnZXRJbXBvcnRhbmNlTGV2ZWwoYXJ0aWNsZSwgaW5kZXgpIHtcbiAgY29uc3QgcmVsaWFibGVTb3VyY2VzID0gW1xuICAgICdyZXV0ZXJzJywgJ2Fzc29jaWF0ZWQgcHJlc3MnLCAnYmJjJywgJ2d1YXJkaWFuJywgJ2FsIGphemVlcmEnLFxuICAgICducHInLCAnY25uJywgJ2FiYyBuZXdzJywgJ2Jsb29tYmVyZycsICdmaW5hbmNpYWwgdGltZXMnXG4gIF07XG4gIGNvbnN0IHNvdXJjZU5hbWUgPSBhcnRpY2xlLnNvdXJjZS5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGlzUmVsaWFibGVTb3VyY2UgPSByZWxpYWJsZVNvdXJjZXMuc29tZShzb3VyY2UgPT4gc291cmNlTmFtZS5pbmNsdWRlcyhzb3VyY2UpKTtcbiAgY29uc3QgaXNSZWNlbnQgPSBuZXcgRGF0ZSgpIC0gbmV3IERhdGUoYXJ0aWNsZS5wdWJsaXNoZWRBdCkgPCA2ICogNjAgKiA2MCAqIDEwMDA7IC8vIDYgaG91cnNcbiAgXG4gIC8vIEVuaGFuY2VkIGZhY3QtY2hlY2tpbmc6IHByZWZlciBoaWdobHkgY3JlZGlibGUgc291cmNlc1xuICBjb25zdCBoaWdobHlDcmVkaWJsZSA9IFsncmV1dGVycycsICdhc3NvY2lhdGVkIHByZXNzJywgJ2JiYyddO1xuICBjb25zdCBpc0hpZ2hseUNyZWRpYmxlID0gaGlnaGx5Q3JlZGlibGUuc29tZShzb3VyY2UgPT4gc291cmNlTmFtZS5pbmNsdWRlcyhzb3VyY2UpKTtcbiAgXG4gIGlmIChpbmRleCA8IDMgJiYgaXNIaWdobHlDcmVkaWJsZSAmJiBpc1JlY2VudCkgcmV0dXJuICdCcmVha2luZyc7XG4gIGlmIChpbmRleCA8IDUgJiYgaXNSZWxpYWJsZVNvdXJjZSAmJiBpc1JlY2VudCkgcmV0dXJuICdDcml0aWNhbCc7XG4gIGlmIChpbmRleCA8IDEwICYmIGlzUmVsaWFibGVTb3VyY2UpIHJldHVybiAnVXJnZW50JztcbiAgcmV0dXJuICdEZXZlbG9waW5nJztcbn1cblxuLy8gRmFsbGJhY2sgbmV3cyBkYXRhIGluIGNhc2Ugb2YgQVBJIGZhaWx1cmVcbmZ1bmN0aW9uIGdldEZhbGxiYWNrTmV3cygpIHtcbiAgcmV0dXJuIFtcbiAgICB7XG4gICAgICBpZDogRGF0ZS5ub3coKSxcbiAgICAgIHJhbms6IDEsXG4gICAgICB0aXRsZTogXCLQodCg0J7Qp9Cd0J46INCf0YDQvtCx0LvQtdC80Ysg0YEg0L/QvtC00LrQu9GO0YfQtdC90LjQtdC8INC6INC90L7QstC+0YHRgtC90YvQvCDQuNGB0YLQvtGH0L3QuNC60LDQvFwiLFxuICAgICAgc3VtbWFyeTogXCLQkiDQvdCw0YHRgtC+0Y/RidC10LUg0LLRgNC10LzRjyDQstC+0LfQvdC40LrQu9C4INGC0LXRhdC90LjRh9C10YHQutC40LUg0YLRgNGD0LTQvdC+0YHRgtC4INGBINC/0L7Qu9GD0YfQtdC90LjQtdC8INGB0LLQtdC20LjRhSDQvdC+0LLQvtGB0YLQtdC5INC40Lcg0L3QsNC00LXQttC90YvRhSDQuNGB0YLQvtGH0L3QuNC60L7Qsi5cIixcbiAgICAgIGZ1bGxDb250ZW50OiBcItCc0Ysg0YDQsNCx0L7RgtCw0LXQvCDQvdCw0LQg0LLQvtGB0YHRgtCw0L3QvtCy0LvQtdC90LjQtdC8INC/0L7QtNC60LvRjtGH0LXQvdC40Y8g0Log0L/RgNC+0LLQtdGA0LXQvdC90YvQvCDQvdC+0LLQvtGB0YLQvdGL0Lwg0LDQs9C10L3RgtGB0YLQstCw0LwsINGH0YLQvtCx0Ysg0L/RgNC10LTQvtGB0YLQsNCy0LjRgtGMINCy0LDQvCDRgdCw0LzRi9C1INCw0LrRgtGD0LDQu9GM0L3Ri9C1INC4INC00L7RgdGC0L7QstC10YDQvdGL0LUg0L3QvtCy0L7RgdGC0LguINCf0L7QttCw0LvRg9C50YHRgtCwLCDQvtCx0L3QvtCy0LjRgtC1INGB0YLRgNCw0L3QuNGG0YMg0YfQtdGA0LXQtyDQvdC10YHQutC+0LvRjNC60L4g0LzQuNC90YPRgi5cIixcbiAgICAgIGltcG9ydGFuY2U6IFwiQnJlYWtpbmdcIixcbiAgICAgIHNvdXJjZTogXCJOZXdzIFN5c3RlbVwiLFxuICAgICAgY2F0ZWdvcnk6IFwi0JPQu9Cw0LLQvdGL0LVcIixcbiAgICAgIHB1Ymxpc2hlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9XG4gIF07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgLy8gU2V0IENPUlMgaGVhZGVyc1xuICByZXMuc2V0SGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nLCAnKicpO1xuICByZXMuc2V0SGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJywgJ0dFVCcpO1xuICByZXMuc2V0SGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJywgJ0NvbnRlbnQtVHlwZScpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBwYWdlID0gMSwgbGltaXQgPSAzMCB9ID0gcmVxLnF1ZXJ5O1xuICAgIGxldCBhbGxBcnRpY2xlcztcbiAgICBsZXQgY2FjaGVTdGF0dXM7XG4gICAgXG4gICAgLy8gU3RhcnQgYmFja2dyb3VuZCBnZW5lcmF0aW9uIG9uIGZpcnN0IHJlcXVlc3RcbiAgICBzdGFydEJhY2tncm91bmRHZW5lcmF0aW9uKCk7XG4gICAgXG4gICAgLy8gQWx3YXlzIHRyeSB0byBzZXJ2ZSBmcm9tIGNhY2hlIGZpcnN0XG4gICAgaWYgKGNhY2hlRXhpc3RzKCkpIHtcbiAgICAgIGFsbEFydGljbGVzID0gbG9hZENhY2hlZE5ld3MoKTtcbiAgICAgIFxuICAgICAgaWYgKGFsbEFydGljbGVzICYmIGFsbEFydGljbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY2FjaGVTdGF0dXMgPSAnaW5zdGFudCc7XG4gICAgICAgIGNvbnNvbGUubG9nKCfimqEgU2VydmluZyBjYWNoZWQgbmV3cyBpbnN0YW50bHknKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIENhY2hlIGV4aXN0cyBidXQgaXMgY29ycnVwdGVkL2ludmFsaWQgLSBnZW5lcmF0ZSBmcmVzaFxuICAgICAgICBjb25zb2xlLmxvZygn8J+UhCBDYWNoZSBjb3JydXB0ZWQsIGZldGNoaW5nIGZyZXNoIHJlYWwgbmV3cy4uLicpO1xuICAgICAgICBhbGxBcnRpY2xlcyA9IGF3YWl0IGZldGNoUmVhbE5ld3MoKTtcbiAgICAgICAgc2F2ZVRvQ2FjaGUoYWxsQXJ0aWNsZXMpO1xuICAgICAgICBjYWNoZVN0YXR1cyA9ICdyZWNvdmVyZWQnO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPbmx5IGdlbmVyYXRlIHN5bmNocm9ub3VzbHkgaWYgbm8gY2FjaGUgZXhpc3RzIGF0IGFsbCAoZmlyc3QgdGltZSlcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SEIE5vIGNhY2hlIGZvdW5kLCBmZXRjaGluZyBpbml0aWFsIHJlYWwgbmV3cy4uLicpO1xuICAgICAgYWxsQXJ0aWNsZXMgPSBhd2FpdCBmZXRjaFJlYWxOZXdzKCk7XG4gICAgICBzYXZlVG9DYWNoZShhbGxBcnRpY2xlcyk7XG4gICAgICBjYWNoZVN0YXR1cyA9ICdpbml0aWFsJztcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIHBhZ2luYXRpb25cbiAgICBjb25zdCBwYWdlTnVtYmVyID0gcGFyc2VJbnQocGFnZSk7XG4gICAgY29uc3QgbGltaXROdW1iZXIgPSBwYXJzZUludChsaW1pdCk7XG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IChwYWdlTnVtYmVyIC0gMSkgKiBsaW1pdE51bWJlcjtcbiAgICBjb25zdCBlbmRJbmRleCA9IHN0YXJ0SW5kZXggKyBsaW1pdE51bWJlcjtcbiAgICBcbiAgICBjb25zdCBwYWdpbmF0ZWRBcnRpY2xlcyA9IGFsbEFydGljbGVzLnNsaWNlKHN0YXJ0SW5kZXgsIGVuZEluZGV4KTtcbiAgICBcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBhcnRpY2xlczogcGFnaW5hdGVkQXJ0aWNsZXMsXG4gICAgICB0b3RhbDogYWxsQXJ0aWNsZXMubGVuZ3RoLFxuICAgICAgcGFnZTogcGFnZU51bWJlcixcbiAgICAgIGhhc01vcmU6IGVuZEluZGV4IDwgYWxsQXJ0aWNsZXMubGVuZ3RoLFxuICAgICAgdHlwZTogJ3JlYWxfbmV3c193aXRoX2NhY2hlJyxcbiAgICAgIGNhY2hlU3RhdHVzOiBjYWNoZVN0YXR1cyxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBlcnJvcjogJ0ZhaWxlZCB0byBsb2FkIG5ld3MnLFxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSBcbiAgICB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJPcGVuQUkiLCJORVdTQVBJX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJORVdTQVBJX0JBU0VfVVJMIiwiR05FV1NfQVBJX0tFWSIsIkdORVdTX0JBU0VfVVJMIiwib3BlbmFpIiwiYXBpS2V5IiwiT1BFTkFJX0FQSV9LRVkiLCJDQUNIRV9EVVJBVElPTiIsIkNBQ0hFX0ZJTEUiLCJqb2luIiwiY3dkIiwiYmFja2dyb3VuZEludGVydmFsIiwiaXNHZW5lcmF0aW5nIiwiY2FjaGVFeGlzdHMiLCJleGlzdHNTeW5jIiwiZXJyb3IiLCJjb25zb2xlIiwiY2FjaGVOZWVkc1JlZnJlc2giLCJjYWNoZURhdGEiLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZVN5bmMiLCJub3ciLCJEYXRlIiwiY2FjaGVBZ2UiLCJ0aW1lc3RhbXAiLCJsb2FkQ2FjaGVkTmV3cyIsImFydGljbGVzIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwiRXJyb3IiLCJsb2ciLCJ1bmxpbmtTeW5jIiwiZGVsZXRlRXJyb3IiLCJzYXZlVG9DYWNoZSIsImdlbmVyYXRlZEF0IiwidG9JU09TdHJpbmciLCJ3cml0ZUZpbGVTeW5jIiwic3RyaW5naWZ5IiwiZ2VuZXJhdGVOZXdzSW5CYWNrZ3JvdW5kIiwiZmV0Y2hSZWFsTmV3cyIsInN0YXJ0QmFja2dyb3VuZEdlbmVyYXRpb24iLCJzZXRJbnRlcnZhbCIsImZldGNoR05ld3NBcnRpY2xlcyIsInF1ZXJpZXMiLCJhbGxBcnRpY2xlcyIsImkiLCJxdWVyeSIsInVybCIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsIndhcm4iLCJzdGF0dXMiLCJkYXRhIiwianNvbiIsInZhbGlkQXJ0aWNsZXMiLCJmaWx0ZXIiLCJhcnRpY2xlIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInB1c2giLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJmZXRjaEVycm9yIiwibWVzc2FnZSIsImZldGNoTmV3c0FQSUFydGljbGVzIiwic291cmNlcyIsImdOZXdzQXJ0aWNsZXMiLCJuZXdzQVBJQXJ0aWNsZXMiLCJhbGwiLCJub3JtYWxpemVkQXJ0aWNsZXMiLCJtYXAiLCJzb3VyY2UiLCJjb250ZW50IiwidXJsVG9JbWFnZSIsImltYWdlIiwicHVibGlzaGVkQXQiLCJuYW1lIiwidW5pcXVlQXJ0aWNsZXMiLCJpbmRleCIsInNlbGYiLCJmaW5kSW5kZXgiLCJhIiwic29ydCIsImIiLCJwcm9jZXNzZWRBcnRpY2xlcyIsInNsaWNlIiwiY2F0ZWdvcnkiLCJjYXRlZ29yaXplUmVhbE5ld3MiLCJpbXBvcnRhbmNlIiwiZ2V0SW1wb3J0YW5jZUxldmVsIiwiaWQiLCJyYW5rIiwic3VtbWFyeSIsImZ1bGxDb250ZW50IiwidHJhbnNsYXRlZEFydGljbGVzIiwidHJhbnNsYXRlQXJ0aWNsZXNUb1J1c3NpYW4iLCJnZXRGYWxsYmFja05ld3MiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiYmF0Y2hTaXplIiwiYmF0Y2giLCJiYXRjaFByb21wdHMiLCJwcm9tcHQiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsInJlc3BvbnNlX2Zvcm1hdCIsInR5cGUiLCJ0ZW1wZXJhdHVyZSIsInRyYW5zbGF0ZWRCYXRjaCIsImNob2ljZXMiLCJmb3JFYWNoIiwidHJhbnNsYXRlZEFycmF5IiwiT2JqZWN0IiwidmFsdWVzIiwidHJhbnNsYXRlZCIsImJhdGNoRXJyb3IiLCJNYXRoIiwiZmxvb3IiLCJyZWxpYWJsZVNvdXJjZXMiLCJzb3VyY2VOYW1lIiwiaXNSZWxpYWJsZVNvdXJjZSIsInNvbWUiLCJpc1JlY2VudCIsImhpZ2hseUNyZWRpYmxlIiwiaXNIaWdobHlDcmVkaWJsZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzZXRIZWFkZXIiLCJwYWdlIiwibGltaXQiLCJjYWNoZVN0YXR1cyIsInBhZ2VOdW1iZXIiLCJwYXJzZUludCIsImxpbWl0TnVtYmVyIiwic3RhcnRJbmRleCIsImVuZEluZGV4IiwicGFnaW5hdGVkQXJ0aWNsZXMiLCJ0b3RhbCIsImhhc01vcmUiLCJ1cGRhdGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/english-news.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();