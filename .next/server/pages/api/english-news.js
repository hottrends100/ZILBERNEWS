"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/english-news";
exports.ids = ["pages/api/english-news"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/english-news.js */ \"(api)/./pages/api/english-news.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/english-news\",\n        pathname: \"/api/english-news\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmVuZ2xpc2gtbmV3cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZW5nbGlzaC1uZXdzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3VwZXItbmV3cy8/ZGMwZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2VuZ2xpc2gtbmV3cy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2VuZ2xpc2gtbmV3c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2VuZ2xpc2gtbmV3c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/english-news.js":
/*!***********************************!*\
  !*** ./pages/api/english-news.js ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_2__]);\nopenai__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// API configurations\nconst NEWSAPI_KEY = process.env.NEWSAPI_KEY;\nconst NEWSAPI_BASE_URL = \"https://newsapi.org/v2\";\nconst GNEWS_API_KEY = process.env.GNEWS_API_KEY;\nconst GNEWS_BASE_URL = \"https://gnews.io/api/v4\";\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// Cache configuration\nconst CACHE_DURATION = 60 * 60 * 1000; // 60 minutes (1 hour) in milliseconds\nconst CACHE_FILE = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"news-cache.json\");\n// Background generation state\nlet backgroundInterval = null;\nlet isGenerating = false;\n// Check if cache exists (we'll always serve from cache if it exists)\nfunction cacheExists() {\n    try {\n        return fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE);\n    } catch (error) {\n        console.error(\"❌ Error checking cache:\", error);\n        return false;\n    }\n}\n// Check if cache needs refresh (for background generation)\nfunction cacheNeedsRefresh() {\n    try {\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE)) {\n            return true;\n        }\n        const cacheData = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(CACHE_FILE, \"utf8\"));\n        const now = Date.now();\n        const cacheAge = now - cacheData.timestamp;\n        return cacheAge >= CACHE_DURATION;\n    } catch (error) {\n        console.error(\"❌ Error reading cache for refresh check:\", error);\n        return true;\n    }\n}\n// Load cached news with self-recovery\nfunction loadCachedNews() {\n    try {\n        const cacheData = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(CACHE_FILE, \"utf8\"));\n        // Validate cache structure\n        if (!cacheData.articles || !Array.isArray(cacheData.articles) || cacheData.articles.length === 0) {\n            throw new Error(\"Invalid cache structure or empty articles\");\n        }\n        console.log(`✅ Loaded ${cacheData.articles.length} cached articles`);\n        return cacheData.articles;\n    } catch (error) {\n        console.error(\"❌ Error loading cached news:\", error);\n        // Self-recovery: delete corrupt cache file\n        try {\n            if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE)) {\n                fs__WEBPACK_IMPORTED_MODULE_0___default().unlinkSync(CACHE_FILE);\n                console.log(\"\\uD83D\\uDDD1️ Deleted corrupt cache file for self-recovery\");\n            }\n        } catch (deleteError) {\n            console.error(\"❌ Failed to delete corrupt cache:\", deleteError);\n        }\n        return null;\n    }\n}\n// Save news to cache\nfunction saveToCache(articles) {\n    try {\n        const cacheData = {\n            articles: articles,\n            timestamp: Date.now(),\n            generatedAt: new Date().toISOString()\n        };\n        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(CACHE_FILE, JSON.stringify(cacheData, null, 2));\n        console.log(`💾 Saved ${articles.length} articles to cache`);\n    } catch (error) {\n        console.error(\"❌ Error saving to cache:\", error);\n    }\n}\n// Background news generation\nasync function generateNewsInBackground() {\n    if (isGenerating) {\n        console.log(\"\\uD83D\\uDD04 News generation already in progress, skipping...\");\n        return;\n    }\n    if (!cacheNeedsRefresh()) {\n        console.log(\"\\uD83D\\uDCC1 Cache still fresh, skipping background generation\");\n        return;\n    }\n    isGenerating = true;\n    console.log(\"\\uD83D\\uDD04 Background: Generating fresh news...\");\n    try {\n        const articles = await fetchRealNews();\n        saveToCache(articles);\n        console.log(\"✅ Background: News updated successfully\");\n    } catch (error) {\n        console.error(\"❌ Background generation failed:\", error);\n    } finally{\n        isGenerating = false;\n    }\n}\n// Start background news generation\nfunction startBackgroundGeneration() {\n    if (backgroundInterval) {\n        return; // Already running\n    }\n    console.log(\"\\uD83D\\uDE80 Starting background news generation (every hour)\");\n    // Generate immediately if cache needs refresh\n    if (cacheNeedsRefresh()) {\n        generateNewsInBackground();\n    }\n    // Set interval for ongoing generation\n    backgroundInterval = setInterval(generateNewsInBackground, CACHE_DURATION);\n}\n// Fetch real news using GNews API\nasync function fetchGNewsArticles() {\n    try {\n        console.log(\"\\uD83D\\uDE80 Fetching news from GNews API...\");\n        if (!GNEWS_API_KEY) {\n            throw new Error(\"GNews API key not found\");\n        }\n        // Search queries focused on Ukraine-Russia conflict and political news\n        const queries = [\n            \"Ukraine Russia conflict\",\n            \"Trump foreign policy\",\n            \"peace negotiations Ukraine\",\n            \"humanitarian crisis Ukraine\",\n            \"NATO Ukraine military aid\",\n            \"Zelensky Putin\"\n        ];\n        const allArticles = [];\n        // Fetch news for each query\n        for(let i = 0; i < queries.length; i++){\n            const query = queries[i];\n            const url = `${GNEWS_BASE_URL}/search?q=${encodeURIComponent(query)}&lang=en&country=us&max=10&sortby=publishedAt&apikey=${GNEWS_API_KEY}`;\n            try {\n                const response = await fetch(url);\n                if (!response.ok) {\n                    console.warn(`GNews query ${i + 1} failed with status ${response.status}`);\n                    continue;\n                }\n                const data = await response.json();\n                if (data.articles && data.articles.length > 0) {\n                    // Filter valid articles\n                    const validArticles = data.articles.filter((article)=>article.title && article.description && article.title !== \"[Removed]\" && article.description !== \"[Removed]\");\n                    allArticles.push(...validArticles);\n                }\n                // Rate limiting delay\n                if (i < queries.length - 1) {\n                    await new Promise((resolve)=>setTimeout(resolve, 200));\n                }\n            } catch (fetchError) {\n                console.warn(`GNews query ${i + 1} failed:`, fetchError.message);\n                continue;\n            }\n        }\n        console.log(`📰 GNews: Found ${allArticles.length} total articles`);\n        return allArticles;\n    } catch (error) {\n        console.error(\"❌ GNews fetch error:\", error);\n        return [];\n    }\n}\n// Fetch real news using NewsAPI (fallback)\nasync function fetchNewsAPIArticles() {\n    try {\n        console.log(\"\\uD83D\\uDE80 Fetching news from NewsAPI...\");\n        if (!NEWSAPI_KEY) {\n            console.warn(\"⚠️ NewsAPI key not found, skipping NewsAPI\");\n            return [];\n        }\n        // Focus on Ukraine-Russia conflict and political news from reliable sources\n        // Enhanced query targeting for more interesting and relevant content\n        const queries = [\n            \"Ukraine Russia conflict latest developments\",\n            \"Trump foreign policy Ukraine Russia\",\n            \"peace negotiations Ukraine ceasefire\",\n            \"humanitarian crisis Ukraine refugees\",\n            \"diplomatic efforts Russia sanctions\",\n            \"NATO Ukraine military aid\",\n            \"Zelensky Putin negotiations\"\n        ];\n        // Verified fact-based sources with high credibility ratings\n        const sources = \"reuters,associated-press,bbc-news,al-jazeera-english,cnn,abc-news,npr,bloomberg\";\n        const allArticles = [];\n        // Fetch news for each query to get comprehensive coverage\n        // Enhanced error handling and rate limiting consideration\n        for(let i = 0; i < queries.length; i++){\n            const query = queries[i];\n            const url = `${NEWSAPI_BASE_URL}/everything?q=${encodeURIComponent(query)}&sources=${sources}&language=en&sortBy=publishedAt&pageSize=15&apiKey=${NEWSAPI_KEY}`;\n            try {\n                const response = await fetch(url);\n                if (!response.ok) {\n                    console.warn(`NewsAPI query ${i + 1} failed with status ${response.status}`);\n                    continue; // Continue with other queries if one fails\n                }\n                const data = await response.json();\n                if (data.articles && data.articles.length > 0) {\n                    // Filter out articles without meaningful content\n                    const validArticles = data.articles.filter((article)=>article.title && article.description && article.title !== \"[Removed]\" && article.description !== \"[Removed]\");\n                    allArticles.push(...validArticles);\n                }\n                // Small delay to respect rate limits\n                if (i < queries.length - 1) {\n                    await new Promise((resolve)=>setTimeout(resolve, 100));\n                }\n            } catch (fetchError) {\n                console.warn(`NewsAPI query ${i + 1} failed:`, fetchError.message);\n                continue;\n            }\n        }\n        console.log(`📰 NewsAPI: Found ${allArticles.length} total articles`);\n        return allArticles;\n    } catch (error) {\n        console.error(\"❌ NewsAPI fetch error:\", error);\n        return [];\n    }\n}\n// Combined news fetching function\nasync function fetchRealNews() {\n    try {\n        console.log(\"\\uD83D\\uDE80 Fetching real factual news from multiple sources...\");\n        // Fetch from both APIs in parallel for better performance\n        const [gNewsArticles, newsAPIArticles] = await Promise.all([\n            fetchGNewsArticles(),\n            fetchNewsAPIArticles()\n        ]);\n        // Combine articles from both sources\n        const allArticles = [\n            ...gNewsArticles,\n            ...newsAPIArticles\n        ];\n        if (allArticles.length === 0) {\n            throw new Error(\"No articles found from any news sources\");\n        }\n        // Normalize article format for consistent processing\n        const normalizedArticles = allArticles.map((article)=>{\n            // Handle different API response formats\n            if (article.source && typeof article.source === \"object\") {\n                // NewsAPI format\n                return {\n                    title: article.title,\n                    description: article.description,\n                    content: article.content,\n                    url: article.url,\n                    urlToImage: article.urlToImage || article.image,\n                    publishedAt: article.publishedAt,\n                    source: {\n                        name: article.source.name\n                    }\n                };\n            } else {\n                // GNews format\n                return {\n                    title: article.title,\n                    description: article.description,\n                    content: article.content || article.description,\n                    url: article.url,\n                    urlToImage: article.image,\n                    publishedAt: article.publishedAt,\n                    source: {\n                        name: article.source?.name || article.source?.url || \"Unknown\"\n                    }\n                };\n            }\n        });\n        // Remove duplicates and sort by publication date\n        const uniqueArticles = normalizedArticles.filter((article, index, self)=>index === self.findIndex((a)=>a.title === article.title)).sort((a, b)=>new Date(b.publishedAt) - new Date(a.publishedAt));\n        // Transform to our format and take top 30\n        const processedArticles = uniqueArticles.slice(0, 30).map((article, index)=>{\n            const category = categorizeRealNews(article);\n            const importance = getImportanceLevel(article, index);\n            return {\n                id: Date.now() + index,\n                rank: index + 1,\n                title: article.title,\n                summary: article.description || \"No description available\",\n                fullContent: article.content || article.description || \"Full content not available\",\n                importance: importance,\n                source: article.source.name,\n                category: category,\n                publishedAt: article.publishedAt,\n                url: article.url,\n                urlToImage: article.urlToImage\n            };\n        });\n        console.log(`📊 Combined ${gNewsArticles.length} GNews + ${newsAPIArticles.length} NewsAPI = ${processedArticles.length} final articles`);\n        // Translate all articles to Russian\n        console.log(\"\\uD83D\\uDD04 Translating articles to Russian...\");\n        const translatedArticles = await translateArticlesToRussian(processedArticles);\n        console.log(`✅ Processed and translated ${translatedArticles.length} real news articles from verified sources`);\n        return translatedArticles;\n    } catch (error) {\n        console.error(\"❌ Error fetching real news:\", error);\n        return getFallbackNews();\n    }\n}\n// Categorize real news articles\nfunction categorizeRealNews(article) {\n    const title = article.title.toLowerCase();\n    const description = (article.description || \"\").toLowerCase();\n    const content = `${title} ${description}`;\n    // Ukraine-Russia conflict keywords\n    if (content.includes(\"ukraine\") || content.includes(\"russia\") || content.includes(\"putin\") || content.includes(\"kyiv\") || content.includes(\"moscow\") || content.includes(\"war\") || content.includes(\"conflict\") || content.includes(\"sanctions\") || content.includes(\"zelensky\")) {\n        return \"Украина-Россия\";\n    }\n    // Trump politics keywords\n    if (content.includes(\"trump\") || content.includes(\"donald\") || content.includes(\"election\") || content.includes(\"campaign\") || content.includes(\"republican\") || content.includes(\"foreign policy\")) {\n        return \"Политика Трампа\";\n    }\n    // Peace and humanitarian keywords\n    if (content.includes(\"peace\") || content.includes(\"ceasefire\") || content.includes(\"humanitarian\") || content.includes(\"refugee\") || content.includes(\"civilian\") || content.includes(\"aid\") || content.includes(\"diplomatic\") || content.includes(\"negotiations\")) {\n        return \"Мирные усилия\";\n    }\n    // Anti-war movement keywords\n    if (content.includes(\"protest\") || content.includes(\"anti-war\") || content.includes(\"activism\") || content.includes(\"movement\") || content.includes(\"demonstration\") || content.includes(\"peace march\")) {\n        return \"Антивоенное движение\";\n    }\n    // Humanitarian focus\n    if (content.includes(\"humanitarian\") || content.includes(\"victims\") || content.includes(\"casualties\") || content.includes(\"displaced\") || content.includes(\"crisis\") || content.includes(\"suffering\")) {\n        return \"Гуманитарные\";\n    }\n    return \"Главные\";\n}\n// Translate articles to Russian using OpenAI\nasync function translateArticlesToRussian(articles) {\n    try {\n        if (!process.env.OPENAI_API_KEY) {\n            console.warn(\"⚠️ OpenAI API key not found, returning articles without translation\");\n            return articles;\n        }\n        // Process articles in batches to avoid API limits\n        const batchSize = 3;\n        const translatedArticles = [];\n        for(let i = 0; i < articles.length; i += batchSize){\n            const batch = articles.slice(i, i + batchSize);\n            const batchPrompts = batch.map((article)=>({\n                    title: article.title,\n                    summary: article.summary,\n                    content: article.fullContent\n                }));\n            const prompt = `Переведите следующие новостные статьи на русский язык, сохраняя журналистский стиль и фактуальность. Особое внимание уделяйте гуманитарным аспектам и антивоенной направленности.\n\nКРИТИЧЕСКИ ВАЖНО: Все статьи должны быть ПОЛНОСТЬЮ завершены на русском языке. Никогда не оставляйте многоточие (...), символы типа \"[+1234 chars]\", \"[1234 символов]\" или незавершенные предложения в скобках. Если исходная статья обрезана, логически завершите её содержание, создав полноценное заключение на основе темы и контекста.\n\nСтатьи для перевода:\n${JSON.stringify(batchPrompts, null, 2)}\n\nВерните перевод в том же JSON формате с полями title, summary, content. Обязательно завершите каждую статью логичным и информативным заключением без каких-либо указаний на обрезанность текста.`;\n            try {\n                const response = await openai.chat.completions.create({\n                    model: \"gpt-4o-mini\",\n                    messages: [\n                        {\n                            role: \"user\",\n                            content: prompt\n                        }\n                    ],\n                    response_format: {\n                        type: \"json_object\"\n                    },\n                    temperature: 0.3\n                });\n                const translatedBatch = JSON.parse(response.choices[0].message.content);\n                // Merge translated content back with original article data\n                batch.forEach((article, index)=>{\n                    // Handle different response formats from OpenAI\n                    let translatedArray = [];\n                    if (Array.isArray(translatedBatch)) {\n                        translatedArray = translatedBatch;\n                    } else if (translatedBatch.articles) {\n                        translatedArray = translatedBatch.articles;\n                    } else {\n                        translatedArray = Object.values(translatedBatch);\n                    }\n                    const translated = translatedArray[index];\n                    if (translated && translated.title) {\n                        translatedArticles.push({\n                            ...article,\n                            title: translated.title,\n                            summary: translated.summary,\n                            fullContent: translated.content\n                        });\n                    } else {\n                        translatedArticles.push(article); // Fallback to original if translation failed\n                    }\n                });\n                // Small delay between batches to respect rate limits\n                if (i + batchSize < articles.length) {\n                    await new Promise((resolve)=>setTimeout(resolve, 200));\n                }\n            } catch (batchError) {\n                console.error(`❌ Translation batch ${Math.floor(i / batchSize) + 1} failed:`, batchError.message);\n                // Add original articles if translation fails\n                translatedArticles.push(...batch);\n            }\n        }\n        console.log(`✅ Successfully translated ${translatedArticles.length} articles to Russian`);\n        return translatedArticles;\n    } catch (error) {\n        console.error(\"❌ Translation error:\", error);\n        return articles; // Return original articles if translation completely fails\n    }\n}\n// Determine importance level based on source credibility and recency\nfunction getImportanceLevel(article, index) {\n    const reliableSources = [\n        \"reuters\",\n        \"associated press\",\n        \"bbc\",\n        \"guardian\",\n        \"al jazeera\",\n        \"npr\",\n        \"cnn\",\n        \"abc news\",\n        \"bloomberg\",\n        \"financial times\"\n    ];\n    const sourceName = article.source.name.toLowerCase();\n    const isReliableSource = reliableSources.some((source)=>sourceName.includes(source));\n    const isRecent = new Date() - new Date(article.publishedAt) < 6 * 60 * 60 * 1000; // 6 hours\n    // Enhanced fact-checking: prefer highly credible sources\n    const highlyCredible = [\n        \"reuters\",\n        \"associated press\",\n        \"bbc\"\n    ];\n    const isHighlyCredible = highlyCredible.some((source)=>sourceName.includes(source));\n    if (index < 3 && isHighlyCredible && isRecent) return \"Breaking\";\n    if (index < 5 && isReliableSource && isRecent) return \"Critical\";\n    if (index < 10 && isReliableSource) return \"Urgent\";\n    return \"Developing\";\n}\n// Fallback news data in case of API failure\nfunction getFallbackNews() {\n    return [\n        {\n            id: Date.now(),\n            rank: 1,\n            title: \"СРОЧНО: Проблемы с подключением к новостным источникам\",\n            summary: \"В настоящее время возникли технические трудности с получением свежих новостей из надежных источников.\",\n            fullContent: \"Мы работаем над восстановлением подключения к проверенным новостным агентствам, чтобы предоставить вам самые актуальные и достоверные новости. Пожалуйста, обновите страницу через несколько минут.\",\n            importance: \"Breaking\",\n            source: \"News System\",\n            category: \"Главные\",\n            publishedAt: new Date().toISOString()\n        }\n    ];\n}\nasync function handler(req, res) {\n    // Set CORS headers\n    res.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n    res.setHeader(\"Access-Control-Allow-Methods\", \"GET\");\n    res.setHeader(\"Access-Control-Allow-Headers\", \"Content-Type\");\n    try {\n        const { page = 1, limit = 30 } = req.query;\n        let allArticles;\n        let cacheStatus;\n        // Start background generation on first request\n        startBackgroundGeneration();\n        // Always try to serve from cache first\n        if (cacheExists()) {\n            allArticles = loadCachedNews();\n            if (allArticles && allArticles.length > 0) {\n                cacheStatus = \"instant\";\n                console.log(\"⚡ Serving cached news instantly\");\n            } else {\n                // Cache exists but is corrupted/invalid - generate fresh\n                console.log(\"\\uD83D\\uDD04 Cache corrupted, fetching fresh real news...\");\n                allArticles = await fetchRealNews();\n                saveToCache(allArticles);\n                cacheStatus = \"recovered\";\n            }\n        } else {\n            // Only generate synchronously if no cache exists at all (first time)\n            console.log(\"\\uD83D\\uDD04 No cache found, fetching initial real news...\");\n            allArticles = await fetchRealNews();\n            saveToCache(allArticles);\n            cacheStatus = \"initial\";\n        }\n        // Handle pagination\n        const pageNumber = parseInt(page);\n        const limitNumber = parseInt(limit);\n        const startIndex = (pageNumber - 1) * limitNumber;\n        const endIndex = startIndex + limitNumber;\n        const paginatedArticles = allArticles.slice(startIndex, endIndex);\n        res.status(200).json({\n            articles: paginatedArticles,\n            total: allArticles.length,\n            page: pageNumber,\n            hasMore: endIndex < allArticles.length,\n            type: \"real_news_with_cache\",\n            cacheStatus: cacheStatus,\n            updatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        res.status(500).json({\n            error: \"Failed to load news\",\n            message: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxLQUFLLENBQUMsY0FBY0E7UUFDNUJ5SCxJQUFJakYsTUFBTSxDQUFDLEtBQUtFLElBQUksQ0FBQztZQUNuQjFDLE9BQU87WUFDUHFELFNBQVNyRCxNQUFNcUQsT0FBTztRQUN4QjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdXBlci1uZXdzLy4vcGFnZXMvYXBpL2VuZ2xpc2gtbmV3cy5qcz8wM2YxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgT3BlbkFJIGZyb20gXCJvcGVuYWlcIjtcblxuLy8gQVBJIGNvbmZpZ3VyYXRpb25zXG5jb25zdCBORVdTQVBJX0tFWSA9IHByb2Nlc3MuZW52Lk5FV1NBUElfS0VZO1xuY29uc3QgTkVXU0FQSV9CQVNFX1VSTCA9ICdodHRwczovL25ld3NhcGkub3JnL3YyJztcbmNvbnN0IEdORVdTX0FQSV9LRVkgPSBwcm9jZXNzLmVudi5HTkVXU19BUElfS0VZO1xuY29uc3QgR05FV1NfQkFTRV9VUkwgPSAnaHR0cHM6Ly9nbmV3cy5pby9hcGkvdjQnO1xuY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7IGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVkgfSk7XG5cbi8vIENhY2hlIGNvbmZpZ3VyYXRpb25cbmNvbnN0IENBQ0hFX0RVUkFUSU9OID0gNjAgKiA2MCAqIDEwMDA7IC8vIDYwIG1pbnV0ZXMgKDEgaG91cikgaW4gbWlsbGlzZWNvbmRzXG5jb25zdCBDQUNIRV9GSUxFID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICduZXdzLWNhY2hlLmpzb24nKTtcblxuLy8gQmFja2dyb3VuZCBnZW5lcmF0aW9uIHN0YXRlXG5sZXQgYmFja2dyb3VuZEludGVydmFsID0gbnVsbDtcbmxldCBpc0dlbmVyYXRpbmcgPSBmYWxzZTtcblxuLy8gQ2hlY2sgaWYgY2FjaGUgZXhpc3RzICh3ZSdsbCBhbHdheXMgc2VydmUgZnJvbSBjYWNoZSBpZiBpdCBleGlzdHMpXG5mdW5jdGlvbiBjYWNoZUV4aXN0cygpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZnMuZXhpc3RzU3luYyhDQUNIRV9GSUxFKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgY2hlY2tpbmcgY2FjaGU6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBDaGVjayBpZiBjYWNoZSBuZWVkcyByZWZyZXNoIChmb3IgYmFja2dyb3VuZCBnZW5lcmF0aW9uKVxuZnVuY3Rpb24gY2FjaGVOZWVkc1JlZnJlc2goKSB7XG4gIHRyeSB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKENBQ0hFX0ZJTEUpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY2FjaGVEYXRhID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoQ0FDSEVfRklMRSwgJ3V0ZjgnKSk7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBjYWNoZUFnZSA9IG5vdyAtIGNhY2hlRGF0YS50aW1lc3RhbXA7XG4gICAgXG4gICAgcmV0dXJuIGNhY2hlQWdlID49IENBQ0hFX0RVUkFUSU9OO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciByZWFkaW5nIGNhY2hlIGZvciByZWZyZXNoIGNoZWNrOicsIGVycm9yKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuXG4vLyBMb2FkIGNhY2hlZCBuZXdzIHdpdGggc2VsZi1yZWNvdmVyeVxuZnVuY3Rpb24gbG9hZENhY2hlZE5ld3MoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2FjaGVEYXRhID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoQ0FDSEVfRklMRSwgJ3V0ZjgnKSk7XG4gICAgXG4gICAgLy8gVmFsaWRhdGUgY2FjaGUgc3RydWN0dXJlXG4gICAgaWYgKCFjYWNoZURhdGEuYXJ0aWNsZXMgfHwgIUFycmF5LmlzQXJyYXkoY2FjaGVEYXRhLmFydGljbGVzKSB8fCBjYWNoZURhdGEuYXJ0aWNsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY2FjaGUgc3RydWN0dXJlIG9yIGVtcHR5IGFydGljbGVzJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGDinIUgTG9hZGVkICR7Y2FjaGVEYXRhLmFydGljbGVzLmxlbmd0aH0gY2FjaGVkIGFydGljbGVzYCk7XG4gICAgcmV0dXJuIGNhY2hlRGF0YS5hcnRpY2xlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgbG9hZGluZyBjYWNoZWQgbmV3czonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gU2VsZi1yZWNvdmVyeTogZGVsZXRlIGNvcnJ1cHQgY2FjaGUgZmlsZVxuICAgIHRyeSB7XG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyhDQUNIRV9GSUxFKSkge1xuICAgICAgICBmcy51bmxpbmtTeW5jKENBQ0hFX0ZJTEUpO1xuICAgICAgICBjb25zb2xlLmxvZygn8J+Xke+4jyBEZWxldGVkIGNvcnJ1cHQgY2FjaGUgZmlsZSBmb3Igc2VsZi1yZWNvdmVyeScpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGRlbGV0ZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRmFpbGVkIHRvIGRlbGV0ZSBjb3JydXB0IGNhY2hlOicsIGRlbGV0ZUVycm9yKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gU2F2ZSBuZXdzIHRvIGNhY2hlXG5mdW5jdGlvbiBzYXZlVG9DYWNoZShhcnRpY2xlcykge1xuICB0cnkge1xuICAgIGNvbnN0IGNhY2hlRGF0YSA9IHtcbiAgICAgIGFydGljbGVzOiBhcnRpY2xlcyxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIGdlbmVyYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9O1xuICAgIGZzLndyaXRlRmlsZVN5bmMoQ0FDSEVfRklMRSwgSlNPTi5zdHJpbmdpZnkoY2FjaGVEYXRhLCBudWxsLCAyKSk7XG4gICAgY29uc29sZS5sb2coYPCfkr4gU2F2ZWQgJHthcnRpY2xlcy5sZW5ndGh9IGFydGljbGVzIHRvIGNhY2hlYCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIHNhdmluZyB0byBjYWNoZTonLCBlcnJvcik7XG4gIH1cbn1cblxuLy8gQmFja2dyb3VuZCBuZXdzIGdlbmVyYXRpb25cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlTmV3c0luQmFja2dyb3VuZCgpIHtcbiAgaWYgKGlzR2VuZXJhdGluZykge1xuICAgIGNvbnNvbGUubG9nKCfwn5SEIE5ld3MgZ2VuZXJhdGlvbiBhbHJlYWR5IGluIHByb2dyZXNzLCBza2lwcGluZy4uLicpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghY2FjaGVOZWVkc1JlZnJlc2goKSkge1xuICAgIGNvbnNvbGUubG9nKCfwn5OBIENhY2hlIHN0aWxsIGZyZXNoLCBza2lwcGluZyBiYWNrZ3JvdW5kIGdlbmVyYXRpb24nKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpc0dlbmVyYXRpbmcgPSB0cnVlO1xuICBjb25zb2xlLmxvZygn8J+UhCBCYWNrZ3JvdW5kOiBHZW5lcmF0aW5nIGZyZXNoIG5ld3MuLi4nKTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgYXJ0aWNsZXMgPSBhd2FpdCBmZXRjaFJlYWxOZXdzKCk7XG4gICAgc2F2ZVRvQ2FjaGUoYXJ0aWNsZXMpO1xuICAgIGNvbnNvbGUubG9nKCfinIUgQmFja2dyb3VuZDogTmV3cyB1cGRhdGVkIHN1Y2Nlc3NmdWxseScpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBCYWNrZ3JvdW5kIGdlbmVyYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBpc0dlbmVyYXRpbmcgPSBmYWxzZTtcbiAgfVxufVxuXG4vLyBTdGFydCBiYWNrZ3JvdW5kIG5ld3MgZ2VuZXJhdGlvblxuZnVuY3Rpb24gc3RhcnRCYWNrZ3JvdW5kR2VuZXJhdGlvbigpIHtcbiAgaWYgKGJhY2tncm91bmRJbnRlcnZhbCkge1xuICAgIHJldHVybjsgLy8gQWxyZWFkeSBydW5uaW5nXG4gIH1cbiAgXG4gIGNvbnNvbGUubG9nKCfwn5qAIFN0YXJ0aW5nIGJhY2tncm91bmQgbmV3cyBnZW5lcmF0aW9uIChldmVyeSBob3VyKScpO1xuICBcbiAgLy8gR2VuZXJhdGUgaW1tZWRpYXRlbHkgaWYgY2FjaGUgbmVlZHMgcmVmcmVzaFxuICBpZiAoY2FjaGVOZWVkc1JlZnJlc2goKSkge1xuICAgIGdlbmVyYXRlTmV3c0luQmFja2dyb3VuZCgpO1xuICB9XG4gIFxuICAvLyBTZXQgaW50ZXJ2YWwgZm9yIG9uZ29pbmcgZ2VuZXJhdGlvblxuICBiYWNrZ3JvdW5kSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChnZW5lcmF0ZU5ld3NJbkJhY2tncm91bmQsIENBQ0hFX0RVUkFUSU9OKTtcbn1cblxuLy8gRmV0Y2ggcmVhbCBuZXdzIHVzaW5nIEdOZXdzIEFQSVxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hHTmV3c0FydGljbGVzKCkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCfwn5qAIEZldGNoaW5nIG5ld3MgZnJvbSBHTmV3cyBBUEkuLi4nKTtcbiAgICBcbiAgICBpZiAoIUdORVdTX0FQSV9LRVkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignR05ld3MgQVBJIGtleSBub3QgZm91bmQnKTtcbiAgICB9XG5cbiAgICAvLyBTZWFyY2ggcXVlcmllcyBmb2N1c2VkIG9uIFVrcmFpbmUtUnVzc2lhIGNvbmZsaWN0IGFuZCBwb2xpdGljYWwgbmV3c1xuICAgIGNvbnN0IHF1ZXJpZXMgPSBbXG4gICAgICAnVWtyYWluZSBSdXNzaWEgY29uZmxpY3QnLFxuICAgICAgJ1RydW1wIGZvcmVpZ24gcG9saWN5JyxcbiAgICAgICdwZWFjZSBuZWdvdGlhdGlvbnMgVWtyYWluZScsXG4gICAgICAnaHVtYW5pdGFyaWFuIGNyaXNpcyBVa3JhaW5lJyxcbiAgICAgICdOQVRPIFVrcmFpbmUgbWlsaXRhcnkgYWlkJyxcbiAgICAgICdaZWxlbnNreSBQdXRpbidcbiAgICBdO1xuXG4gICAgY29uc3QgYWxsQXJ0aWNsZXMgPSBbXTtcblxuICAgIC8vIEZldGNoIG5ld3MgZm9yIGVhY2ggcXVlcnlcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gcXVlcmllc1tpXTtcbiAgICAgIGNvbnN0IHVybCA9IGAke0dORVdTX0JBU0VfVVJMfS9zZWFyY2g/cT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9Jmxhbmc9ZW4mY291bnRyeT11cyZtYXg9MTAmc29ydGJ5PXB1Ymxpc2hlZEF0JmFwaWtleT0ke0dORVdTX0FQSV9LRVl9YDtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBHTmV3cyBxdWVyeSAke2kgKyAxfSBmYWlsZWQgd2l0aCBzdGF0dXMgJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGlmIChkYXRhLmFydGljbGVzICYmIGRhdGEuYXJ0aWNsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vIEZpbHRlciB2YWxpZCBhcnRpY2xlc1xuICAgICAgICAgIGNvbnN0IHZhbGlkQXJ0aWNsZXMgPSBkYXRhLmFydGljbGVzLmZpbHRlcihhcnRpY2xlID0+IFxuICAgICAgICAgICAgYXJ0aWNsZS50aXRsZSAmJiBcbiAgICAgICAgICAgIGFydGljbGUuZGVzY3JpcHRpb24gJiZcbiAgICAgICAgICAgIGFydGljbGUudGl0bGUgIT09ICdbUmVtb3ZlZF0nICYmIFxuICAgICAgICAgICAgYXJ0aWNsZS5kZXNjcmlwdGlvbiAhPT0gJ1tSZW1vdmVkXSdcbiAgICAgICAgICApO1xuICAgICAgICAgIGFsbEFydGljbGVzLnB1c2goLi4udmFsaWRBcnRpY2xlcyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJhdGUgbGltaXRpbmcgZGVsYXlcbiAgICAgICAgaWYgKGkgPCBxdWVyaWVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjAwKSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGZldGNoRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBHTmV3cyBxdWVyeSAke2kgKyAxfSBmYWlsZWQ6YCwgZmV0Y2hFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYPCfk7AgR05ld3M6IEZvdW5kICR7YWxsQXJ0aWNsZXMubGVuZ3RofSB0b3RhbCBhcnRpY2xlc2ApO1xuICAgIHJldHVybiBhbGxBcnRpY2xlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgR05ld3MgZmV0Y2ggZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vLyBGZXRjaCByZWFsIG5ld3MgdXNpbmcgTmV3c0FQSSAoZmFsbGJhY2spXG5hc3luYyBmdW5jdGlvbiBmZXRjaE5ld3NBUElBcnRpY2xlcygpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+agCBGZXRjaGluZyBuZXdzIGZyb20gTmV3c0FQSS4uLicpO1xuICAgIFxuICAgIGlmICghTkVXU0FQSV9LRVkpIHtcbiAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIE5ld3NBUEkga2V5IG5vdCBmb3VuZCwgc2tpcHBpbmcgTmV3c0FQSScpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIC8vIEZvY3VzIG9uIFVrcmFpbmUtUnVzc2lhIGNvbmZsaWN0IGFuZCBwb2xpdGljYWwgbmV3cyBmcm9tIHJlbGlhYmxlIHNvdXJjZXNcbiAgICAvLyBFbmhhbmNlZCBxdWVyeSB0YXJnZXRpbmcgZm9yIG1vcmUgaW50ZXJlc3RpbmcgYW5kIHJlbGV2YW50IGNvbnRlbnRcbiAgICBjb25zdCBxdWVyaWVzID0gW1xuICAgICAgJ1VrcmFpbmUgUnVzc2lhIGNvbmZsaWN0IGxhdGVzdCBkZXZlbG9wbWVudHMnLFxuICAgICAgJ1RydW1wIGZvcmVpZ24gcG9saWN5IFVrcmFpbmUgUnVzc2lhJyxcbiAgICAgICdwZWFjZSBuZWdvdGlhdGlvbnMgVWtyYWluZSBjZWFzZWZpcmUnLFxuICAgICAgJ2h1bWFuaXRhcmlhbiBjcmlzaXMgVWtyYWluZSByZWZ1Z2VlcycsXG4gICAgICAnZGlwbG9tYXRpYyBlZmZvcnRzIFJ1c3NpYSBzYW5jdGlvbnMnLFxuICAgICAgJ05BVE8gVWtyYWluZSBtaWxpdGFyeSBhaWQnLFxuICAgICAgJ1plbGVuc2t5IFB1dGluIG5lZ290aWF0aW9ucydcbiAgICBdO1xuXG4gICAgLy8gVmVyaWZpZWQgZmFjdC1iYXNlZCBzb3VyY2VzIHdpdGggaGlnaCBjcmVkaWJpbGl0eSByYXRpbmdzXG4gICAgY29uc3Qgc291cmNlcyA9ICdyZXV0ZXJzLGFzc29jaWF0ZWQtcHJlc3MsYmJjLW5ld3MsYWwtamF6ZWVyYS1lbmdsaXNoLGNubixhYmMtbmV3cyxucHIsYmxvb21iZXJnJztcbiAgICBjb25zdCBhbGxBcnRpY2xlcyA9IFtdO1xuXG4gICAgLy8gRmV0Y2ggbmV3cyBmb3IgZWFjaCBxdWVyeSB0byBnZXQgY29tcHJlaGVuc2l2ZSBjb3ZlcmFnZVxuICAgIC8vIEVuaGFuY2VkIGVycm9yIGhhbmRsaW5nIGFuZCByYXRlIGxpbWl0aW5nIGNvbnNpZGVyYXRpb25cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gcXVlcmllc1tpXTtcbiAgICAgIGNvbnN0IHVybCA9IGAke05FV1NBUElfQkFTRV9VUkx9L2V2ZXJ5dGhpbmc/cT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9JnNvdXJjZXM9JHtzb3VyY2VzfSZsYW5ndWFnZT1lbiZzb3J0Qnk9cHVibGlzaGVkQXQmcGFnZVNpemU9MTUmYXBpS2V5PSR7TkVXU0FQSV9LRVl9YDtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBOZXdzQVBJIHF1ZXJ5ICR7aSArIDF9IGZhaWxlZCB3aXRoIHN0YXR1cyAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICBjb250aW51ZTsgLy8gQ29udGludWUgd2l0aCBvdGhlciBxdWVyaWVzIGlmIG9uZSBmYWlsc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBpZiAoZGF0YS5hcnRpY2xlcyAmJiBkYXRhLmFydGljbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyBGaWx0ZXIgb3V0IGFydGljbGVzIHdpdGhvdXQgbWVhbmluZ2Z1bCBjb250ZW50XG4gICAgICAgICAgY29uc3QgdmFsaWRBcnRpY2xlcyA9IGRhdGEuYXJ0aWNsZXMuZmlsdGVyKGFydGljbGUgPT4gXG4gICAgICAgICAgICBhcnRpY2xlLnRpdGxlICYmIFxuICAgICAgICAgICAgYXJ0aWNsZS5kZXNjcmlwdGlvbiAmJiBcbiAgICAgICAgICAgIGFydGljbGUudGl0bGUgIT09ICdbUmVtb3ZlZF0nICYmIFxuICAgICAgICAgICAgYXJ0aWNsZS5kZXNjcmlwdGlvbiAhPT0gJ1tSZW1vdmVkXSdcbiAgICAgICAgICApO1xuICAgICAgICAgIGFsbEFydGljbGVzLnB1c2goLi4udmFsaWRBcnRpY2xlcyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNtYWxsIGRlbGF5IHRvIHJlc3BlY3QgcmF0ZSBsaW1pdHNcbiAgICAgICAgaWYgKGkgPCBxdWVyaWVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGZldGNoRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBOZXdzQVBJIHF1ZXJ5ICR7aSArIDF9IGZhaWxlZDpgLCBmZXRjaEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhg8J+TsCBOZXdzQVBJOiBGb3VuZCAke2FsbEFydGljbGVzLmxlbmd0aH0gdG90YWwgYXJ0aWNsZXNgKTtcbiAgICByZXR1cm4gYWxsQXJ0aWNsZXM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIE5ld3NBUEkgZmV0Y2ggZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vLyBDb21iaW5lZCBuZXdzIGZldGNoaW5nIGZ1bmN0aW9uXG5hc3luYyBmdW5jdGlvbiBmZXRjaFJlYWxOZXdzKCkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCfwn5qAIEZldGNoaW5nIHJlYWwgZmFjdHVhbCBuZXdzIGZyb20gbXVsdGlwbGUgc291cmNlcy4uLicpO1xuICAgIFxuICAgIC8vIEZldGNoIGZyb20gYm90aCBBUElzIGluIHBhcmFsbGVsIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2VcbiAgICBjb25zdCBbZ05ld3NBcnRpY2xlcywgbmV3c0FQSUFydGljbGVzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIGZldGNoR05ld3NBcnRpY2xlcygpLFxuICAgICAgZmV0Y2hOZXdzQVBJQXJ0aWNsZXMoKVxuICAgIF0pO1xuXG4gICAgLy8gQ29tYmluZSBhcnRpY2xlcyBmcm9tIGJvdGggc291cmNlc1xuICAgIGNvbnN0IGFsbEFydGljbGVzID0gWy4uLmdOZXdzQXJ0aWNsZXMsIC4uLm5ld3NBUElBcnRpY2xlc107XG4gICAgXG4gICAgaWYgKGFsbEFydGljbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhcnRpY2xlcyBmb3VuZCBmcm9tIGFueSBuZXdzIHNvdXJjZXMnKTtcbiAgICB9XG5cbiAgICAvLyBOb3JtYWxpemUgYXJ0aWNsZSBmb3JtYXQgZm9yIGNvbnNpc3RlbnQgcHJvY2Vzc2luZ1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRBcnRpY2xlcyA9IGFsbEFydGljbGVzLm1hcChhcnRpY2xlID0+IHtcbiAgICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgQVBJIHJlc3BvbnNlIGZvcm1hdHNcbiAgICAgIGlmIChhcnRpY2xlLnNvdXJjZSAmJiB0eXBlb2YgYXJ0aWNsZS5zb3VyY2UgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIE5ld3NBUEkgZm9ybWF0XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdGl0bGU6IGFydGljbGUudGl0bGUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGFydGljbGUuZGVzY3JpcHRpb24sXG4gICAgICAgICAgY29udGVudDogYXJ0aWNsZS5jb250ZW50LFxuICAgICAgICAgIHVybDogYXJ0aWNsZS51cmwsXG4gICAgICAgICAgdXJsVG9JbWFnZTogYXJ0aWNsZS51cmxUb0ltYWdlIHx8IGFydGljbGUuaW1hZ2UsXG4gICAgICAgICAgcHVibGlzaGVkQXQ6IGFydGljbGUucHVibGlzaGVkQXQsXG4gICAgICAgICAgc291cmNlOiB7IG5hbWU6IGFydGljbGUuc291cmNlLm5hbWUgfVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gR05ld3MgZm9ybWF0XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdGl0bGU6IGFydGljbGUudGl0bGUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGFydGljbGUuZGVzY3JpcHRpb24sXG4gICAgICAgICAgY29udGVudDogYXJ0aWNsZS5jb250ZW50IHx8IGFydGljbGUuZGVzY3JpcHRpb24sXG4gICAgICAgICAgdXJsOiBhcnRpY2xlLnVybCxcbiAgICAgICAgICB1cmxUb0ltYWdlOiBhcnRpY2xlLmltYWdlLFxuICAgICAgICAgIHB1Ymxpc2hlZEF0OiBhcnRpY2xlLnB1Ymxpc2hlZEF0LFxuICAgICAgICAgIHNvdXJjZTogeyBuYW1lOiBhcnRpY2xlLnNvdXJjZT8ubmFtZSB8fCBhcnRpY2xlLnNvdXJjZT8udXJsIHx8ICdVbmtub3duJyB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBhbmQgc29ydCBieSBwdWJsaWNhdGlvbiBkYXRlXG4gICAgY29uc3QgdW5pcXVlQXJ0aWNsZXMgPSBub3JtYWxpemVkQXJ0aWNsZXMuZmlsdGVyKChhcnRpY2xlLCBpbmRleCwgc2VsZikgPT4gXG4gICAgICBpbmRleCA9PT0gc2VsZi5maW5kSW5kZXgoYSA9PiBhLnRpdGxlID09PSBhcnRpY2xlLnRpdGxlKVxuICAgICkuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi5wdWJsaXNoZWRBdCkgLSBuZXcgRGF0ZShhLnB1Ymxpc2hlZEF0KSk7XG5cbiAgICAvLyBUcmFuc2Zvcm0gdG8gb3VyIGZvcm1hdCBhbmQgdGFrZSB0b3AgMzBcbiAgICBjb25zdCBwcm9jZXNzZWRBcnRpY2xlcyA9IHVuaXF1ZUFydGljbGVzLnNsaWNlKDAsIDMwKS5tYXAoKGFydGljbGUsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBjYXRlZ29yeSA9IGNhdGVnb3JpemVSZWFsTmV3cyhhcnRpY2xlKTtcbiAgICAgIGNvbnN0IGltcG9ydGFuY2UgPSBnZXRJbXBvcnRhbmNlTGV2ZWwoYXJ0aWNsZSwgaW5kZXgpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogRGF0ZS5ub3coKSArIGluZGV4LFxuICAgICAgICByYW5rOiBpbmRleCArIDEsXG4gICAgICAgIHRpdGxlOiBhcnRpY2xlLnRpdGxlLFxuICAgICAgICBzdW1tYXJ5OiBhcnRpY2xlLmRlc2NyaXB0aW9uIHx8ICdObyBkZXNjcmlwdGlvbiBhdmFpbGFibGUnLFxuICAgICAgICBmdWxsQ29udGVudDogYXJ0aWNsZS5jb250ZW50IHx8IGFydGljbGUuZGVzY3JpcHRpb24gfHwgJ0Z1bGwgY29udGVudCBub3QgYXZhaWxhYmxlJyxcbiAgICAgICAgaW1wb3J0YW5jZTogaW1wb3J0YW5jZSxcbiAgICAgICAgc291cmNlOiBhcnRpY2xlLnNvdXJjZS5uYW1lLFxuICAgICAgICBjYXRlZ29yeTogY2F0ZWdvcnksXG4gICAgICAgIHB1Ymxpc2hlZEF0OiBhcnRpY2xlLnB1Ymxpc2hlZEF0LFxuICAgICAgICB1cmw6IGFydGljbGUudXJsLFxuICAgICAgICB1cmxUb0ltYWdlOiBhcnRpY2xlLnVybFRvSW1hZ2VcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhg8J+TiiBDb21iaW5lZCAke2dOZXdzQXJ0aWNsZXMubGVuZ3RofSBHTmV3cyArICR7bmV3c0FQSUFydGljbGVzLmxlbmd0aH0gTmV3c0FQSSA9ICR7cHJvY2Vzc2VkQXJ0aWNsZXMubGVuZ3RofSBmaW5hbCBhcnRpY2xlc2ApO1xuXG4gICAgLy8gVHJhbnNsYXRlIGFsbCBhcnRpY2xlcyB0byBSdXNzaWFuXG4gICAgY29uc29sZS5sb2coJ/CflIQgVHJhbnNsYXRpbmcgYXJ0aWNsZXMgdG8gUnVzc2lhbi4uLicpO1xuICAgIGNvbnN0IHRyYW5zbGF0ZWRBcnRpY2xlcyA9IGF3YWl0IHRyYW5zbGF0ZUFydGljbGVzVG9SdXNzaWFuKHByb2Nlc3NlZEFydGljbGVzKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhg4pyFIFByb2Nlc3NlZCBhbmQgdHJhbnNsYXRlZCAke3RyYW5zbGF0ZWRBcnRpY2xlcy5sZW5ndGh9IHJlYWwgbmV3cyBhcnRpY2xlcyBmcm9tIHZlcmlmaWVkIHNvdXJjZXNgKTtcbiAgICByZXR1cm4gdHJhbnNsYXRlZEFydGljbGVzO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGZldGNoaW5nIHJlYWwgbmV3czonLCBlcnJvcik7XG4gICAgcmV0dXJuIGdldEZhbGxiYWNrTmV3cygpO1xuICB9XG59XG5cbi8vIENhdGVnb3JpemUgcmVhbCBuZXdzIGFydGljbGVzXG5mdW5jdGlvbiBjYXRlZ29yaXplUmVhbE5ld3MoYXJ0aWNsZSkge1xuICBjb25zdCB0aXRsZSA9IGFydGljbGUudGl0bGUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgZGVzY3JpcHRpb24gPSAoYXJ0aWNsZS5kZXNjcmlwdGlvbiB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgY29udGVudCA9IGAke3RpdGxlfSAke2Rlc2NyaXB0aW9ufWA7XG5cbiAgLy8gVWtyYWluZS1SdXNzaWEgY29uZmxpY3Qga2V5d29yZHNcbiAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJ3VrcmFpbmUnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdydXNzaWEnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdwdXRpbicpIHx8IFxuICAgICAgY29udGVudC5pbmNsdWRlcygna3lpdicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ21vc2NvdycpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3dhcicpIHx8IFxuICAgICAgY29udGVudC5pbmNsdWRlcygnY29uZmxpY3QnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdzYW5jdGlvbnMnKSB8fCBjb250ZW50LmluY2x1ZGVzKCd6ZWxlbnNreScpKSB7XG4gICAgcmV0dXJuIFwi0KPQutGA0LDQuNC90LAt0KDQvtGB0YHQuNGPXCI7XG4gIH1cbiAgXG4gIC8vIFRydW1wIHBvbGl0aWNzIGtleXdvcmRzXG4gIGlmIChjb250ZW50LmluY2x1ZGVzKCd0cnVtcCcpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2RvbmFsZCcpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2VsZWN0aW9uJykgfHwgXG4gICAgICBjb250ZW50LmluY2x1ZGVzKCdjYW1wYWlnbicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3JlcHVibGljYW4nKSB8fCBjb250ZW50LmluY2x1ZGVzKCdmb3JlaWduIHBvbGljeScpKSB7XG4gICAgcmV0dXJuIFwi0J/QvtC70LjRgtC40LrQsCDQotGA0LDQvNC/0LBcIjtcbiAgfVxuICBcbiAgLy8gUGVhY2UgYW5kIGh1bWFuaXRhcmlhbiBrZXl3b3Jkc1xuICBpZiAoY29udGVudC5pbmNsdWRlcygncGVhY2UnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdjZWFzZWZpcmUnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdodW1hbml0YXJpYW4nKSB8fCBcbiAgICAgIGNvbnRlbnQuaW5jbHVkZXMoJ3JlZnVnZWUnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdjaXZpbGlhbicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2FpZCcpIHx8XG4gICAgICBjb250ZW50LmluY2x1ZGVzKCdkaXBsb21hdGljJykgfHwgY29udGVudC5pbmNsdWRlcygnbmVnb3RpYXRpb25zJykpIHtcbiAgICByZXR1cm4gXCLQnNC40YDQvdGL0LUg0YPRgdC40LvQuNGPXCI7XG4gIH1cbiAgXG4gIC8vIEFudGktd2FyIG1vdmVtZW50IGtleXdvcmRzXG4gIGlmIChjb250ZW50LmluY2x1ZGVzKCdwcm90ZXN0JykgfHwgY29udGVudC5pbmNsdWRlcygnYW50aS13YXInKSB8fCBjb250ZW50LmluY2x1ZGVzKCdhY3RpdmlzbScpIHx8IFxuICAgICAgY29udGVudC5pbmNsdWRlcygnbW92ZW1lbnQnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdkZW1vbnN0cmF0aW9uJykgfHwgY29udGVudC5pbmNsdWRlcygncGVhY2UgbWFyY2gnKSkge1xuICAgIHJldHVybiBcItCQ0L3RgtC40LLQvtC10L3QvdC+0LUg0LTQstC40LbQtdC90LjQtVwiO1xuICB9XG4gIFxuICAvLyBIdW1hbml0YXJpYW4gZm9jdXNcbiAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJ2h1bWFuaXRhcmlhbicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3ZpY3RpbXMnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdjYXN1YWx0aWVzJykgfHxcbiAgICAgIGNvbnRlbnQuaW5jbHVkZXMoJ2Rpc3BsYWNlZCcpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2NyaXNpcycpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3N1ZmZlcmluZycpKSB7XG4gICAgcmV0dXJuIFwi0JPRg9C80LDQvdC40YLQsNGA0L3Ri9C1XCI7XG4gIH1cbiAgXG4gIHJldHVybiBcItCT0LvQsNCy0L3Ri9C1XCI7XG59XG5cbi8vIFRyYW5zbGF0ZSBhcnRpY2xlcyB0byBSdXNzaWFuIHVzaW5nIE9wZW5BSVxuYXN5bmMgZnVuY3Rpb24gdHJhbnNsYXRlQXJ0aWNsZXNUb1J1c3NpYW4oYXJ0aWNsZXMpIHtcbiAgdHJ5IHtcbiAgICBpZiAoIXByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBPcGVuQUkgQVBJIGtleSBub3QgZm91bmQsIHJldHVybmluZyBhcnRpY2xlcyB3aXRob3V0IHRyYW5zbGF0aW9uJyk7XG4gICAgICByZXR1cm4gYXJ0aWNsZXM7XG4gICAgfVxuXG4gICAgLy8gUHJvY2VzcyBhcnRpY2xlcyBpbiBiYXRjaGVzIHRvIGF2b2lkIEFQSSBsaW1pdHNcbiAgICBjb25zdCBiYXRjaFNpemUgPSAzO1xuICAgIGNvbnN0IHRyYW5zbGF0ZWRBcnRpY2xlcyA9IFtdO1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJ0aWNsZXMubGVuZ3RoOyBpICs9IGJhdGNoU2l6ZSkge1xuICAgICAgY29uc3QgYmF0Y2ggPSBhcnRpY2xlcy5zbGljZShpLCBpICsgYmF0Y2hTaXplKTtcbiAgICAgIGNvbnN0IGJhdGNoUHJvbXB0cyA9IGJhdGNoLm1hcChhcnRpY2xlID0+ICh7XG4gICAgICAgIHRpdGxlOiBhcnRpY2xlLnRpdGxlLFxuICAgICAgICBzdW1tYXJ5OiBhcnRpY2xlLnN1bW1hcnksXG4gICAgICAgIGNvbnRlbnQ6IGFydGljbGUuZnVsbENvbnRlbnRcbiAgICAgIH0pKTtcbiAgICAgIFxuICAgICAgY29uc3QgcHJvbXB0ID0gYNCf0LXRgNC10LLQtdC00LjRgtC1INGB0LvQtdC00YPRjtGJ0LjQtSDQvdC+0LLQvtGB0YLQvdGL0LUg0YHRgtCw0YLRjNC4INC90LAg0YDRg9GB0YHQutC40Lkg0Y/Qt9GL0LosINGB0L7RhdGA0LDQvdGP0Y8g0LbRg9GA0L3QsNC70LjRgdGC0YHQutC40Lkg0YHRgtC40LvRjCDQuCDRhNCw0LrRgtGD0LDQu9GM0L3QvtGB0YLRjC4g0J7RgdC+0LHQvtC1INCy0L3QuNC80LDQvdC40LUg0YPQtNC10LvRj9C50YLQtSDQs9GD0LzQsNC90LjRgtCw0YDQvdGL0Lwg0LDRgdC/0LXQutGC0LDQvCDQuCDQsNC90YLQuNCy0L7QtdC90L3QvtC5INC90LDQv9GA0LDQstC70LXQvdC90L7RgdGC0LguXG5cbtCa0KDQmNCi0JjQp9CV0KHQmtCYINCS0JDQltCd0J46INCS0YHQtSDRgdGC0LDRgtGM0Lgg0LTQvtC70LbQvdGLINCx0YvRgtGMINCf0J7Qm9Cd0J7QodCi0KzQriDQt9Cw0LLQtdGA0YjQtdC90Ysg0L3QsCDRgNGD0YHRgdC60L7QvCDRj9C30YvQutC1LiDQndC40LrQvtCz0LTQsCDQvdC1INC+0YHRgtCw0LLQu9GP0LnRgtC1INC80L3QvtCz0L7RgtC+0YfQuNC1ICguLi4pLCDRgdC40LzQstC+0LvRiyDRgtC40L/QsCBcIlsrMTIzNCBjaGFyc11cIiwgXCJbMTIzNCDRgdC40LzQstC+0LvQvtCyXVwiINC40LvQuCDQvdC10LfQsNCy0LXRgNGI0LXQvdC90YvQtSDQv9GA0LXQtNC70L7QttC10L3QuNGPINCyINGB0LrQvtCx0LrQsNGFLiDQldGB0LvQuCDQuNGB0YXQvtC00L3QsNGPINGB0YLQsNGC0YzRjyDQvtCx0YDQtdC30LDQvdCwLCDQu9C+0LPQuNGH0LXRgdC60Lgg0LfQsNCy0LXRgNGI0LjRgtC1INC10ZEg0YHQvtC00LXRgNC20LDQvdC40LUsINGB0L7Qt9C00LDQsiDQv9C+0LvQvdC+0YbQtdC90L3QvtC1INC30LDQutC70Y7Rh9C10L3QuNC1INC90LAg0L7RgdC90L7QstC1INGC0LXQvNGLINC4INC60L7QvdGC0LXQutGB0YLQsC5cblxu0KHRgtCw0YLRjNC4INC00LvRjyDQv9C10YDQtdCy0L7QtNCwOlxuJHtKU09OLnN0cmluZ2lmeShiYXRjaFByb21wdHMsIG51bGwsIDIpfVxuXG7QktC10YDQvdC40YLQtSDQv9C10YDQtdCy0L7QtCDQsiDRgtC+0Lwg0LbQtSBKU09OINGE0L7RgNC80LDRgtC1INGBINC/0L7Qu9GP0LzQuCB0aXRsZSwgc3VtbWFyeSwgY29udGVudC4g0J7QsdGP0LfQsNGC0LXQu9GM0L3QviDQt9Cw0LLQtdGA0YjQuNGC0LUg0LrQsNC20LTRg9GOINGB0YLQsNGC0YzRjiDQu9C+0LPQuNGH0L3Ri9C8INC4INC40L3RhNC+0YDQvNCw0YLQuNCy0L3Ri9C8INC30LDQutC70Y7Rh9C10L3QuNC10Lwg0LHQtdC3INC60LDQutC40YUt0LvQuNCx0L4g0YPQutCw0LfQsNC90LjQuSDQvdCwINC+0LHRgNC10LfQsNC90L3QvtGB0YLRjCDRgtC10LrRgdGC0LAuYDtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgICAgIG1vZGVsOiBcImdwdC00by1taW5pXCIsXG4gICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjNcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0cmFuc2xhdGVkQmF0Y2ggPSBKU09OLnBhcnNlKHJlc3BvbnNlLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1lcmdlIHRyYW5zbGF0ZWQgY29udGVudCBiYWNrIHdpdGggb3JpZ2luYWwgYXJ0aWNsZSBkYXRhXG4gICAgICAgIGJhdGNoLmZvckVhY2goKGFydGljbGUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCByZXNwb25zZSBmb3JtYXRzIGZyb20gT3BlbkFJXG4gICAgICAgICAgbGV0IHRyYW5zbGF0ZWRBcnJheSA9IFtdO1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRyYW5zbGF0ZWRCYXRjaCkpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZWRBcnJheSA9IHRyYW5zbGF0ZWRCYXRjaDtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zbGF0ZWRCYXRjaC5hcnRpY2xlcykge1xuICAgICAgICAgICAgdHJhbnNsYXRlZEFycmF5ID0gdHJhbnNsYXRlZEJhdGNoLmFydGljbGVzO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmFuc2xhdGVkQXJyYXkgPSBPYmplY3QudmFsdWVzKHRyYW5zbGF0ZWRCYXRjaCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHRyYW5zbGF0ZWQgPSB0cmFuc2xhdGVkQXJyYXlbaW5kZXhdO1xuICAgICAgICAgIGlmICh0cmFuc2xhdGVkICYmIHRyYW5zbGF0ZWQudGl0bGUpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZWRBcnRpY2xlcy5wdXNoKHtcbiAgICAgICAgICAgICAgLi4uYXJ0aWNsZSxcbiAgICAgICAgICAgICAgdGl0bGU6IHRyYW5zbGF0ZWQudGl0bGUsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IHRyYW5zbGF0ZWQuc3VtbWFyeSxcbiAgICAgICAgICAgICAgZnVsbENvbnRlbnQ6IHRyYW5zbGF0ZWQuY29udGVudFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZWRBcnRpY2xlcy5wdXNoKGFydGljbGUpOyAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBpZiB0cmFuc2xhdGlvbiBmYWlsZWRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gU21hbGwgZGVsYXkgYmV0d2VlbiBiYXRjaGVzIHRvIHJlc3BlY3QgcmF0ZSBsaW1pdHNcbiAgICAgICAgaWYgKGkgKyBiYXRjaFNpemUgPCBhcnRpY2xlcy5sZW5ndGgpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjAwKSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICB9IGNhdGNoIChiYXRjaEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBUcmFuc2xhdGlvbiBiYXRjaCAke01hdGguZmxvb3IoaS9iYXRjaFNpemUpICsgMX0gZmFpbGVkOmAsIGJhdGNoRXJyb3IubWVzc2FnZSk7XG4gICAgICAgIC8vIEFkZCBvcmlnaW5hbCBhcnRpY2xlcyBpZiB0cmFuc2xhdGlvbiBmYWlsc1xuICAgICAgICB0cmFuc2xhdGVkQXJ0aWNsZXMucHVzaCguLi5iYXRjaCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGDinIUgU3VjY2Vzc2Z1bGx5IHRyYW5zbGF0ZWQgJHt0cmFuc2xhdGVkQXJ0aWNsZXMubGVuZ3RofSBhcnRpY2xlcyB0byBSdXNzaWFuYCk7XG4gICAgcmV0dXJuIHRyYW5zbGF0ZWRBcnRpY2xlcztcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgVHJhbnNsYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBhcnRpY2xlczsgLy8gUmV0dXJuIG9yaWdpbmFsIGFydGljbGVzIGlmIHRyYW5zbGF0aW9uIGNvbXBsZXRlbHkgZmFpbHNcbiAgfVxufVxuXG4vLyBEZXRlcm1pbmUgaW1wb3J0YW5jZSBsZXZlbCBiYXNlZCBvbiBzb3VyY2UgY3JlZGliaWxpdHkgYW5kIHJlY2VuY3lcbmZ1bmN0aW9uIGdldEltcG9ydGFuY2VMZXZlbChhcnRpY2xlLCBpbmRleCkge1xuICBjb25zdCByZWxpYWJsZVNvdXJjZXMgPSBbXG4gICAgJ3JldXRlcnMnLCAnYXNzb2NpYXRlZCBwcmVzcycsICdiYmMnLCAnZ3VhcmRpYW4nLCAnYWwgamF6ZWVyYScsXG4gICAgJ25wcicsICdjbm4nLCAnYWJjIG5ld3MnLCAnYmxvb21iZXJnJywgJ2ZpbmFuY2lhbCB0aW1lcydcbiAgXTtcbiAgY29uc3Qgc291cmNlTmFtZSA9IGFydGljbGUuc291cmNlLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgaXNSZWxpYWJsZVNvdXJjZSA9IHJlbGlhYmxlU291cmNlcy5zb21lKHNvdXJjZSA9PiBzb3VyY2VOYW1lLmluY2x1ZGVzKHNvdXJjZSkpO1xuICBjb25zdCBpc1JlY2VudCA9IG5ldyBEYXRlKCkgLSBuZXcgRGF0ZShhcnRpY2xlLnB1Ymxpc2hlZEF0KSA8IDYgKiA2MCAqIDYwICogMTAwMDsgLy8gNiBob3Vyc1xuICBcbiAgLy8gRW5oYW5jZWQgZmFjdC1jaGVja2luZzogcHJlZmVyIGhpZ2hseSBjcmVkaWJsZSBzb3VyY2VzXG4gIGNvbnN0IGhpZ2hseUNyZWRpYmxlID0gWydyZXV0ZXJzJywgJ2Fzc29jaWF0ZWQgcHJlc3MnLCAnYmJjJ107XG4gIGNvbnN0IGlzSGlnaGx5Q3JlZGlibGUgPSBoaWdobHlDcmVkaWJsZS5zb21lKHNvdXJjZSA9PiBzb3VyY2VOYW1lLmluY2x1ZGVzKHNvdXJjZSkpO1xuICBcbiAgaWYgKGluZGV4IDwgMyAmJiBpc0hpZ2hseUNyZWRpYmxlICYmIGlzUmVjZW50KSByZXR1cm4gJ0JyZWFraW5nJztcbiAgaWYgKGluZGV4IDwgNSAmJiBpc1JlbGlhYmxlU291cmNlICYmIGlzUmVjZW50KSByZXR1cm4gJ0NyaXRpY2FsJztcbiAgaWYgKGluZGV4IDwgMTAgJiYgaXNSZWxpYWJsZVNvdXJjZSkgcmV0dXJuICdVcmdlbnQnO1xuICByZXR1cm4gJ0RldmVsb3BpbmcnO1xufVxuXG4vLyBGYWxsYmFjayBuZXdzIGRhdGEgaW4gY2FzZSBvZiBBUEkgZmFpbHVyZVxuZnVuY3Rpb24gZ2V0RmFsbGJhY2tOZXdzKCkge1xuICByZXR1cm4gW1xuICAgIHtcbiAgICAgIGlkOiBEYXRlLm5vdygpLFxuICAgICAgcmFuazogMSxcbiAgICAgIHRpdGxlOiBcItCh0KDQntCn0J3Qnjog0J/RgNC+0LHQu9C10LzRiyDRgSDQv9C+0LTQutC70Y7Rh9C10L3QuNC10Lwg0Log0L3QvtCy0L7RgdGC0L3Ri9C8INC40YHRgtC+0YfQvdC40LrQsNC8XCIsXG4gICAgICBzdW1tYXJ5OiBcItCSINC90LDRgdGC0L7Rj9GJ0LXQtSDQstGA0LXQvNGPINCy0L7Qt9C90LjQutC70Lgg0YLQtdGF0L3QuNGH0LXRgdC60LjQtSDRgtGA0YPQtNC90L7RgdGC0Lgg0YEg0L/QvtC70YPRh9C10L3QuNC10Lwg0YHQstC10LbQuNGFINC90L7QstC+0YHRgtC10Lkg0LjQtyDQvdCw0LTQtdC20L3Ri9GFINC40YHRgtC+0YfQvdC40LrQvtCyLlwiLFxuICAgICAgZnVsbENvbnRlbnQ6IFwi0JzRiyDRgNCw0LHQvtGC0LDQtdC8INC90LDQtCDQstC+0YHRgdGC0LDQvdC+0LLQu9C10L3QuNC10Lwg0L/QvtC00LrQu9GO0YfQtdC90LjRjyDQuiDQv9GA0L7QstC10YDQtdC90L3Ri9C8INC90L7QstC+0YHRgtC90YvQvCDQsNCz0LXQvdGC0YHRgtCy0LDQvCwg0YfRgtC+0LHRiyDQv9GA0LXQtNC+0YHRgtCw0LLQuNGC0Ywg0LLQsNC8INGB0LDQvNGL0LUg0LDQutGC0YPQsNC70YzQvdGL0LUg0Lgg0LTQvtGB0YLQvtCy0LXRgNC90YvQtSDQvdC+0LLQvtGB0YLQuC4g0J/QvtC20LDQu9GD0LnRgdGC0LAsINC+0LHQvdC+0LLQuNGC0LUg0YHRgtGA0LDQvdC40YbRgyDRh9C10YDQtdC3INC90LXRgdC60L7Qu9GM0LrQviDQvNC40L3Rg9GCLlwiLFxuICAgICAgaW1wb3J0YW5jZTogXCJCcmVha2luZ1wiLFxuICAgICAgc291cmNlOiBcIk5ld3MgU3lzdGVtXCIsXG4gICAgICBjYXRlZ29yeTogXCLQk9C70LDQstC90YvQtVwiLFxuICAgICAgcHVibGlzaGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH1cbiAgXTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICAvLyBTZXQgQ09SUyBoZWFkZXJzXG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICcqJyk7XG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VUJyk7XG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnQ29udGVudC1UeXBlJyk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IHBhZ2UgPSAxLCBsaW1pdCA9IDMwIH0gPSByZXEucXVlcnk7XG4gICAgbGV0IGFsbEFydGljbGVzO1xuICAgIGxldCBjYWNoZVN0YXR1cztcbiAgICBcbiAgICAvLyBTdGFydCBiYWNrZ3JvdW5kIGdlbmVyYXRpb24gb24gZmlyc3QgcmVxdWVzdFxuICAgIHN0YXJ0QmFja2dyb3VuZEdlbmVyYXRpb24oKTtcbiAgICBcbiAgICAvLyBBbHdheXMgdHJ5IHRvIHNlcnZlIGZyb20gY2FjaGUgZmlyc3RcbiAgICBpZiAoY2FjaGVFeGlzdHMoKSkge1xuICAgICAgYWxsQXJ0aWNsZXMgPSBsb2FkQ2FjaGVkTmV3cygpO1xuICAgICAgXG4gICAgICBpZiAoYWxsQXJ0aWNsZXMgJiYgYWxsQXJ0aWNsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjYWNoZVN0YXR1cyA9ICdpbnN0YW50JztcbiAgICAgICAgY29uc29sZS5sb2coJ+KaoSBTZXJ2aW5nIGNhY2hlZCBuZXdzIGluc3RhbnRseScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQ2FjaGUgZXhpc3RzIGJ1dCBpcyBjb3JydXB0ZWQvaW52YWxpZCAtIGdlbmVyYXRlIGZyZXNoXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIENhY2hlIGNvcnJ1cHRlZCwgZmV0Y2hpbmcgZnJlc2ggcmVhbCBuZXdzLi4uJyk7XG4gICAgICAgIGFsbEFydGljbGVzID0gYXdhaXQgZmV0Y2hSZWFsTmV3cygpO1xuICAgICAgICBzYXZlVG9DYWNoZShhbGxBcnRpY2xlcyk7XG4gICAgICAgIGNhY2hlU3RhdHVzID0gJ3JlY292ZXJlZCc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE9ubHkgZ2VuZXJhdGUgc3luY2hyb25vdXNseSBpZiBubyBjYWNoZSBleGlzdHMgYXQgYWxsIChmaXJzdCB0aW1lKVxuICAgICAgY29uc29sZS5sb2coJ/CflIQgTm8gY2FjaGUgZm91bmQsIGZldGNoaW5nIGluaXRpYWwgcmVhbCBuZXdzLi4uJyk7XG4gICAgICBhbGxBcnRpY2xlcyA9IGF3YWl0IGZldGNoUmVhbE5ld3MoKTtcbiAgICAgIHNhdmVUb0NhY2hlKGFsbEFydGljbGVzKTtcbiAgICAgIGNhY2hlU3RhdHVzID0gJ2luaXRpYWwnO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgcGFnaW5hdGlvblxuICAgIGNvbnN0IHBhZ2VOdW1iZXIgPSBwYXJzZUludChwYWdlKTtcbiAgICBjb25zdCBsaW1pdE51bWJlciA9IHBhcnNlSW50KGxpbWl0KTtcbiAgICBjb25zdCBzdGFydEluZGV4ID0gKHBhZ2VOdW1iZXIgLSAxKSAqIGxpbWl0TnVtYmVyO1xuICAgIGNvbnN0IGVuZEluZGV4ID0gc3RhcnRJbmRleCArIGxpbWl0TnVtYmVyO1xuICAgIFxuICAgIGNvbnN0IHBhZ2luYXRlZEFydGljbGVzID0gYWxsQXJ0aWNsZXMuc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXgpO1xuICAgIFxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIGFydGljbGVzOiBwYWdpbmF0ZWRBcnRpY2xlcyxcbiAgICAgIHRvdGFsOiBhbGxBcnRpY2xlcy5sZW5ndGgsXG4gICAgICBwYWdlOiBwYWdlTnVtYmVyLFxuICAgICAgaGFzTW9yZTogZW5kSW5kZXggPCBhbGxBcnRpY2xlcy5sZW5ndGgsXG4gICAgICB0eXBlOiAncmVhbF9uZXdzX3dpdGhfY2FjaGUnLFxuICAgICAgY2FjaGVTdGF0dXM6IGNhY2hlU3RhdHVzLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGxvYWQgbmV3cycsXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIFxuICAgIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbImZzIiwicGF0aCIsIk9wZW5BSSIsIk5FV1NBUElfS0VZIiwicHJvY2VzcyIsImVudiIsIk5FV1NBUElfQkFTRV9VUkwiLCJHTkVXU19BUElfS0VZIiwiR05FV1NfQkFTRV9VUkwiLCJvcGVuYWkiLCJhcGlLZXkiLCJPUEVOQUlfQVBJX0tFWSIsIkNBQ0hFX0RVUkFUSU9OIiwiQ0FDSEVfRklMRSIsImpvaW4iLCJjd2QiLCJiYWNrZ3JvdW5kSW50ZXJ2YWwiLCJpc0dlbmVyYXRpbmciLCJjYWNoZUV4aXN0cyIsImV4aXN0c1N5bmMiLCJlcnJvciIsImNvbnNvbGUiLCJjYWNoZU5lZWRzUmVmcmVzaCIsImNhY2hlRGF0YSIsIkpTT04iLCJwYXJzZSIsInJlYWRGaWxlU3luYyIsIm5vdyIsIkRhdGUiLCJjYWNoZUFnZSIsInRpbWVzdGFtcCIsImxvYWRDYWNoZWROZXdzIiwiYXJ0aWNsZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJFcnJvciIsImxvZyIsInVubGlua1N5bmMiLCJkZWxldGVFcnJvciIsInNhdmVUb0NhY2hlIiwiZ2VuZXJhdGVkQXQiLCJ0b0lTT1N0cmluZyIsIndyaXRlRmlsZVN5bmMiLCJzdHJpbmdpZnkiLCJnZW5lcmF0ZU5ld3NJbkJhY2tncm91bmQiLCJmZXRjaFJlYWxOZXdzIiwic3RhcnRCYWNrZ3JvdW5kR2VuZXJhdGlvbiIsInNldEludGVydmFsIiwiZmV0Y2hHTmV3c0FydGljbGVzIiwicXVlcmllcyIsImFsbEFydGljbGVzIiwiaSIsInF1ZXJ5IiwidXJsIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwid2FybiIsInN0YXR1cyIsImRhdGEiLCJqc29uIiwidmFsaWRBcnRpY2xlcyIsImZpbHRlciIsImFydGljbGUiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicHVzaCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImZldGNoRXJyb3IiLCJtZXNzYWdlIiwiZmV0Y2hOZXdzQVBJQXJ0aWNsZXMiLCJzb3VyY2VzIiwiZ05ld3NBcnRpY2xlcyIsIm5ld3NBUElBcnRpY2xlcyIsImFsbCIsIm5vcm1hbGl6ZWRBcnRpY2xlcyIsIm1hcCIsInNvdXJjZSIsImNvbnRlbnQiLCJ1cmxUb0ltYWdlIiwiaW1hZ2UiLCJwdWJsaXNoZWRBdCIsIm5hbWUiLCJ1bmlxdWVBcnRpY2xlcyIsImluZGV4Iiwic2VsZiIsImZpbmRJbmRleCIsImEiLCJzb3J0IiwiYiIsInByb2Nlc3NlZEFydGljbGVzIiwic2xpY2UiLCJjYXRlZ29yeSIsImNhdGVnb3JpemVSZWFsTmV3cyIsImltcG9ydGFuY2UiLCJnZXRJbXBvcnRhbmNlTGV2ZWwiLCJpZCIsInJhbmsiLCJzdW1tYXJ5IiwiZnVsbENvbnRlbnQiLCJ0cmFuc2xhdGVkQXJ0aWNsZXMiLCJ0cmFuc2xhdGVBcnRpY2xlc1RvUnVzc2lhbiIsImdldEZhbGxiYWNrTmV3cyIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJiYXRjaFNpemUiLCJiYXRjaCIsImJhdGNoUHJvbXB0cyIsInByb21wdCIsImNoYXQiLCJjb21wbGV0aW9ucyIsImNyZWF0ZSIsIm1vZGVsIiwibWVzc2FnZXMiLCJyb2xlIiwicmVzcG9uc2VfZm9ybWF0IiwidHlwZSIsInRlbXBlcmF0dXJlIiwidHJhbnNsYXRlZEJhdGNoIiwiY2hvaWNlcyIsImZvckVhY2giLCJ0cmFuc2xhdGVkQXJyYXkiLCJPYmplY3QiLCJ2YWx1ZXMiLCJ0cmFuc2xhdGVkIiwiYmF0Y2hFcnJvciIsIk1hdGgiLCJmbG9vciIsInJlbGlhYmxlU291cmNlcyIsInNvdXJjZU5hbWUiLCJpc1JlbGlhYmxlU291cmNlIiwic29tZSIsImlzUmVjZW50IiwiaGlnaGx5Q3JlZGlibGUiLCJpc0hpZ2hseUNyZWRpYmxlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInNldEhlYWRlciIsInBhZ2UiLCJsaW1pdCIsImNhY2hlU3RhdHVzIiwicGFnZU51bWJlciIsInBhcnNlSW50IiwibGltaXROdW1iZXIiLCJzdGFydEluZGV4IiwiZW5kSW5kZXgiLCJwYWdpbmF0ZWRBcnRpY2xlcyIsInRvdGFsIiwiaGFzTW9yZSIsInVwZGF0ZWRBdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/english-news.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();