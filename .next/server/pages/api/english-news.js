"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/english-news";
exports.ids = ["pages/api/english-news"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/english-news.js */ \"(api)/./pages/api/english-news.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/english-news\",\n        pathname: \"/api/english-news\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_english_news_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmVuZ2xpc2gtbmV3cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZW5nbGlzaC1uZXdzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3VwZXItbmV3cy8/ZGMwZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2VuZ2xpc2gtbmV3cy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2VuZ2xpc2gtbmV3c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2VuZ2xpc2gtbmV3c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/english-news.js":
/*!***********************************!*\
  !*** ./pages/api/english-news.js ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_2__]);\nopenai__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// API configurations\nconst NEWSAPI_KEY = process.env.NEWSAPI_KEY;\nconst NEWSAPI_BASE_URL = \"https://newsapi.org/v2\";\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// Cache configuration\nconst CACHE_DURATION = 60 * 60 * 1000; // 60 minutes (1 hour) in milliseconds\nconst CACHE_FILE = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"news-cache.json\");\n// Background generation state\nlet backgroundInterval = null;\nlet isGenerating = false;\n// Check if cache exists (we'll always serve from cache if it exists)\nfunction cacheExists() {\n    try {\n        return fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE);\n    } catch (error) {\n        console.error(\"❌ Error checking cache:\", error);\n        return false;\n    }\n}\n// Check if cache needs refresh (for background generation)\nfunction cacheNeedsRefresh() {\n    try {\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE)) {\n            return true;\n        }\n        const cacheData = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(CACHE_FILE, \"utf8\"));\n        const now = Date.now();\n        const cacheAge = now - cacheData.timestamp;\n        return cacheAge >= CACHE_DURATION;\n    } catch (error) {\n        console.error(\"❌ Error reading cache for refresh check:\", error);\n        return true;\n    }\n}\n// Load cached news with self-recovery\nfunction loadCachedNews() {\n    try {\n        const cacheData = JSON.parse(fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(CACHE_FILE, \"utf8\"));\n        // Validate cache structure\n        if (!cacheData.articles || !Array.isArray(cacheData.articles) || cacheData.articles.length === 0) {\n            throw new Error(\"Invalid cache structure or empty articles\");\n        }\n        console.log(`✅ Loaded ${cacheData.articles.length} cached articles`);\n        return cacheData.articles;\n    } catch (error) {\n        console.error(\"❌ Error loading cached news:\", error);\n        // Self-recovery: delete corrupt cache file\n        try {\n            if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(CACHE_FILE)) {\n                fs__WEBPACK_IMPORTED_MODULE_0___default().unlinkSync(CACHE_FILE);\n                console.log(\"\\uD83D\\uDDD1️ Deleted corrupt cache file for self-recovery\");\n            }\n        } catch (deleteError) {\n            console.error(\"❌ Failed to delete corrupt cache:\", deleteError);\n        }\n        return null;\n    }\n}\n// Save news to cache\nfunction saveToCache(articles) {\n    try {\n        const cacheData = {\n            articles: articles,\n            timestamp: Date.now(),\n            generatedAt: new Date().toISOString()\n        };\n        fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(CACHE_FILE, JSON.stringify(cacheData, null, 2));\n        console.log(`💾 Saved ${articles.length} articles to cache`);\n    } catch (error) {\n        console.error(\"❌ Error saving to cache:\", error);\n    }\n}\n// Background news generation\nasync function generateNewsInBackground() {\n    if (isGenerating) {\n        console.log(\"\\uD83D\\uDD04 News generation already in progress, skipping...\");\n        return;\n    }\n    if (!cacheNeedsRefresh()) {\n        console.log(\"\\uD83D\\uDCC1 Cache still fresh, skipping background generation\");\n        return;\n    }\n    isGenerating = true;\n    console.log(\"\\uD83D\\uDD04 Background: Generating fresh news...\");\n    try {\n        const articles = await fetchRealNews();\n        saveToCache(articles);\n        console.log(\"✅ Background: News updated successfully\");\n    } catch (error) {\n        console.error(\"❌ Background generation failed:\", error);\n    } finally{\n        isGenerating = false;\n    }\n}\n// Start background news generation\nfunction startBackgroundGeneration() {\n    if (backgroundInterval) {\n        return; // Already running\n    }\n    console.log(\"\\uD83D\\uDE80 Starting background news generation (every hour)\");\n    // Generate immediately if cache needs refresh\n    if (cacheNeedsRefresh()) {\n        generateNewsInBackground();\n    }\n    // Set interval for ongoing generation\n    backgroundInterval = setInterval(generateNewsInBackground, CACHE_DURATION);\n}\n// Fetch real news using NewsAPI\nasync function fetchRealNews() {\n    try {\n        console.log(\"\\uD83D\\uDE80 Fetching real factual news from verified sources...\");\n        if (!NEWSAPI_KEY) {\n            throw new Error(\"NewsAPI key not found\");\n        }\n        // Focus on Ukraine-Russia conflict and political news from reliable sources\n        // Enhanced query targeting for more interesting and relevant content\n        const queries = [\n            \"Ukraine Russia conflict latest developments\",\n            \"Trump foreign policy Ukraine Russia\",\n            \"peace negotiations Ukraine ceasefire\",\n            \"humanitarian crisis Ukraine refugees\",\n            \"diplomatic efforts Russia sanctions\",\n            \"NATO Ukraine military aid\",\n            \"Zelensky Putin negotiations\"\n        ];\n        // Verified fact-based sources with high credibility ratings\n        const sources = \"reuters,associated-press,bbc-news,al-jazeera-english,cnn,abc-news,npr,bloomberg\";\n        const allArticles = [];\n        // Fetch news for each query to get comprehensive coverage\n        // Enhanced error handling and rate limiting consideration\n        for(let i = 0; i < queries.length; i++){\n            const query = queries[i];\n            const url = `${NEWSAPI_BASE_URL}/everything?q=${encodeURIComponent(query)}&sources=${sources}&language=en&sortBy=publishedAt&pageSize=15&apiKey=${NEWSAPI_KEY}`;\n            try {\n                const response = await fetch(url);\n                if (!response.ok) {\n                    console.warn(`NewsAPI query ${i + 1} failed with status ${response.status}`);\n                    continue; // Continue with other queries if one fails\n                }\n                const data = await response.json();\n                if (data.articles && data.articles.length > 0) {\n                    // Filter out articles without meaningful content\n                    const validArticles = data.articles.filter((article)=>article.title && article.description && article.title !== \"[Removed]\" && article.description !== \"[Removed]\");\n                    allArticles.push(...validArticles);\n                }\n                // Small delay to respect rate limits\n                if (i < queries.length - 1) {\n                    await new Promise((resolve)=>setTimeout(resolve, 100));\n                }\n            } catch (fetchError) {\n                console.warn(`NewsAPI query ${i + 1} failed:`, fetchError.message);\n                continue;\n            }\n        }\n        if (allArticles.length === 0) {\n            throw new Error(\"No articles found from NewsAPI\");\n        }\n        // Remove duplicates and sort by publication date\n        const uniqueArticles = allArticles.filter((article, index, self)=>index === self.findIndex((a)=>a.title === article.title)).sort((a, b)=>new Date(b.publishedAt) - new Date(a.publishedAt));\n        // Transform to our format and take top 30\n        const processedArticles = uniqueArticles.slice(0, 30).map((article, index)=>{\n            const category = categorizeRealNews(article);\n            const importance = getImportanceLevel(article, index);\n            return {\n                id: Date.now() + index,\n                rank: index + 1,\n                title: article.title,\n                summary: article.description || \"No description available\",\n                fullContent: article.content || article.description || \"Full content not available\",\n                importance: importance,\n                source: article.source.name,\n                category: category,\n                publishedAt: article.publishedAt,\n                url: article.url,\n                urlToImage: article.urlToImage\n            };\n        });\n        // Translate all articles to Russian\n        console.log(\"\\uD83D\\uDD04 Translating articles to Russian...\");\n        const translatedArticles = await translateArticlesToRussian(processedArticles);\n        console.log(`✅ Processed and translated ${translatedArticles.length} real news articles from verified sources`);\n        return translatedArticles;\n    } catch (error) {\n        console.error(\"❌ Error fetching real news:\", error);\n        return getFallbackNews();\n    }\n}\n// Categorize real news articles\nfunction categorizeRealNews(article) {\n    const title = article.title.toLowerCase();\n    const description = (article.description || \"\").toLowerCase();\n    const content = `${title} ${description}`;\n    // Ukraine-Russia conflict keywords\n    if (content.includes(\"ukraine\") || content.includes(\"russia\") || content.includes(\"putin\") || content.includes(\"kyiv\") || content.includes(\"moscow\") || content.includes(\"war\") || content.includes(\"conflict\") || content.includes(\"sanctions\") || content.includes(\"zelensky\")) {\n        return \"Украина-Россия\";\n    }\n    // Trump politics keywords\n    if (content.includes(\"trump\") || content.includes(\"donald\") || content.includes(\"election\") || content.includes(\"campaign\") || content.includes(\"republican\") || content.includes(\"foreign policy\")) {\n        return \"Политика Трампа\";\n    }\n    // Peace and humanitarian keywords\n    if (content.includes(\"peace\") || content.includes(\"ceasefire\") || content.includes(\"humanitarian\") || content.includes(\"refugee\") || content.includes(\"civilian\") || content.includes(\"aid\") || content.includes(\"diplomatic\") || content.includes(\"negotiations\")) {\n        return \"Мирные усилия\";\n    }\n    // Anti-war movement keywords\n    if (content.includes(\"protest\") || content.includes(\"anti-war\") || content.includes(\"activism\") || content.includes(\"movement\") || content.includes(\"demonstration\") || content.includes(\"peace march\")) {\n        return \"Антивоенное движение\";\n    }\n    // Humanitarian focus\n    if (content.includes(\"humanitarian\") || content.includes(\"victims\") || content.includes(\"casualties\") || content.includes(\"displaced\") || content.includes(\"crisis\") || content.includes(\"suffering\")) {\n        return \"Гуманитарные\";\n    }\n    return \"Главные\";\n}\n// Translate articles to Russian using OpenAI\nasync function translateArticlesToRussian(articles) {\n    try {\n        if (!process.env.OPENAI_API_KEY) {\n            console.warn(\"⚠️ OpenAI API key not found, returning articles without translation\");\n            return articles;\n        }\n        // Process articles in batches to avoid API limits\n        const batchSize = 3;\n        const translatedArticles = [];\n        for(let i = 0; i < articles.length; i += batchSize){\n            const batch = articles.slice(i, i + batchSize);\n            const batchPrompts = batch.map((article)=>({\n                    title: article.title,\n                    summary: article.summary,\n                    content: article.fullContent\n                }));\n            const prompt = `Переведите следующие новостные статьи на русский язык, сохраняя журналистский стиль и фактуальность. Особое внимание уделяйте гуманитарным аспектам и антивоенной направленности.\n\nСтатьи для перевода:\n${JSON.stringify(batchPrompts, null, 2)}\n\nВерните перевод в том же JSON формате с полями title, summary, content. Сохраняйте профессиональный журналистский стиль.`;\n            try {\n                const response = await openai.chat.completions.create({\n                    model: \"gpt-4o-mini\",\n                    messages: [\n                        {\n                            role: \"user\",\n                            content: prompt\n                        }\n                    ],\n                    response_format: {\n                        type: \"json_object\"\n                    },\n                    temperature: 0.3\n                });\n                const translatedBatch = JSON.parse(response.choices[0].message.content);\n                // Merge translated content back with original article data\n                batch.forEach((article, index)=>{\n                    // Handle different response formats from OpenAI\n                    let translatedArray = [];\n                    if (Array.isArray(translatedBatch)) {\n                        translatedArray = translatedBatch;\n                    } else if (translatedBatch.articles) {\n                        translatedArray = translatedBatch.articles;\n                    } else {\n                        translatedArray = Object.values(translatedBatch);\n                    }\n                    const translated = translatedArray[index];\n                    if (translated && translated.title) {\n                        translatedArticles.push({\n                            ...article,\n                            title: translated.title,\n                            summary: translated.summary,\n                            fullContent: translated.content\n                        });\n                    } else {\n                        translatedArticles.push(article); // Fallback to original if translation failed\n                    }\n                });\n                // Small delay between batches to respect rate limits\n                if (i + batchSize < articles.length) {\n                    await new Promise((resolve)=>setTimeout(resolve, 200));\n                }\n            } catch (batchError) {\n                console.error(`❌ Translation batch ${Math.floor(i / batchSize) + 1} failed:`, batchError.message);\n                // Add original articles if translation fails\n                translatedArticles.push(...batch);\n            }\n        }\n        console.log(`✅ Successfully translated ${translatedArticles.length} articles to Russian`);\n        return translatedArticles;\n    } catch (error) {\n        console.error(\"❌ Translation error:\", error);\n        return articles; // Return original articles if translation completely fails\n    }\n}\n// Determine importance level based on source credibility and recency\nfunction getImportanceLevel(article, index) {\n    const reliableSources = [\n        \"reuters\",\n        \"associated press\",\n        \"bbc\",\n        \"guardian\",\n        \"al jazeera\",\n        \"npr\",\n        \"cnn\",\n        \"abc news\",\n        \"bloomberg\",\n        \"financial times\"\n    ];\n    const sourceName = article.source.name.toLowerCase();\n    const isReliableSource = reliableSources.some((source)=>sourceName.includes(source));\n    const isRecent = new Date() - new Date(article.publishedAt) < 6 * 60 * 60 * 1000; // 6 hours\n    // Enhanced fact-checking: prefer highly credible sources\n    const highlyCredible = [\n        \"reuters\",\n        \"associated press\",\n        \"bbc\"\n    ];\n    const isHighlyCredible = highlyCredible.some((source)=>sourceName.includes(source));\n    if (index < 3 && isHighlyCredible && isRecent) return \"Breaking\";\n    if (index < 5 && isReliableSource && isRecent) return \"Critical\";\n    if (index < 10 && isReliableSource) return \"Urgent\";\n    return \"Developing\";\n}\n// Fallback news data in case of API failure\nfunction getFallbackNews() {\n    return [\n        {\n            id: Date.now(),\n            rank: 1,\n            title: \"СРОЧНО: Проблемы с подключением к новостным источникам\",\n            summary: \"В настоящее время возникли технические трудности с получением свежих новостей из надежных источников.\",\n            fullContent: \"Мы работаем над восстановлением подключения к проверенным новостным агентствам, чтобы предоставить вам самые актуальные и достоверные новости. Пожалуйста, обновите страницу через несколько минут.\",\n            importance: \"Breaking\",\n            source: \"News System\",\n            category: \"Главные\",\n            publishedAt: new Date().toISOString()\n        }\n    ];\n}\nasync function handler(req, res) {\n    // Set CORS headers\n    res.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n    res.setHeader(\"Access-Control-Allow-Methods\", \"GET\");\n    res.setHeader(\"Access-Control-Allow-Headers\", \"Content-Type\");\n    try {\n        const { page = 1, limit = 30 } = req.query;\n        let allArticles;\n        let cacheStatus;\n        // Start background generation on first request\n        startBackgroundGeneration();\n        // Always try to serve from cache first\n        if (cacheExists()) {\n            allArticles = loadCachedNews();\n            if (allArticles && allArticles.length > 0) {\n                cacheStatus = \"instant\";\n                console.log(\"⚡ Serving cached news instantly\");\n            } else {\n                // Cache exists but is corrupted/invalid - generate fresh\n                console.log(\"\\uD83D\\uDD04 Cache corrupted, fetching fresh real news...\");\n                allArticles = await fetchRealNews();\n                saveToCache(allArticles);\n                cacheStatus = \"recovered\";\n            }\n        } else {\n            // Only generate synchronously if no cache exists at all (first time)\n            console.log(\"\\uD83D\\uDD04 No cache found, fetching initial real news...\");\n            allArticles = await fetchRealNews();\n            saveToCache(allArticles);\n            cacheStatus = \"initial\";\n        }\n        // Handle pagination\n        const pageNumber = parseInt(page);\n        const limitNumber = parseInt(limit);\n        const startIndex = (pageNumber - 1) * limitNumber;\n        const endIndex = startIndex + limitNumber;\n        const paginatedArticles = allArticles.slice(startIndex, endIndex);\n        res.status(200).json({\n            articles: paginatedArticles,\n            total: allArticles.length,\n            page: pageNumber,\n            hasMore: endIndex < allArticles.length,\n            type: \"real_news_with_cache\",\n            cacheStatus: cacheStatus,\n            updatedAt: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        res.status(500).json({\n            error: \"Failed to load news\",\n            message: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBU0gsV0FBVzVGLFlBQVloQixNQUFNO1lBQ3RDOEUsTUFBTTtZQUNOeUIsYUFBYUE7WUFDYlMsV0FBVyxJQUFJdkgsT0FBT2MsV0FBVztRQUNuQztJQUVGLEVBQUUsT0FBT3RCLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGNBQWNBO1FBQzVCa0gsSUFBSTFFLE1BQU0sQ0FBQyxLQUFLRSxJQUFJLENBQUM7WUFDbkIxQyxPQUFPO1lBQ1BxRCxTQUFTckQsTUFBTXFELE9BQU87UUFDeEI7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3VwZXItbmV3cy8uL3BhZ2VzL2FwaS9lbmdsaXNoLW5ld3MuanM/MDNmMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IE9wZW5BSSBmcm9tIFwib3BlbmFpXCI7XG5cbi8vIEFQSSBjb25maWd1cmF0aW9uc1xuY29uc3QgTkVXU0FQSV9LRVkgPSBwcm9jZXNzLmVudi5ORVdTQVBJX0tFWTtcbmNvbnN0IE5FV1NBUElfQkFTRV9VUkwgPSAnaHR0cHM6Ly9uZXdzYXBpLm9yZy92Mic7XG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHsgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB9KTtcblxuLy8gQ2FjaGUgY29uZmlndXJhdGlvblxuY29uc3QgQ0FDSEVfRFVSQVRJT04gPSA2MCAqIDYwICogMTAwMDsgLy8gNjAgbWludXRlcyAoMSBob3VyKSBpbiBtaWxsaXNlY29uZHNcbmNvbnN0IENBQ0hFX0ZJTEUgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ25ld3MtY2FjaGUuanNvbicpO1xuXG4vLyBCYWNrZ3JvdW5kIGdlbmVyYXRpb24gc3RhdGVcbmxldCBiYWNrZ3JvdW5kSW50ZXJ2YWwgPSBudWxsO1xubGV0IGlzR2VuZXJhdGluZyA9IGZhbHNlO1xuXG4vLyBDaGVjayBpZiBjYWNoZSBleGlzdHMgKHdlJ2xsIGFsd2F5cyBzZXJ2ZSBmcm9tIGNhY2hlIGlmIGl0IGV4aXN0cylcbmZ1bmN0aW9uIGNhY2hlRXhpc3RzKCkge1xuICB0cnkge1xuICAgIHJldHVybiBmcy5leGlzdHNTeW5jKENBQ0hFX0ZJTEUpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBjaGVja2luZyBjYWNoZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8vIENoZWNrIGlmIGNhY2hlIG5lZWRzIHJlZnJlc2ggKGZvciBiYWNrZ3JvdW5kIGdlbmVyYXRpb24pXG5mdW5jdGlvbiBjYWNoZU5lZWRzUmVmcmVzaCgpIHtcbiAgdHJ5IHtcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoQ0FDSEVfRklMRSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBjYWNoZURhdGEgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhDQUNIRV9GSUxFLCAndXRmOCcpKTtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGNhY2hlQWdlID0gbm93IC0gY2FjaGVEYXRhLnRpbWVzdGFtcDtcbiAgICBcbiAgICByZXR1cm4gY2FjaGVBZ2UgPj0gQ0FDSEVfRFVSQVRJT047XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIHJlYWRpbmcgY2FjaGUgZm9yIHJlZnJlc2ggY2hlY2s6JywgZXJyb3IpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cbi8vIExvYWQgY2FjaGVkIG5ld3Mgd2l0aCBzZWxmLXJlY292ZXJ5XG5mdW5jdGlvbiBsb2FkQ2FjaGVkTmV3cygpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjYWNoZURhdGEgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhDQUNIRV9GSUxFLCAndXRmOCcpKTtcbiAgICBcbiAgICAvLyBWYWxpZGF0ZSBjYWNoZSBzdHJ1Y3R1cmVcbiAgICBpZiAoIWNhY2hlRGF0YS5hcnRpY2xlcyB8fCAhQXJyYXkuaXNBcnJheShjYWNoZURhdGEuYXJ0aWNsZXMpIHx8IGNhY2hlRGF0YS5hcnRpY2xlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjYWNoZSBzdHJ1Y3R1cmUgb3IgZW1wdHkgYXJ0aWNsZXMnKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coYOKchSBMb2FkZWQgJHtjYWNoZURhdGEuYXJ0aWNsZXMubGVuZ3RofSBjYWNoZWQgYXJ0aWNsZXNgKTtcbiAgICByZXR1cm4gY2FjaGVEYXRhLmFydGljbGVzO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBsb2FkaW5nIGNhY2hlZCBuZXdzOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBTZWxmLXJlY292ZXJ5OiBkZWxldGUgY29ycnVwdCBjYWNoZSBmaWxlXG4gICAgdHJ5IHtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKENBQ0hFX0ZJTEUpKSB7XG4gICAgICAgIGZzLnVubGlua1N5bmMoQ0FDSEVfRklMRSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5eR77iPIERlbGV0ZWQgY29ycnVwdCBjYWNoZSBmaWxlIGZvciBzZWxmLXJlY292ZXJ5Jyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZGVsZXRlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gZGVsZXRlIGNvcnJ1cHQgY2FjaGU6JywgZGVsZXRlRXJyb3IpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vLyBTYXZlIG5ld3MgdG8gY2FjaGVcbmZ1bmN0aW9uIHNhdmVUb0NhY2hlKGFydGljbGVzKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2FjaGVEYXRhID0ge1xuICAgICAgYXJ0aWNsZXM6IGFydGljbGVzLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgZ2VuZXJhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gICAgZnMud3JpdGVGaWxlU3luYyhDQUNIRV9GSUxFLCBKU09OLnN0cmluZ2lmeShjYWNoZURhdGEsIG51bGwsIDIpKTtcbiAgICBjb25zb2xlLmxvZyhg8J+SviBTYXZlZCAke2FydGljbGVzLmxlbmd0aH0gYXJ0aWNsZXMgdG8gY2FjaGVgKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3Igc2F2aW5nIHRvIGNhY2hlOicsIGVycm9yKTtcbiAgfVxufVxuXG4vLyBCYWNrZ3JvdW5kIG5ld3MgZ2VuZXJhdGlvblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVOZXdzSW5CYWNrZ3JvdW5kKCkge1xuICBpZiAoaXNHZW5lcmF0aW5nKSB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgTmV3cyBnZW5lcmF0aW9uIGFscmVhZHkgaW4gcHJvZ3Jlc3MsIHNraXBwaW5nLi4uJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFjYWNoZU5lZWRzUmVmcmVzaCgpKSB7XG4gICAgY29uc29sZS5sb2coJ/Cfk4EgQ2FjaGUgc3RpbGwgZnJlc2gsIHNraXBwaW5nIGJhY2tncm91bmQgZ2VuZXJhdGlvbicpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlzR2VuZXJhdGluZyA9IHRydWU7XG4gIGNvbnNvbGUubG9nKCfwn5SEIEJhY2tncm91bmQ6IEdlbmVyYXRpbmcgZnJlc2ggbmV3cy4uLicpO1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBhcnRpY2xlcyA9IGF3YWl0IGZldGNoUmVhbE5ld3MoKTtcbiAgICBzYXZlVG9DYWNoZShhcnRpY2xlcyk7XG4gICAgY29uc29sZS5sb2coJ+KchSBCYWNrZ3JvdW5kOiBOZXdzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEJhY2tncm91bmQgZ2VuZXJhdGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xuICB9IGZpbmFsbHkge1xuICAgIGlzR2VuZXJhdGluZyA9IGZhbHNlO1xuICB9XG59XG5cbi8vIFN0YXJ0IGJhY2tncm91bmQgbmV3cyBnZW5lcmF0aW9uXG5mdW5jdGlvbiBzdGFydEJhY2tncm91bmRHZW5lcmF0aW9uKCkge1xuICBpZiAoYmFja2dyb3VuZEludGVydmFsKSB7XG4gICAgcmV0dXJuOyAvLyBBbHJlYWR5IHJ1bm5pbmdcbiAgfVxuICBcbiAgY29uc29sZS5sb2coJ/CfmoAgU3RhcnRpbmcgYmFja2dyb3VuZCBuZXdzIGdlbmVyYXRpb24gKGV2ZXJ5IGhvdXIpJyk7XG4gIFxuICAvLyBHZW5lcmF0ZSBpbW1lZGlhdGVseSBpZiBjYWNoZSBuZWVkcyByZWZyZXNoXG4gIGlmIChjYWNoZU5lZWRzUmVmcmVzaCgpKSB7XG4gICAgZ2VuZXJhdGVOZXdzSW5CYWNrZ3JvdW5kKCk7XG4gIH1cbiAgXG4gIC8vIFNldCBpbnRlcnZhbCBmb3Igb25nb2luZyBnZW5lcmF0aW9uXG4gIGJhY2tncm91bmRJbnRlcnZhbCA9IHNldEludGVydmFsKGdlbmVyYXRlTmV3c0luQmFja2dyb3VuZCwgQ0FDSEVfRFVSQVRJT04pO1xufVxuXG4vLyBGZXRjaCByZWFsIG5ld3MgdXNpbmcgTmV3c0FQSVxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hSZWFsTmV3cygpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+agCBGZXRjaGluZyByZWFsIGZhY3R1YWwgbmV3cyBmcm9tIHZlcmlmaWVkIHNvdXJjZXMuLi4nKTtcbiAgICBcbiAgICBpZiAoIU5FV1NBUElfS0VZKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05ld3NBUEkga2V5IG5vdCBmb3VuZCcpO1xuICAgIH1cblxuICAgIC8vIEZvY3VzIG9uIFVrcmFpbmUtUnVzc2lhIGNvbmZsaWN0IGFuZCBwb2xpdGljYWwgbmV3cyBmcm9tIHJlbGlhYmxlIHNvdXJjZXNcbiAgICAvLyBFbmhhbmNlZCBxdWVyeSB0YXJnZXRpbmcgZm9yIG1vcmUgaW50ZXJlc3RpbmcgYW5kIHJlbGV2YW50IGNvbnRlbnRcbiAgICBjb25zdCBxdWVyaWVzID0gW1xuICAgICAgJ1VrcmFpbmUgUnVzc2lhIGNvbmZsaWN0IGxhdGVzdCBkZXZlbG9wbWVudHMnLFxuICAgICAgJ1RydW1wIGZvcmVpZ24gcG9saWN5IFVrcmFpbmUgUnVzc2lhJyxcbiAgICAgICdwZWFjZSBuZWdvdGlhdGlvbnMgVWtyYWluZSBjZWFzZWZpcmUnLFxuICAgICAgJ2h1bWFuaXRhcmlhbiBjcmlzaXMgVWtyYWluZSByZWZ1Z2VlcycsXG4gICAgICAnZGlwbG9tYXRpYyBlZmZvcnRzIFJ1c3NpYSBzYW5jdGlvbnMnLFxuICAgICAgJ05BVE8gVWtyYWluZSBtaWxpdGFyeSBhaWQnLFxuICAgICAgJ1plbGVuc2t5IFB1dGluIG5lZ290aWF0aW9ucydcbiAgICBdO1xuXG4gICAgLy8gVmVyaWZpZWQgZmFjdC1iYXNlZCBzb3VyY2VzIHdpdGggaGlnaCBjcmVkaWJpbGl0eSByYXRpbmdzXG4gICAgY29uc3Qgc291cmNlcyA9ICdyZXV0ZXJzLGFzc29jaWF0ZWQtcHJlc3MsYmJjLW5ld3MsYWwtamF6ZWVyYS1lbmdsaXNoLGNubixhYmMtbmV3cyxucHIsYmxvb21iZXJnJztcbiAgICBjb25zdCBhbGxBcnRpY2xlcyA9IFtdO1xuXG4gICAgLy8gRmV0Y2ggbmV3cyBmb3IgZWFjaCBxdWVyeSB0byBnZXQgY29tcHJlaGVuc2l2ZSBjb3ZlcmFnZVxuICAgIC8vIEVuaGFuY2VkIGVycm9yIGhhbmRsaW5nIGFuZCByYXRlIGxpbWl0aW5nIGNvbnNpZGVyYXRpb25cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gcXVlcmllc1tpXTtcbiAgICAgIGNvbnN0IHVybCA9IGAke05FV1NBUElfQkFTRV9VUkx9L2V2ZXJ5dGhpbmc/cT0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9JnNvdXJjZXM9JHtzb3VyY2VzfSZsYW5ndWFnZT1lbiZzb3J0Qnk9cHVibGlzaGVkQXQmcGFnZVNpemU9MTUmYXBpS2V5PSR7TkVXU0FQSV9LRVl9YDtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBOZXdzQVBJIHF1ZXJ5ICR7aSArIDF9IGZhaWxlZCB3aXRoIHN0YXR1cyAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICBjb250aW51ZTsgLy8gQ29udGludWUgd2l0aCBvdGhlciBxdWVyaWVzIGlmIG9uZSBmYWlsc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBpZiAoZGF0YS5hcnRpY2xlcyAmJiBkYXRhLmFydGljbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyBGaWx0ZXIgb3V0IGFydGljbGVzIHdpdGhvdXQgbWVhbmluZ2Z1bCBjb250ZW50XG4gICAgICAgICAgY29uc3QgdmFsaWRBcnRpY2xlcyA9IGRhdGEuYXJ0aWNsZXMuZmlsdGVyKGFydGljbGUgPT4gXG4gICAgICAgICAgICBhcnRpY2xlLnRpdGxlICYmIFxuICAgICAgICAgICAgYXJ0aWNsZS5kZXNjcmlwdGlvbiAmJiBcbiAgICAgICAgICAgIGFydGljbGUudGl0bGUgIT09ICdbUmVtb3ZlZF0nICYmIFxuICAgICAgICAgICAgYXJ0aWNsZS5kZXNjcmlwdGlvbiAhPT0gJ1tSZW1vdmVkXSdcbiAgICAgICAgICApO1xuICAgICAgICAgIGFsbEFydGljbGVzLnB1c2goLi4udmFsaWRBcnRpY2xlcyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNtYWxsIGRlbGF5IHRvIHJlc3BlY3QgcmF0ZSBsaW1pdHNcbiAgICAgICAgaWYgKGkgPCBxdWVyaWVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGZldGNoRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBOZXdzQVBJIHF1ZXJ5ICR7aSArIDF9IGZhaWxlZDpgLCBmZXRjaEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoYWxsQXJ0aWNsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGFydGljbGVzIGZvdW5kIGZyb20gTmV3c0FQSScpO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGFuZCBzb3J0IGJ5IHB1YmxpY2F0aW9uIGRhdGVcbiAgICBjb25zdCB1bmlxdWVBcnRpY2xlcyA9IGFsbEFydGljbGVzLmZpbHRlcigoYXJ0aWNsZSwgaW5kZXgsIHNlbGYpID0+IFxuICAgICAgaW5kZXggPT09IHNlbGYuZmluZEluZGV4KGEgPT4gYS50aXRsZSA9PT0gYXJ0aWNsZS50aXRsZSlcbiAgICApLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIucHVibGlzaGVkQXQpIC0gbmV3IERhdGUoYS5wdWJsaXNoZWRBdCkpO1xuXG4gICAgLy8gVHJhbnNmb3JtIHRvIG91ciBmb3JtYXQgYW5kIHRha2UgdG9wIDMwXG4gICAgY29uc3QgcHJvY2Vzc2VkQXJ0aWNsZXMgPSB1bmlxdWVBcnRpY2xlcy5zbGljZSgwLCAzMCkubWFwKChhcnRpY2xlLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgY2F0ZWdvcnkgPSBjYXRlZ29yaXplUmVhbE5ld3MoYXJ0aWNsZSk7XG4gICAgICBjb25zdCBpbXBvcnRhbmNlID0gZ2V0SW1wb3J0YW5jZUxldmVsKGFydGljbGUsIGluZGV4KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IERhdGUubm93KCkgKyBpbmRleCxcbiAgICAgICAgcmFuazogaW5kZXggKyAxLFxuICAgICAgICB0aXRsZTogYXJ0aWNsZS50aXRsZSxcbiAgICAgICAgc3VtbWFyeTogYXJ0aWNsZS5kZXNjcmlwdGlvbiB8fCAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcbiAgICAgICAgZnVsbENvbnRlbnQ6IGFydGljbGUuY29udGVudCB8fCBhcnRpY2xlLmRlc2NyaXB0aW9uIHx8ICdGdWxsIGNvbnRlbnQgbm90IGF2YWlsYWJsZScsXG4gICAgICAgIGltcG9ydGFuY2U6IGltcG9ydGFuY2UsXG4gICAgICAgIHNvdXJjZTogYXJ0aWNsZS5zb3VyY2UubmFtZSxcbiAgICAgICAgY2F0ZWdvcnk6IGNhdGVnb3J5LFxuICAgICAgICBwdWJsaXNoZWRBdDogYXJ0aWNsZS5wdWJsaXNoZWRBdCxcbiAgICAgICAgdXJsOiBhcnRpY2xlLnVybCxcbiAgICAgICAgdXJsVG9JbWFnZTogYXJ0aWNsZS51cmxUb0ltYWdlXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLy8gVHJhbnNsYXRlIGFsbCBhcnRpY2xlcyB0byBSdXNzaWFuXG4gICAgY29uc29sZS5sb2coJ/CflIQgVHJhbnNsYXRpbmcgYXJ0aWNsZXMgdG8gUnVzc2lhbi4uLicpO1xuICAgIGNvbnN0IHRyYW5zbGF0ZWRBcnRpY2xlcyA9IGF3YWl0IHRyYW5zbGF0ZUFydGljbGVzVG9SdXNzaWFuKHByb2Nlc3NlZEFydGljbGVzKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhg4pyFIFByb2Nlc3NlZCBhbmQgdHJhbnNsYXRlZCAke3RyYW5zbGF0ZWRBcnRpY2xlcy5sZW5ndGh9IHJlYWwgbmV3cyBhcnRpY2xlcyBmcm9tIHZlcmlmaWVkIHNvdXJjZXNgKTtcbiAgICByZXR1cm4gdHJhbnNsYXRlZEFydGljbGVzO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGZldGNoaW5nIHJlYWwgbmV3czonLCBlcnJvcik7XG4gICAgcmV0dXJuIGdldEZhbGxiYWNrTmV3cygpO1xuICB9XG59XG5cbi8vIENhdGVnb3JpemUgcmVhbCBuZXdzIGFydGljbGVzXG5mdW5jdGlvbiBjYXRlZ29yaXplUmVhbE5ld3MoYXJ0aWNsZSkge1xuICBjb25zdCB0aXRsZSA9IGFydGljbGUudGl0bGUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgZGVzY3JpcHRpb24gPSAoYXJ0aWNsZS5kZXNjcmlwdGlvbiB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgY29udGVudCA9IGAke3RpdGxlfSAke2Rlc2NyaXB0aW9ufWA7XG5cbiAgLy8gVWtyYWluZS1SdXNzaWEgY29uZmxpY3Qga2V5d29yZHNcbiAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJ3VrcmFpbmUnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdydXNzaWEnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdwdXRpbicpIHx8IFxuICAgICAgY29udGVudC5pbmNsdWRlcygna3lpdicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ21vc2NvdycpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3dhcicpIHx8IFxuICAgICAgY29udGVudC5pbmNsdWRlcygnY29uZmxpY3QnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdzYW5jdGlvbnMnKSB8fCBjb250ZW50LmluY2x1ZGVzKCd6ZWxlbnNreScpKSB7XG4gICAgcmV0dXJuIFwi0KPQutGA0LDQuNC90LAt0KDQvtGB0YHQuNGPXCI7XG4gIH1cbiAgXG4gIC8vIFRydW1wIHBvbGl0aWNzIGtleXdvcmRzXG4gIGlmIChjb250ZW50LmluY2x1ZGVzKCd0cnVtcCcpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2RvbmFsZCcpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2VsZWN0aW9uJykgfHwgXG4gICAgICBjb250ZW50LmluY2x1ZGVzKCdjYW1wYWlnbicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3JlcHVibGljYW4nKSB8fCBjb250ZW50LmluY2x1ZGVzKCdmb3JlaWduIHBvbGljeScpKSB7XG4gICAgcmV0dXJuIFwi0J/QvtC70LjRgtC40LrQsCDQotGA0LDQvNC/0LBcIjtcbiAgfVxuICBcbiAgLy8gUGVhY2UgYW5kIGh1bWFuaXRhcmlhbiBrZXl3b3Jkc1xuICBpZiAoY29udGVudC5pbmNsdWRlcygncGVhY2UnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdjZWFzZWZpcmUnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdodW1hbml0YXJpYW4nKSB8fCBcbiAgICAgIGNvbnRlbnQuaW5jbHVkZXMoJ3JlZnVnZWUnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdjaXZpbGlhbicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2FpZCcpIHx8XG4gICAgICBjb250ZW50LmluY2x1ZGVzKCdkaXBsb21hdGljJykgfHwgY29udGVudC5pbmNsdWRlcygnbmVnb3RpYXRpb25zJykpIHtcbiAgICByZXR1cm4gXCLQnNC40YDQvdGL0LUg0YPRgdC40LvQuNGPXCI7XG4gIH1cbiAgXG4gIC8vIEFudGktd2FyIG1vdmVtZW50IGtleXdvcmRzXG4gIGlmIChjb250ZW50LmluY2x1ZGVzKCdwcm90ZXN0JykgfHwgY29udGVudC5pbmNsdWRlcygnYW50aS13YXInKSB8fCBjb250ZW50LmluY2x1ZGVzKCdhY3RpdmlzbScpIHx8IFxuICAgICAgY29udGVudC5pbmNsdWRlcygnbW92ZW1lbnQnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdkZW1vbnN0cmF0aW9uJykgfHwgY29udGVudC5pbmNsdWRlcygncGVhY2UgbWFyY2gnKSkge1xuICAgIHJldHVybiBcItCQ0L3RgtC40LLQvtC10L3QvdC+0LUg0LTQstC40LbQtdC90LjQtVwiO1xuICB9XG4gIFxuICAvLyBIdW1hbml0YXJpYW4gZm9jdXNcbiAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJ2h1bWFuaXRhcmlhbicpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3ZpY3RpbXMnKSB8fCBjb250ZW50LmluY2x1ZGVzKCdjYXN1YWx0aWVzJykgfHxcbiAgICAgIGNvbnRlbnQuaW5jbHVkZXMoJ2Rpc3BsYWNlZCcpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ2NyaXNpcycpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3N1ZmZlcmluZycpKSB7XG4gICAgcmV0dXJuIFwi0JPRg9C80LDQvdC40YLQsNGA0L3Ri9C1XCI7XG4gIH1cbiAgXG4gIHJldHVybiBcItCT0LvQsNCy0L3Ri9C1XCI7XG59XG5cbi8vIFRyYW5zbGF0ZSBhcnRpY2xlcyB0byBSdXNzaWFuIHVzaW5nIE9wZW5BSVxuYXN5bmMgZnVuY3Rpb24gdHJhbnNsYXRlQXJ0aWNsZXNUb1J1c3NpYW4oYXJ0aWNsZXMpIHtcbiAgdHJ5IHtcbiAgICBpZiAoIXByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBPcGVuQUkgQVBJIGtleSBub3QgZm91bmQsIHJldHVybmluZyBhcnRpY2xlcyB3aXRob3V0IHRyYW5zbGF0aW9uJyk7XG4gICAgICByZXR1cm4gYXJ0aWNsZXM7XG4gICAgfVxuXG4gICAgLy8gUHJvY2VzcyBhcnRpY2xlcyBpbiBiYXRjaGVzIHRvIGF2b2lkIEFQSSBsaW1pdHNcbiAgICBjb25zdCBiYXRjaFNpemUgPSAzO1xuICAgIGNvbnN0IHRyYW5zbGF0ZWRBcnRpY2xlcyA9IFtdO1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJ0aWNsZXMubGVuZ3RoOyBpICs9IGJhdGNoU2l6ZSkge1xuICAgICAgY29uc3QgYmF0Y2ggPSBhcnRpY2xlcy5zbGljZShpLCBpICsgYmF0Y2hTaXplKTtcbiAgICAgIGNvbnN0IGJhdGNoUHJvbXB0cyA9IGJhdGNoLm1hcChhcnRpY2xlID0+ICh7XG4gICAgICAgIHRpdGxlOiBhcnRpY2xlLnRpdGxlLFxuICAgICAgICBzdW1tYXJ5OiBhcnRpY2xlLnN1bW1hcnksXG4gICAgICAgIGNvbnRlbnQ6IGFydGljbGUuZnVsbENvbnRlbnRcbiAgICAgIH0pKTtcbiAgICAgIFxuICAgICAgY29uc3QgcHJvbXB0ID0gYNCf0LXRgNC10LLQtdC00LjRgtC1INGB0LvQtdC00YPRjtGJ0LjQtSDQvdC+0LLQvtGB0YLQvdGL0LUg0YHRgtCw0YLRjNC4INC90LAg0YDRg9GB0YHQutC40Lkg0Y/Qt9GL0LosINGB0L7RhdGA0LDQvdGP0Y8g0LbRg9GA0L3QsNC70LjRgdGC0YHQutC40Lkg0YHRgtC40LvRjCDQuCDRhNCw0LrRgtGD0LDQu9GM0L3QvtGB0YLRjC4g0J7RgdC+0LHQvtC1INCy0L3QuNC80LDQvdC40LUg0YPQtNC10LvRj9C50YLQtSDQs9GD0LzQsNC90LjRgtCw0YDQvdGL0Lwg0LDRgdC/0LXQutGC0LDQvCDQuCDQsNC90YLQuNCy0L7QtdC90L3QvtC5INC90LDQv9GA0LDQstC70LXQvdC90L7RgdGC0LguXG5cbtCh0YLQsNGC0YzQuCDQtNC70Y8g0L/QtdGA0LXQstC+0LTQsDpcbiR7SlNPTi5zdHJpbmdpZnkoYmF0Y2hQcm9tcHRzLCBudWxsLCAyKX1cblxu0JLQtdGA0L3QuNGC0LUg0L/QtdGA0LXQstC+0LQg0LIg0YLQvtC8INC20LUgSlNPTiDRhNC+0YDQvNCw0YLQtSDRgSDQv9C+0LvRj9C80LggdGl0bGUsIHN1bW1hcnksIGNvbnRlbnQuINCh0L7RhdGA0LDQvdGP0LnRgtC1INC/0YDQvtGE0LXRgdGB0LjQvtC90LDQu9GM0L3Ri9C5INC20YPRgNC90LDQu9C40YHRgtGB0LrQuNC5INGB0YLQuNC70YwuYDtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgICAgIG1vZGVsOiBcImdwdC00by1taW5pXCIsXG4gICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9LFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjNcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0cmFuc2xhdGVkQmF0Y2ggPSBKU09OLnBhcnNlKHJlc3BvbnNlLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1lcmdlIHRyYW5zbGF0ZWQgY29udGVudCBiYWNrIHdpdGggb3JpZ2luYWwgYXJ0aWNsZSBkYXRhXG4gICAgICAgIGJhdGNoLmZvckVhY2goKGFydGljbGUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgLy8gSGFuZGxlIGRpZmZlcmVudCByZXNwb25zZSBmb3JtYXRzIGZyb20gT3BlbkFJXG4gICAgICAgICAgbGV0IHRyYW5zbGF0ZWRBcnJheSA9IFtdO1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRyYW5zbGF0ZWRCYXRjaCkpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZWRBcnJheSA9IHRyYW5zbGF0ZWRCYXRjaDtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zbGF0ZWRCYXRjaC5hcnRpY2xlcykge1xuICAgICAgICAgICAgdHJhbnNsYXRlZEFycmF5ID0gdHJhbnNsYXRlZEJhdGNoLmFydGljbGVzO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cmFuc2xhdGVkQXJyYXkgPSBPYmplY3QudmFsdWVzKHRyYW5zbGF0ZWRCYXRjaCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHRyYW5zbGF0ZWQgPSB0cmFuc2xhdGVkQXJyYXlbaW5kZXhdO1xuICAgICAgICAgIGlmICh0cmFuc2xhdGVkICYmIHRyYW5zbGF0ZWQudGl0bGUpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZWRBcnRpY2xlcy5wdXNoKHtcbiAgICAgICAgICAgICAgLi4uYXJ0aWNsZSxcbiAgICAgICAgICAgICAgdGl0bGU6IHRyYW5zbGF0ZWQudGl0bGUsXG4gICAgICAgICAgICAgIHN1bW1hcnk6IHRyYW5zbGF0ZWQuc3VtbWFyeSxcbiAgICAgICAgICAgICAgZnVsbENvbnRlbnQ6IHRyYW5zbGF0ZWQuY29udGVudFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZWRBcnRpY2xlcy5wdXNoKGFydGljbGUpOyAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBpZiB0cmFuc2xhdGlvbiBmYWlsZWRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gU21hbGwgZGVsYXkgYmV0d2VlbiBiYXRjaGVzIHRvIHJlc3BlY3QgcmF0ZSBsaW1pdHNcbiAgICAgICAgaWYgKGkgKyBiYXRjaFNpemUgPCBhcnRpY2xlcy5sZW5ndGgpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjAwKSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICB9IGNhdGNoIChiYXRjaEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBUcmFuc2xhdGlvbiBiYXRjaCAke01hdGguZmxvb3IoaS9iYXRjaFNpemUpICsgMX0gZmFpbGVkOmAsIGJhdGNoRXJyb3IubWVzc2FnZSk7XG4gICAgICAgIC8vIEFkZCBvcmlnaW5hbCBhcnRpY2xlcyBpZiB0cmFuc2xhdGlvbiBmYWlsc1xuICAgICAgICB0cmFuc2xhdGVkQXJ0aWNsZXMucHVzaCguLi5iYXRjaCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGDinIUgU3VjY2Vzc2Z1bGx5IHRyYW5zbGF0ZWQgJHt0cmFuc2xhdGVkQXJ0aWNsZXMubGVuZ3RofSBhcnRpY2xlcyB0byBSdXNzaWFuYCk7XG4gICAgcmV0dXJuIHRyYW5zbGF0ZWRBcnRpY2xlcztcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgVHJhbnNsYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBhcnRpY2xlczsgLy8gUmV0dXJuIG9yaWdpbmFsIGFydGljbGVzIGlmIHRyYW5zbGF0aW9uIGNvbXBsZXRlbHkgZmFpbHNcbiAgfVxufVxuXG4vLyBEZXRlcm1pbmUgaW1wb3J0YW5jZSBsZXZlbCBiYXNlZCBvbiBzb3VyY2UgY3JlZGliaWxpdHkgYW5kIHJlY2VuY3lcbmZ1bmN0aW9uIGdldEltcG9ydGFuY2VMZXZlbChhcnRpY2xlLCBpbmRleCkge1xuICBjb25zdCByZWxpYWJsZVNvdXJjZXMgPSBbXG4gICAgJ3JldXRlcnMnLCAnYXNzb2NpYXRlZCBwcmVzcycsICdiYmMnLCAnZ3VhcmRpYW4nLCAnYWwgamF6ZWVyYScsXG4gICAgJ25wcicsICdjbm4nLCAnYWJjIG5ld3MnLCAnYmxvb21iZXJnJywgJ2ZpbmFuY2lhbCB0aW1lcydcbiAgXTtcbiAgY29uc3Qgc291cmNlTmFtZSA9IGFydGljbGUuc291cmNlLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgaXNSZWxpYWJsZVNvdXJjZSA9IHJlbGlhYmxlU291cmNlcy5zb21lKHNvdXJjZSA9PiBzb3VyY2VOYW1lLmluY2x1ZGVzKHNvdXJjZSkpO1xuICBjb25zdCBpc1JlY2VudCA9IG5ldyBEYXRlKCkgLSBuZXcgRGF0ZShhcnRpY2xlLnB1Ymxpc2hlZEF0KSA8IDYgKiA2MCAqIDYwICogMTAwMDsgLy8gNiBob3Vyc1xuICBcbiAgLy8gRW5oYW5jZWQgZmFjdC1jaGVja2luZzogcHJlZmVyIGhpZ2hseSBjcmVkaWJsZSBzb3VyY2VzXG4gIGNvbnN0IGhpZ2hseUNyZWRpYmxlID0gWydyZXV0ZXJzJywgJ2Fzc29jaWF0ZWQgcHJlc3MnLCAnYmJjJ107XG4gIGNvbnN0IGlzSGlnaGx5Q3JlZGlibGUgPSBoaWdobHlDcmVkaWJsZS5zb21lKHNvdXJjZSA9PiBzb3VyY2VOYW1lLmluY2x1ZGVzKHNvdXJjZSkpO1xuICBcbiAgaWYgKGluZGV4IDwgMyAmJiBpc0hpZ2hseUNyZWRpYmxlICYmIGlzUmVjZW50KSByZXR1cm4gJ0JyZWFraW5nJztcbiAgaWYgKGluZGV4IDwgNSAmJiBpc1JlbGlhYmxlU291cmNlICYmIGlzUmVjZW50KSByZXR1cm4gJ0NyaXRpY2FsJztcbiAgaWYgKGluZGV4IDwgMTAgJiYgaXNSZWxpYWJsZVNvdXJjZSkgcmV0dXJuICdVcmdlbnQnO1xuICByZXR1cm4gJ0RldmVsb3BpbmcnO1xufVxuXG4vLyBGYWxsYmFjayBuZXdzIGRhdGEgaW4gY2FzZSBvZiBBUEkgZmFpbHVyZVxuZnVuY3Rpb24gZ2V0RmFsbGJhY2tOZXdzKCkge1xuICByZXR1cm4gW1xuICAgIHtcbiAgICAgIGlkOiBEYXRlLm5vdygpLFxuICAgICAgcmFuazogMSxcbiAgICAgIHRpdGxlOiBcItCh0KDQntCn0J3Qnjog0J/RgNC+0LHQu9C10LzRiyDRgSDQv9C+0LTQutC70Y7Rh9C10L3QuNC10Lwg0Log0L3QvtCy0L7RgdGC0L3Ri9C8INC40YHRgtC+0YfQvdC40LrQsNC8XCIsXG4gICAgICBzdW1tYXJ5OiBcItCSINC90LDRgdGC0L7Rj9GJ0LXQtSDQstGA0LXQvNGPINCy0L7Qt9C90LjQutC70Lgg0YLQtdGF0L3QuNGH0LXRgdC60LjQtSDRgtGA0YPQtNC90L7RgdGC0Lgg0YEg0L/QvtC70YPRh9C10L3QuNC10Lwg0YHQstC10LbQuNGFINC90L7QstC+0YHRgtC10Lkg0LjQtyDQvdCw0LTQtdC20L3Ri9GFINC40YHRgtC+0YfQvdC40LrQvtCyLlwiLFxuICAgICAgZnVsbENvbnRlbnQ6IFwi0JzRiyDRgNCw0LHQvtGC0LDQtdC8INC90LDQtCDQstC+0YHRgdGC0LDQvdC+0LLQu9C10L3QuNC10Lwg0L/QvtC00LrQu9GO0YfQtdC90LjRjyDQuiDQv9GA0L7QstC10YDQtdC90L3Ri9C8INC90L7QstC+0YHRgtC90YvQvCDQsNCz0LXQvdGC0YHRgtCy0LDQvCwg0YfRgtC+0LHRiyDQv9GA0LXQtNC+0YHRgtCw0LLQuNGC0Ywg0LLQsNC8INGB0LDQvNGL0LUg0LDQutGC0YPQsNC70YzQvdGL0LUg0Lgg0LTQvtGB0YLQvtCy0LXRgNC90YvQtSDQvdC+0LLQvtGB0YLQuC4g0J/QvtC20LDQu9GD0LnRgdGC0LAsINC+0LHQvdC+0LLQuNGC0LUg0YHRgtGA0LDQvdC40YbRgyDRh9C10YDQtdC3INC90LXRgdC60L7Qu9GM0LrQviDQvNC40L3Rg9GCLlwiLFxuICAgICAgaW1wb3J0YW5jZTogXCJCcmVha2luZ1wiLFxuICAgICAgc291cmNlOiBcIk5ld3MgU3lzdGVtXCIsXG4gICAgICBjYXRlZ29yeTogXCLQk9C70LDQstC90YvQtVwiLFxuICAgICAgcHVibGlzaGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH1cbiAgXTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICAvLyBTZXQgQ09SUyBoZWFkZXJzXG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICcqJyk7XG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VUJyk7XG4gIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnQ29udGVudC1UeXBlJyk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IHBhZ2UgPSAxLCBsaW1pdCA9IDMwIH0gPSByZXEucXVlcnk7XG4gICAgbGV0IGFsbEFydGljbGVzO1xuICAgIGxldCBjYWNoZVN0YXR1cztcbiAgICBcbiAgICAvLyBTdGFydCBiYWNrZ3JvdW5kIGdlbmVyYXRpb24gb24gZmlyc3QgcmVxdWVzdFxuICAgIHN0YXJ0QmFja2dyb3VuZEdlbmVyYXRpb24oKTtcbiAgICBcbiAgICAvLyBBbHdheXMgdHJ5IHRvIHNlcnZlIGZyb20gY2FjaGUgZmlyc3RcbiAgICBpZiAoY2FjaGVFeGlzdHMoKSkge1xuICAgICAgYWxsQXJ0aWNsZXMgPSBsb2FkQ2FjaGVkTmV3cygpO1xuICAgICAgXG4gICAgICBpZiAoYWxsQXJ0aWNsZXMgJiYgYWxsQXJ0aWNsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjYWNoZVN0YXR1cyA9ICdpbnN0YW50JztcbiAgICAgICAgY29uc29sZS5sb2coJ+KaoSBTZXJ2aW5nIGNhY2hlZCBuZXdzIGluc3RhbnRseScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQ2FjaGUgZXhpc3RzIGJ1dCBpcyBjb3JydXB0ZWQvaW52YWxpZCAtIGdlbmVyYXRlIGZyZXNoXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIENhY2hlIGNvcnJ1cHRlZCwgZmV0Y2hpbmcgZnJlc2ggcmVhbCBuZXdzLi4uJyk7XG4gICAgICAgIGFsbEFydGljbGVzID0gYXdhaXQgZmV0Y2hSZWFsTmV3cygpO1xuICAgICAgICBzYXZlVG9DYWNoZShhbGxBcnRpY2xlcyk7XG4gICAgICAgIGNhY2hlU3RhdHVzID0gJ3JlY292ZXJlZCc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE9ubHkgZ2VuZXJhdGUgc3luY2hyb25vdXNseSBpZiBubyBjYWNoZSBleGlzdHMgYXQgYWxsIChmaXJzdCB0aW1lKVxuICAgICAgY29uc29sZS5sb2coJ/CflIQgTm8gY2FjaGUgZm91bmQsIGZldGNoaW5nIGluaXRpYWwgcmVhbCBuZXdzLi4uJyk7XG4gICAgICBhbGxBcnRpY2xlcyA9IGF3YWl0IGZldGNoUmVhbE5ld3MoKTtcbiAgICAgIHNhdmVUb0NhY2hlKGFsbEFydGljbGVzKTtcbiAgICAgIGNhY2hlU3RhdHVzID0gJ2luaXRpYWwnO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgcGFnaW5hdGlvblxuICAgIGNvbnN0IHBhZ2VOdW1iZXIgPSBwYXJzZUludChwYWdlKTtcbiAgICBjb25zdCBsaW1pdE51bWJlciA9IHBhcnNlSW50KGxpbWl0KTtcbiAgICBjb25zdCBzdGFydEluZGV4ID0gKHBhZ2VOdW1iZXIgLSAxKSAqIGxpbWl0TnVtYmVyO1xuICAgIGNvbnN0IGVuZEluZGV4ID0gc3RhcnRJbmRleCArIGxpbWl0TnVtYmVyO1xuICAgIFxuICAgIGNvbnN0IHBhZ2luYXRlZEFydGljbGVzID0gYWxsQXJ0aWNsZXMuc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXgpO1xuICAgIFxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIGFydGljbGVzOiBwYWdpbmF0ZWRBcnRpY2xlcyxcbiAgICAgIHRvdGFsOiBhbGxBcnRpY2xlcy5sZW5ndGgsXG4gICAgICBwYWdlOiBwYWdlTnVtYmVyLFxuICAgICAgaGFzTW9yZTogZW5kSW5kZXggPCBhbGxBcnRpY2xlcy5sZW5ndGgsXG4gICAgICB0eXBlOiAncmVhbF9uZXdzX3dpdGhfY2FjaGUnLFxuICAgICAgY2FjaGVTdGF0dXM6IGNhY2hlU3RhdHVzLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGxvYWQgbmV3cycsXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIFxuICAgIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbImZzIiwicGF0aCIsIk9wZW5BSSIsIk5FV1NBUElfS0VZIiwicHJvY2VzcyIsImVudiIsIk5FV1NBUElfQkFTRV9VUkwiLCJvcGVuYWkiLCJhcGlLZXkiLCJPUEVOQUlfQVBJX0tFWSIsIkNBQ0hFX0RVUkFUSU9OIiwiQ0FDSEVfRklMRSIsImpvaW4iLCJjd2QiLCJiYWNrZ3JvdW5kSW50ZXJ2YWwiLCJpc0dlbmVyYXRpbmciLCJjYWNoZUV4aXN0cyIsImV4aXN0c1N5bmMiLCJlcnJvciIsImNvbnNvbGUiLCJjYWNoZU5lZWRzUmVmcmVzaCIsImNhY2hlRGF0YSIsIkpTT04iLCJwYXJzZSIsInJlYWRGaWxlU3luYyIsIm5vdyIsIkRhdGUiLCJjYWNoZUFnZSIsInRpbWVzdGFtcCIsImxvYWRDYWNoZWROZXdzIiwiYXJ0aWNsZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJFcnJvciIsImxvZyIsInVubGlua1N5bmMiLCJkZWxldGVFcnJvciIsInNhdmVUb0NhY2hlIiwiZ2VuZXJhdGVkQXQiLCJ0b0lTT1N0cmluZyIsIndyaXRlRmlsZVN5bmMiLCJzdHJpbmdpZnkiLCJnZW5lcmF0ZU5ld3NJbkJhY2tncm91bmQiLCJmZXRjaFJlYWxOZXdzIiwic3RhcnRCYWNrZ3JvdW5kR2VuZXJhdGlvbiIsInNldEludGVydmFsIiwicXVlcmllcyIsInNvdXJjZXMiLCJhbGxBcnRpY2xlcyIsImkiLCJxdWVyeSIsInVybCIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsIndhcm4iLCJzdGF0dXMiLCJkYXRhIiwianNvbiIsInZhbGlkQXJ0aWNsZXMiLCJmaWx0ZXIiLCJhcnRpY2xlIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInB1c2giLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJmZXRjaEVycm9yIiwibWVzc2FnZSIsInVuaXF1ZUFydGljbGVzIiwiaW5kZXgiLCJzZWxmIiwiZmluZEluZGV4IiwiYSIsInNvcnQiLCJiIiwicHVibGlzaGVkQXQiLCJwcm9jZXNzZWRBcnRpY2xlcyIsInNsaWNlIiwibWFwIiwiY2F0ZWdvcnkiLCJjYXRlZ29yaXplUmVhbE5ld3MiLCJpbXBvcnRhbmNlIiwiZ2V0SW1wb3J0YW5jZUxldmVsIiwiaWQiLCJyYW5rIiwic3VtbWFyeSIsImZ1bGxDb250ZW50IiwiY29udGVudCIsInNvdXJjZSIsIm5hbWUiLCJ1cmxUb0ltYWdlIiwidHJhbnNsYXRlZEFydGljbGVzIiwidHJhbnNsYXRlQXJ0aWNsZXNUb1J1c3NpYW4iLCJnZXRGYWxsYmFja05ld3MiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiYmF0Y2hTaXplIiwiYmF0Y2giLCJiYXRjaFByb21wdHMiLCJwcm9tcHQiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsInJlc3BvbnNlX2Zvcm1hdCIsInR5cGUiLCJ0ZW1wZXJhdHVyZSIsInRyYW5zbGF0ZWRCYXRjaCIsImNob2ljZXMiLCJmb3JFYWNoIiwidHJhbnNsYXRlZEFycmF5IiwiT2JqZWN0IiwidmFsdWVzIiwidHJhbnNsYXRlZCIsImJhdGNoRXJyb3IiLCJNYXRoIiwiZmxvb3IiLCJyZWxpYWJsZVNvdXJjZXMiLCJzb3VyY2VOYW1lIiwiaXNSZWxpYWJsZVNvdXJjZSIsInNvbWUiLCJpc1JlY2VudCIsImhpZ2hseUNyZWRpYmxlIiwiaXNIaWdobHlDcmVkaWJsZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzZXRIZWFkZXIiLCJwYWdlIiwibGltaXQiLCJjYWNoZVN0YXR1cyIsInBhZ2VOdW1iZXIiLCJwYXJzZUludCIsImxpbWl0TnVtYmVyIiwic3RhcnRJbmRleCIsImVuZEluZGV4IiwicGFnaW5hdGVkQXJ0aWNsZXMiLCJ0b3RhbCIsImhhc01vcmUiLCJ1cGRhdGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/english-news.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenglish-news&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fenglish-news.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();